<!DOCTYPE html><html lang="python"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="在python的路上砥砺前行"><meta name="keywords" content="时间 努力 坚持"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style-dark.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight-dark.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><title>study java day 39 | 和拉萨再来个约定</title><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">study java day 39</h1><a id="logo" href="/.">和拉萨再来个约定</a><p class="description">Life is the art of drawing sufficient conclusions form insufficient premises</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">study java day 39</h1><div class="post-meta"><a href="/2020/01/27/study%20python%2039%20day/#comments" class="comment-count"></a><p><span class="date">Jan 27, 2020</span><span><a href="/categories/java-%E9%A1%B9%E7%9B%AE/" class="category">java 项目</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Hits</i></i></span></p></div><div class="post-content"><h2 id="java课程设计—-人事管理系统"><a href="#java课程设计—-人事管理系统" class="headerlink" title="java课程设计—-人事管理系统"></a>java课程设计—-人事管理系统</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br></pre></td><td class="code"><pre><span class="line">主界面代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="keyword">import</span> java.awt.*;</span><br><span class="line">  <span class="number">4</span> <span class="keyword">import</span> java.awt.event.*;</span><br><span class="line">  <span class="number">5</span> <span class="keyword">import</span> javax.swing.*;</span><br><span class="line">  <span class="number">6</span> <span class="keyword">import</span> javax.swing.event.*;</span><br><span class="line">  <span class="number">7</span> <span class="keyword">import</span> javax.swing.tree.*;</span><br><span class="line">  <span class="number">8</span> <span class="keyword">import</span> java.net.*;</span><br><span class="line">  <span class="number">9</span> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 10  * </span></span><br><span class="line"><span class="comment"> 11  * 人事管理系统主界面</span></span><br><span class="line"><span class="comment"> 12  *</span></span><br><span class="line"><span class="comment"> 13  */</span></span><br><span class="line"> <span class="number">14</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HrMain</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span>,<span class="title">TreeSelectionListener</span></span></span><br><span class="line"><span class="class"> 15 </span>&#123;</span><br><span class="line"> <span class="number">16</span>     Dimension faceSize  = <span class="keyword">new</span> Dimension(<span class="number">650</span>,<span class="number">450</span>);</span><br><span class="line"> <span class="number">17</span>     Image icon;</span><br><span class="line"> <span class="number">18</span>     <span class="comment">//建立JTree菜单</span></span><br><span class="line"> <span class="number">19</span>     JTree tree;</span><br><span class="line"> <span class="number">20</span>     DefaultMutableTreeNode root;<span class="comment">//人事管理系统</span></span><br><span class="line"> <span class="number">21</span>     DefaultMutableTreeNode node1;<span class="comment">//人员基本信息维护</span></span><br><span class="line"> <span class="number">22</span>     DefaultMutableTreeNode node2;<span class="comment">//部门信息管理</span></span><br><span class="line"> <span class="number">23</span>     DefaultMutableTreeNode node3;<span class="comment">//人员调动管理</span></span><br><span class="line"> <span class="number">24</span>     DefaultMutableTreeNode node4;<span class="comment">//人员考核管理</span></span><br><span class="line"> <span class="number">25</span>     DefaultMutableTreeNode node5;<span class="comment">//劳资管理</span></span><br><span class="line"> <span class="number">26</span>     DefaultMutableTreeNode leafnode;</span><br><span class="line"> <span class="number">27</span>     TreePath treePath;</span><br><span class="line"> <span class="number">28</span>     </span><br><span class="line"> <span class="number">29</span>     <span class="comment">//主界面面板</span></span><br><span class="line"> <span class="number">30</span>     <span class="keyword">public</span> <span class="keyword">static</span> JSplitPane splitPane;</span><br><span class="line"> <span class="number">31</span>     JPanel panel1;</span><br><span class="line"> <span class="number">32</span>     JPanel panel2;</span><br><span class="line"> <span class="number">33</span>     JPanel panel3;</span><br><span class="line"> <span class="number">34</span>     JLabel welcome = <span class="keyword">new</span> JLabel();</span><br><span class="line"> <span class="number">35</span>     JScrollPane scrollPane;</span><br><span class="line"> <span class="number">36</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 37      * 程序初始化函数</span></span><br><span class="line"><span class="comment"> 38      */</span></span><br><span class="line"> <span class="number">39</span>     <span class="function"><span class="keyword">public</span> <span class="title">HrMain</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> 40     </span>&#123;</span><br><span class="line"> <span class="number">41</span>         enableEvents(AWTEvent.WINDOW_EVENT_MASK);</span><br><span class="line"> <span class="number">42</span>         <span class="keyword">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line"> <span class="number">43</span>         <span class="keyword">this</span>.pack();</span><br><span class="line"> <span class="number">44</span>         <span class="keyword">this</span>.setSize(faceSize);</span><br><span class="line"> <span class="number">45</span>         <span class="keyword">this</span>.setTitle(<span class="string">"人事管理系统"</span>);</span><br><span class="line"> <span class="number">46</span>         icon = getImage(<span class="string">"icon.png"</span>);</span><br><span class="line"> <span class="number">47</span>         <span class="keyword">this</span>.setIconImage(icon);<span class="comment">//设置程序图标</span></span><br><span class="line"> <span class="number">48</span>         <span class="keyword">this</span>.setResizable(<span class="keyword">false</span>);</span><br><span class="line"> <span class="number">49</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">50</span>             Init();</span><br><span class="line"> <span class="number">51</span>         &#125;</span><br><span class="line"> <span class="number">52</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">53</span>             e.printStackTrace();</span><br><span class="line"> <span class="number">54</span>         &#125;</span><br><span class="line"> <span class="number">55</span>     &#125;</span><br><span class="line"> <span class="number">56</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 57      * 程序初始化函数</span></span><br><span class="line"><span class="comment"> 58      */</span></span><br><span class="line"> <span class="number">59</span>     <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"> 60     </span>&#123;</span><br><span class="line"> <span class="number">61</span>         <span class="comment">//添加JTree菜单</span></span><br><span class="line"> <span class="number">62</span>         root = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"人事管理系统"</span>);</span><br><span class="line"> <span class="number">63</span>         node1 = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"基本信息管理"</span>);</span><br><span class="line"> <span class="number">64</span>         node2 = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"人员调动管理"</span>);</span><br><span class="line"> <span class="number">65</span>         node3 = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"人员考核管理"</span>);</span><br><span class="line"> <span class="number">66</span>         node4 = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"劳资管理"</span>);</span><br><span class="line"> <span class="number">67</span>         <span class="comment">//人员基本信息</span></span><br><span class="line"> <span class="number">68</span>         root.add(node1);</span><br><span class="line"> <span class="number">69</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"添加人员信息"</span>);</span><br><span class="line"> <span class="number">70</span>         node1.add(leafnode);</span><br><span class="line"> <span class="number">71</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"修改人员信息"</span>);</span><br><span class="line"> <span class="number">72</span>         node1.add(leafnode);</span><br><span class="line"> <span class="number">73</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"删除人员信息"</span>);</span><br><span class="line"> <span class="number">74</span>         node1.add(leafnode);</span><br><span class="line"> <span class="number">75</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"查询人员信息"</span>);</span><br><span class="line"> <span class="number">76</span>         node1.add(leafnode);</span><br><span class="line"> <span class="number">77</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"部门管理"</span>);</span><br><span class="line"> <span class="number">78</span>         node1.add(leafnode);</span><br><span class="line"> <span class="number">79</span>         <span class="comment">//人员调动</span></span><br><span class="line"> <span class="number">80</span>         root.add(node2);</span><br><span class="line"> <span class="number">81</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"人员调动"</span>);</span><br><span class="line"> <span class="number">82</span>         node2.add(leafnode);</span><br><span class="line"> <span class="number">83</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"调动历史查询"</span>);</span><br><span class="line"> <span class="number">84</span>         node2.add(leafnode);</span><br><span class="line"> <span class="number">85</span>         <span class="comment">//人员考核管理</span></span><br><span class="line"> <span class="number">86</span>         root.add(node3);</span><br><span class="line"> <span class="number">87</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"人员考核"</span>);</span><br><span class="line"> <span class="number">88</span>         node3.add(leafnode);</span><br><span class="line"> <span class="number">89</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"考核历史查询"</span>);</span><br><span class="line"> <span class="number">90</span>         node3.add(leafnode);</span><br><span class="line"> <span class="number">91</span>         <span class="comment">//劳资管理</span></span><br><span class="line"> <span class="number">92</span>         root.add(node4);</span><br><span class="line"> <span class="number">93</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"劳资分配管理"</span>);</span><br><span class="line"> <span class="number">94</span>         node4.add(leafnode);</span><br><span class="line"> <span class="number">95</span>         leafnode = <span class="keyword">new</span> DefaultMutableTreeNode(<span class="string">"劳资历史查询"</span>);</span><br><span class="line"> <span class="number">96</span>         node4.add(leafnode);</span><br><span class="line"> <span class="number">97</span>         <span class="comment">//生成左侧的JTree</span></span><br><span class="line"> <span class="number">98</span>         tree = <span class="keyword">new</span> JTree(root);</span><br><span class="line"> <span class="number">99</span>         scrollPane = <span class="keyword">new</span> JScrollPane(tree);</span><br><span class="line"><span class="number">100</span>         scrollPane.setPreferredSize(<span class="keyword">new</span> Dimension(<span class="number">150</span>,<span class="number">400</span>));</span><br><span class="line"><span class="number">101</span>         tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);</span><br><span class="line"><span class="number">102</span>         <span class="comment">//生成JPanel</span></span><br><span class="line"><span class="number">103</span>         panel1 = <span class="keyword">new</span> JPanel();</span><br><span class="line"><span class="number">104</span>         panel2 = <span class="keyword">new</span> JPanel();</span><br><span class="line"><span class="number">105</span>         panel3 = <span class="keyword">new</span> JPanel();</span><br><span class="line"><span class="number">106</span>         panel1.add(scrollPane);</span><br><span class="line"><span class="number">107</span>         welcome.setText(<span class="string">"欢迎使用人事管理系统"</span>);</span><br><span class="line"><span class="number">108</span>         welcome.setFont(<span class="keyword">new</span> Font(<span class="string">"Dialog"</span>,<span class="number">0</span>,<span class="number">16</span>));</span><br><span class="line"><span class="number">109</span>         panel3.add(welcome);</span><br><span class="line"><span class="number">110</span>         <span class="comment">//生成JSplitPane并设置参数</span></span><br><span class="line"><span class="number">111</span>         splitPane = <span class="keyword">new</span> JSplitPane();</span><br><span class="line"><span class="number">112</span>         splitPane.setOneTouchExpandable(<span class="keyword">false</span>);</span><br><span class="line"><span class="number">113</span>         splitPane.setContinuousLayout(<span class="keyword">true</span>);</span><br><span class="line"><span class="number">114</span>         splitPane.setPreferredSize(<span class="keyword">new</span> Dimension(<span class="number">150</span>,<span class="number">400</span>));</span><br><span class="line"><span class="number">115</span>         splitPane.setOrientation(JSplitPane.HORIZONTAL_SPLIT);</span><br><span class="line"><span class="number">116</span>         splitPane.setLeftComponent(panel1);</span><br><span class="line"><span class="number">117</span>         splitPane.setRightComponent(panel3);</span><br><span class="line"><span class="number">118</span>         splitPane.setDividerSize(<span class="number">2</span>);</span><br><span class="line"><span class="number">119</span>         splitPane.setDividerLocation(<span class="number">161</span>);</span><br><span class="line"><span class="number">120</span>         <span class="comment">//生成主界面</span></span><br><span class="line"><span class="number">121</span>         <span class="keyword">this</span>.setContentPane(splitPane);</span><br><span class="line"><span class="number">122</span>         <span class="keyword">this</span>.setVisible(<span class="keyword">true</span>);</span><br><span class="line"><span class="number">123</span>         <span class="comment">//添加事件侦听</span></span><br><span class="line"><span class="number">124</span>         tree.addTreeSelectionListener(<span class="keyword">this</span>);</span><br><span class="line"><span class="number">125</span>         <span class="comment">//关闭程序时的操作</span></span><br><span class="line"><span class="number">126</span>         <span class="keyword">this</span>.addWindowListener(</span><br><span class="line"><span class="number">127</span>                 <span class="keyword">new</span> WindowAdapter()&#123;</span><br><span class="line"><span class="number">128</span>                     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">windowClosing</span><span class="params">(WindowEvent e)</span></span>&#123;</span><br><span class="line"><span class="number">129</span>                         System.exit(<span class="number">0</span>);</span><br><span class="line"><span class="number">130</span>                     &#125;</span><br><span class="line"><span class="number">131</span>                 &#125;</span><br><span class="line"><span class="number">132</span>         );</span><br><span class="line"><span class="number">133</span>     &#125;</span><br><span class="line"><span class="number">134</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">135      * 事件处理</span></span><br><span class="line"><span class="comment">136      */</span></span><br><span class="line"><span class="number">137</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span></span>&#123;</span><br><span class="line"><span class="number">138</span>         </span><br><span class="line"><span class="number">139</span>     &#125;</span><br><span class="line"><span class="number">140</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">141      * JTree事件处理</span></span><br><span class="line"><span class="comment">142      */</span></span><br><span class="line"><span class="number">143</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueChanged</span><span class="params">(TreeSelectionEvent tse)</span></span></span><br><span class="line"><span class="function">144     </span>&#123;</span><br><span class="line"><span class="number">145</span>         DefaultMutableTreeNode dnode = (DefaultMutableTreeNode)tse.getPath().getLastPathComponent();</span><br><span class="line"><span class="number">146</span>         System.out.println(<span class="string">"dnode="</span>+dnode);</span><br><span class="line"><span class="number">147</span>         String node_str = dnode.toString();</span><br><span class="line"><span class="number">148</span>         <span class="keyword">if</span>(node_str == <span class="string">"人事管理系统"</span>)&#123;</span><br><span class="line"><span class="number">149</span>             splitPane.setRightComponent(panel3);</span><br><span class="line"><span class="number">150</span>         &#125;</span><br><span class="line"><span class="number">151</span>         <span class="comment">//人员基本信息树</span></span><br><span class="line"><span class="number">152</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"基本信息管理"</span>)&#123;</span><br><span class="line"><span class="number">153</span>             <span class="comment">//当选中后展开或关闭叶子节点</span></span><br><span class="line"><span class="number">154</span>             treePath = <span class="keyword">new</span> TreePath(node1.getPath());</span><br><span class="line"><span class="number">155</span>             <span class="keyword">if</span>(tree.isExpanded(treePath))</span><br><span class="line"><span class="number">156</span>                 tree.collapsePath(treePath);</span><br><span class="line"><span class="number">157</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">158</span>                 tree.expandPath(treePath);</span><br><span class="line"><span class="number">159</span>         &#125;</span><br><span class="line"><span class="number">160</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"添加人员信息"</span>)&#123;</span><br><span class="line"><span class="number">161</span>             Node11Panel node11Panel = <span class="keyword">new</span> Node11Panel();</span><br><span class="line"><span class="number">162</span>             splitPane.setRightComponent(node11Panel);</span><br><span class="line"><span class="number">163</span>         &#125;</span><br><span class="line"><span class="number">164</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"修改人员信息"</span>)&#123;</span><br><span class="line"><span class="number">165</span>             Node12Panel node12Panel = <span class="keyword">new</span> Node12Panel();</span><br><span class="line"><span class="number">166</span>             splitPane.setRightComponent(node12Panel);</span><br><span class="line"><span class="number">167</span>         &#125;</span><br><span class="line"><span class="number">168</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"删除人员信息"</span>)&#123;</span><br><span class="line"><span class="number">169</span>             Node13Panel node13Panel = <span class="keyword">new</span> Node13Panel();</span><br><span class="line"><span class="number">170</span>             splitPane.setRightComponent(node13Panel);</span><br><span class="line"><span class="number">171</span>         &#125;</span><br><span class="line"><span class="number">172</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"查询人员信息"</span>)&#123;</span><br><span class="line"><span class="number">173</span>             Node14Panel node14Panel = <span class="keyword">new</span> Node14Panel();</span><br><span class="line"><span class="number">174</span>             splitPane.setRightComponent(node14Panel);</span><br><span class="line"><span class="number">175</span>         &#125;</span><br><span class="line"><span class="number">176</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"部门管理"</span>)&#123;</span><br><span class="line"><span class="number">177</span>             Node15Panel node15Panel = <span class="keyword">new</span> Node15Panel();</span><br><span class="line"><span class="number">178</span>             splitPane.setRightComponent(node15Panel);</span><br><span class="line"><span class="number">179</span>         &#125;</span><br><span class="line"><span class="number">180</span>         <span class="comment">//人员调动管理树</span></span><br><span class="line"><span class="number">181</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"人员调动管理"</span>)&#123;</span><br><span class="line"><span class="number">182</span>             <span class="comment">//当选中后展开或关闭叶子节点</span></span><br><span class="line"><span class="number">183</span>             treePath = <span class="keyword">new</span> TreePath(node2.getPath());</span><br><span class="line"><span class="number">184</span>             <span class="keyword">if</span>(tree.isExpanded(treePath))</span><br><span class="line"><span class="number">185</span>                 tree.collapsePath(treePath);</span><br><span class="line"><span class="number">186</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">187</span>                 tree.expandPath(treePath);</span><br><span class="line"><span class="number">188</span>         &#125;</span><br><span class="line"><span class="number">189</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"人员调动"</span>)&#123;</span><br><span class="line"><span class="number">190</span>             Node21Panel node21Panel = <span class="keyword">new</span> Node21Panel();</span><br><span class="line"><span class="number">191</span>             splitPane.setRightComponent(node21Panel);</span><br><span class="line"><span class="number">192</span>         &#125;</span><br><span class="line"><span class="number">193</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"调动历史查询"</span>)&#123;</span><br><span class="line"><span class="number">194</span>             Node22Panel node22Panel = <span class="keyword">new</span> Node22Panel();</span><br><span class="line"><span class="number">195</span>             splitPane.setRightComponent(node22Panel);</span><br><span class="line"><span class="number">196</span>         &#125;</span><br><span class="line"><span class="number">197</span>         <span class="comment">//人员考核管理树</span></span><br><span class="line"><span class="number">198</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"人员考核管理"</span>)&#123;</span><br><span class="line"><span class="number">199</span>             <span class="comment">//当选中后展开或关闭叶子节点</span></span><br><span class="line"><span class="number">200</span>             treePath = <span class="keyword">new</span> TreePath(node3.getPath());</span><br><span class="line"><span class="number">201</span>             <span class="keyword">if</span>(tree.isExpanded(treePath))</span><br><span class="line"><span class="number">202</span>                 tree.collapsePath(treePath);</span><br><span class="line"><span class="number">203</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">204</span>                 tree.expandPath(treePath);</span><br><span class="line"><span class="number">205</span>         &#125;</span><br><span class="line"><span class="number">206</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"人员考核"</span>)&#123;</span><br><span class="line"><span class="number">207</span>             Node31Panel node31Panel = <span class="keyword">new</span> Node31Panel();</span><br><span class="line"><span class="number">208</span>             splitPane.setRightComponent(node31Panel);</span><br><span class="line"><span class="number">209</span>         &#125;</span><br><span class="line"><span class="number">210</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"考核历史查询"</span>)&#123;</span><br><span class="line"><span class="number">211</span>             Node32Panel node32Panel = <span class="keyword">new</span> Node32Panel();</span><br><span class="line"><span class="number">212</span>             splitPane.setRightComponent(node32Panel);</span><br><span class="line"><span class="number">213</span>         &#125;</span><br><span class="line"><span class="number">214</span>         <span class="comment">//劳资管理树</span></span><br><span class="line"><span class="number">215</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"劳资管理"</span>)&#123;</span><br><span class="line"><span class="number">216</span>             <span class="comment">//当选中后展开或关闭叶子节点</span></span><br><span class="line"><span class="number">217</span>             treePath = <span class="keyword">new</span> TreePath(node4.getPath());</span><br><span class="line"><span class="number">218</span>             <span class="keyword">if</span>(tree.isExpanded(treePath))</span><br><span class="line"><span class="number">219</span>                 tree.collapsePath(treePath);</span><br><span class="line"><span class="number">220</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">221</span>                 tree.expandPath(treePath);</span><br><span class="line"><span class="number">222</span>         &#125;</span><br><span class="line"><span class="number">223</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"劳资分配管理"</span>)&#123;</span><br><span class="line"><span class="number">224</span>             Node41Panel node41Panel = <span class="keyword">new</span> Node41Panel();</span><br><span class="line"><span class="number">225</span>             splitPane.setRightComponent(node41Panel);</span><br><span class="line"><span class="number">226</span>         &#125;</span><br><span class="line"><span class="number">227</span>         <span class="keyword">else</span> <span class="keyword">if</span>(node_str == <span class="string">"劳资历史查询"</span>)&#123;</span><br><span class="line"><span class="number">228</span>             Node42Panel node42Panel = <span class="keyword">new</span> Node42Panel();</span><br><span class="line"><span class="number">229</span>             splitPane.setRightComponent(node42Panel);</span><br><span class="line"><span class="number">230</span>         &#125;</span><br><span class="line"><span class="number">231</span>     &#125;</span><br><span class="line"><span class="number">232</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">233      * 通过给定的文件名获得图像</span></span><br><span class="line"><span class="comment">234      */</span></span><br><span class="line"><span class="number">235</span>     <span class="function">Image <span class="title">getImage</span><span class="params">(String filename)</span></span></span><br><span class="line"><span class="function">236     </span>&#123;</span><br><span class="line"><span class="number">237</span>         URLClassLoader urlLoader = (URLClassLoader)<span class="keyword">this</span>.getClass().getClassLoader();</span><br><span class="line"><span class="number">238</span>         URL url = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">239</span>         Image image = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">240</span>         url = urlLoader.findResource(filename);</span><br><span class="line"><span class="number">241</span>         image = Toolkit.getDefaultToolkit().getImage(url);</span><br><span class="line"><span class="number">242</span>         MediaTracker mediatracker = <span class="keyword">new</span> MediaTracker(<span class="keyword">this</span>);</span><br><span class="line"><span class="number">243</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">244</span>             mediatracker.addImage(image, <span class="number">0</span>);</span><br><span class="line"><span class="number">245</span>             mediatracker.waitForID(<span class="number">0</span>);</span><br><span class="line"><span class="number">246</span>         &#125;</span><br><span class="line"><span class="number">247</span>         <span class="keyword">catch</span>(InterruptedException _ex)&#123;</span><br><span class="line"><span class="number">248</span>             image = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">249</span>         &#125;</span><br><span class="line"><span class="number">250</span>         <span class="keyword">if</span>(mediatracker.isErrorID(<span class="number">0</span>))&#123;</span><br><span class="line"><span class="number">251</span>             image = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">252</span>         &#125;</span><br><span class="line"><span class="number">253</span>         <span class="keyword">return</span> image;</span><br><span class="line"><span class="number">254</span>     &#125;</span><br><span class="line"><span class="number">255</span> &#125;</span><br><span class="line"></span><br><span class="line"> 主类代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line"> <span class="number">2</span> </span><br><span class="line"> <span class="number">3</span> <span class="keyword">import</span> javax.swing.UIManager;</span><br><span class="line"> <span class="number">4</span> <span class="keyword">import</span> java.awt.*;</span><br><span class="line"> <span class="number">5</span> </span><br><span class="line"> <span class="number">6</span> <span class="comment">/** </span></span><br><span class="line"><span class="comment"> 7  * 人事管理系统运行主类</span></span><br><span class="line"><span class="comment"> 8  */</span></span><br><span class="line"> <span class="number">9</span> </span><br><span class="line"><span class="number">10</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HrMS</span> </span></span><br><span class="line"><span class="class">11 </span>&#123;</span><br><span class="line"><span class="number">12</span>     <span class="keyword">boolean</span> packFrame = <span class="keyword">false</span>;</span><br><span class="line"><span class="number">13</span>     <span class="function"><span class="keyword">public</span> <span class="title">HrMS</span><span class="params">()</span></span></span><br><span class="line"><span class="function">14     </span>&#123;</span><br><span class="line"><span class="number">15</span>         HrMain frame = <span class="keyword">new</span> HrMain();</span><br><span class="line"><span class="number">16</span>         <span class="keyword">if</span>(packFrame)&#123;</span><br><span class="line"><span class="number">17</span>             frame.pack();</span><br><span class="line"><span class="number">18</span>         &#125;</span><br><span class="line"><span class="number">19</span>         <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">20</span>             frame.validate();</span><br><span class="line"><span class="number">21</span>         &#125;</span><br><span class="line"><span class="number">22</span>         <span class="comment">//设置运行时窗口的位置</span></span><br><span class="line"><span class="number">23</span>         Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line"><span class="number">24</span>         Dimension frameSize = frame.getSize();</span><br><span class="line"><span class="number">25</span>         <span class="keyword">if</span>(frameSize.height &gt; screenSize.height)&#123;</span><br><span class="line"><span class="number">26</span>             frameSize.height = screenSize.height;</span><br><span class="line"><span class="number">27</span>         &#125;</span><br><span class="line"><span class="number">28</span>         <span class="keyword">if</span>(frameSize.width &gt; screenSize.width)&#123;</span><br><span class="line"><span class="number">29</span>             frameSize.width = screenSize.width;</span><br><span class="line"><span class="number">30</span>         &#125;</span><br><span class="line"><span class="number">31</span>         frame.setLocation((screenSize.width - frameSize.width)/<span class="number">2</span>,(screenSize.height - frameSize.height)/<span class="number">2</span>);</span><br><span class="line"><span class="number">32</span>         frame.setVisible(<span class="keyword">true</span>);</span><br><span class="line"><span class="number">33</span>     &#125;</span><br><span class="line"><span class="number">34</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">35     </span>&#123;</span><br><span class="line"><span class="number">36</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">37</span>             UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());</span><br><span class="line"><span class="number">38</span>         &#125;</span><br><span class="line"><span class="number">39</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">40</span>             e.printStackTrace();</span><br><span class="line"><span class="number">41</span>         &#125;</span><br><span class="line"><span class="number">42</span>         <span class="keyword">new</span> HrMS();</span><br><span class="line"><span class="number">43</span>     &#125;</span><br><span class="line"><span class="number">44</span> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="人事管理系统—-数据库操作类"><a href="#人事管理系统—-数据库操作类" class="headerlink" title="人事管理系统—-数据库操作类"></a>人事管理系统—-数据库操作类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br></pre></td><td class="code"><pre><span class="line">连接数据库类主要代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="keyword">import</span> java.sql.*;</span><br><span class="line">  <span class="number">4</span> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  5  * </span></span><br><span class="line"><span class="comment">  6  * 连接数据库的类</span></span><br><span class="line"><span class="comment">  7  *</span></span><br><span class="line"><span class="comment">  8  */</span></span><br><span class="line">  <span class="number">9</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Database</span> </span></span><br><span class="line"><span class="class"> 10 </span>&#123;</span><br><span class="line"> <span class="number">11</span>     <span class="keyword">private</span> Statement stmt = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">12</span>     ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">13</span>     <span class="keyword">private</span> Connection conn = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">14</span>     String sql;</span><br><span class="line"> <span class="number">15</span>     String strurl = <span class="string">"jdbc:odbc:HrMS"</span>;</span><br><span class="line"> <span class="number">16</span>     </span><br><span class="line"> <span class="number">17</span>     <span class="function"><span class="keyword">public</span> <span class="title">Database</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="number">18</span>     &#125;</span><br><span class="line"> <span class="number">19</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 20      * 打开数据库连接</span></span><br><span class="line"><span class="comment"> 21      */</span></span><br><span class="line"> <span class="number">22</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OpenConn</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span></span><br><span class="line"><span class="function"> 23     </span>&#123;</span><br><span class="line"> <span class="number">24</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">25</span>             Class.forName(<span class="string">"sun.jdbc.odbc.JdbcOdbcDriver"</span>);</span><br><span class="line"> <span class="number">26</span>             conn=DriverManager.getConnection(strurl);</span><br><span class="line"> <span class="number">27</span>         &#125;</span><br><span class="line"> <span class="number">28</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">29</span>             System.err.println(<span class="string">"OpenConn:"</span>+e.getMessage());</span><br><span class="line"> <span class="number">30</span>         &#125;</span><br><span class="line"> <span class="number">31</span>     &#125;</span><br><span class="line"> <span class="number">32</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 33      * 执行SQL语句，返回结果集rs</span></span><br><span class="line"><span class="comment"> 34      */</span></span><br><span class="line"> <span class="number">35</span>     <span class="function"><span class="keyword">public</span> ResultSet <span class="title">executeQuery</span><span class="params">(String sql)</span></span></span><br><span class="line"><span class="function"> 36     </span>&#123;</span><br><span class="line"> <span class="number">37</span>         stmt = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">38</span>         rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">39</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">40</span>             stmt=conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);</span><br><span class="line"> <span class="number">41</span>             rs=stmt.executeQuery(sql);</span><br><span class="line"> <span class="number">42</span>         &#125;</span><br><span class="line"> <span class="number">43</span>         <span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line"> <span class="number">44</span>             System.err.println(<span class="string">"executeQuery:"</span>+e.getMessage());</span><br><span class="line"> <span class="number">45</span>         &#125;</span><br><span class="line"> <span class="number">46</span>         <span class="keyword">return</span> rs;</span><br><span class="line"> <span class="number">47</span>     &#125;</span><br><span class="line"> <span class="number">48</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 49      * 执行SQL语句</span></span><br><span class="line"><span class="comment"> 50      */</span></span><br><span class="line"> <span class="number">51</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">executeUpdate</span><span class="params">(String sql)</span></span></span><br><span class="line"><span class="function"> 52     </span>&#123;</span><br><span class="line"> <span class="number">53</span>         stmt = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">54</span>         rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">55</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">56</span>             stmt=conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);</span><br><span class="line"> <span class="number">57</span>             rs=stmt.executeQuery(sql);</span><br><span class="line"> <span class="number">58</span>             conn.commit();</span><br><span class="line"> <span class="number">59</span>         &#125;</span><br><span class="line"> <span class="number">60</span>         <span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line"> <span class="number">61</span>             System.err.println(<span class="string">"executeUpdate:"</span>+e.getMessage());</span><br><span class="line"> <span class="number">62</span>         &#125;</span><br><span class="line"> <span class="number">63</span>     &#125;</span><br><span class="line"> <span class="number">64</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeStmt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> 65     </span>&#123;</span><br><span class="line"> <span class="number">66</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">67</span>             stmt.close();</span><br><span class="line"> <span class="number">68</span>         &#125;</span><br><span class="line"> <span class="number">69</span>         <span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line"> <span class="number">70</span>             System.err.println(<span class="string">"closeStmt:"</span>+e.getMessage());</span><br><span class="line"> <span class="number">71</span>         &#125;</span><br><span class="line"> <span class="number">72</span>     &#125;</span><br><span class="line"> <span class="number">73</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 74      * 关闭数据库连接</span></span><br><span class="line"><span class="comment"> 75      */</span></span><br><span class="line"> <span class="number">76</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeConn</span><span class="params">()</span></span>&#123;</span><br><span class="line"> <span class="number">77</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">78</span>             conn.close();</span><br><span class="line"> <span class="number">79</span>         &#125;</span><br><span class="line"> <span class="number">80</span>         <span class="keyword">catch</span>(SQLException ex)&#123;</span><br><span class="line"> <span class="number">81</span>             System.err.println(<span class="string">"aq.closeConn:"</span>+ex.getMessage());</span><br><span class="line"> <span class="number">82</span>         &#125;</span><br><span class="line"> <span class="number">83</span>     &#125;</span><br><span class="line"> <span class="number">84</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 85      * 转换编码</span></span><br><span class="line"><span class="comment"> 86      */</span></span><br><span class="line"> <span class="number">87</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">toGBK</span><span class="params">(String str)</span></span></span><br><span class="line"><span class="function"> 88     </span>&#123;</span><br><span class="line"> <span class="number">89</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">90</span>             <span class="keyword">if</span>(str==<span class="keyword">null</span>)</span><br><span class="line"> <span class="number">91</span>                 str = <span class="string">""</span>;</span><br><span class="line"> <span class="number">92</span>             <span class="keyword">else</span></span><br><span class="line"> <span class="number">93</span>                 str = <span class="keyword">new</span> String(str.getBytes(<span class="string">"ISO-8859-1"</span>),<span class="string">"GBK"</span>);</span><br><span class="line"> <span class="number">94</span>         &#125;</span><br><span class="line"> <span class="number">95</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">96</span>             System.out.println(e);</span><br><span class="line"> <span class="number">97</span>         &#125;</span><br><span class="line"> <span class="number">98</span>         <span class="keyword">return</span> str;</span><br><span class="line"> <span class="number">99</span>     &#125;</span><br><span class="line"><span class="number">100</span> &#125;</span><br><span class="line"></span><br><span class="line"> 有关人员信息数据库操作的类主要代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="comment">//import java.util.*;</span></span><br><span class="line">  <span class="number">4</span> <span class="keyword">import</span> java.sql.*;</span><br><span class="line">  <span class="number">5</span> <span class="keyword">import</span> javax.swing.*;</span><br><span class="line">  <span class="number">6</span> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  7  * </span></span><br><span class="line"><span class="comment">  8  * 有关人员信息数据库操作的类</span></span><br><span class="line"><span class="comment">  9  *</span></span><br><span class="line"><span class="comment"> 10  */</span></span><br><span class="line"> <span class="number">11</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonBean</span> </span></span><br><span class="line"><span class="class"> 12 </span>&#123;</span><br><span class="line"> <span class="number">13</span>     String sql;</span><br><span class="line"> <span class="number">14</span>     ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">15</span>     </span><br><span class="line"> <span class="number">16</span>     String field1;   <span class="comment">//PersonID</span></span><br><span class="line"> <span class="number">17</span>     String field2;   <span class="comment">//Name</span></span><br><span class="line"> <span class="number">18</span>     String field3;   <span class="comment">//Sex</span></span><br><span class="line"> <span class="number">19</span>     String field4;   <span class="comment">//Birth</span></span><br><span class="line"> <span class="number">20</span>     String field5;   <span class="comment">//Nat</span></span><br><span class="line"> <span class="number">21</span>     String field6;   <span class="comment">//Address</span></span><br><span class="line"> <span class="number">22</span>     String field7;   <span class="comment">//DeptID</span></span><br><span class="line"> <span class="number">23</span>     String field8;   <span class="comment">//Salary</span></span><br><span class="line"> <span class="number">24</span>     String field9;   <span class="comment">//Assess</span></span><br><span class="line"> <span class="number">25</span>     String field10;  <span class="comment">//Other</span></span><br><span class="line"> <span class="number">26</span>     </span><br><span class="line"> <span class="number">27</span>     String colName;  <span class="comment">//列名</span></span><br><span class="line"> <span class="number">28</span>     String colValue;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">29</span>     String colValue2;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">30</span>     </span><br><span class="line"> <span class="number">31</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 32      * 添加信息</span></span><br><span class="line"><span class="comment"> 33      */</span></span><br><span class="line"> <span class="number">34</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String f1,String f2,String f3,String f4,String f5,</span></span></span><br><span class="line"><span class="function"><span class="params"> <span class="number">35</span>                     String f6,String f7,String f8,String f9,String f10)</span></span></span><br><span class="line"><span class="function"> 36     </span>&#123;</span><br><span class="line"> <span class="number">37</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"> <span class="number">38</span>         </span><br><span class="line"> <span class="number">39</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"> <span class="number">40</span>         <span class="keyword">this</span>.field2 = f2;</span><br><span class="line"> <span class="number">41</span>         <span class="keyword">this</span>.field3 = f3;</span><br><span class="line"> <span class="number">42</span>         <span class="keyword">this</span>.field4 = f4;</span><br><span class="line"> <span class="number">43</span>         <span class="keyword">this</span>.field5 = f5;</span><br><span class="line"> <span class="number">44</span>         <span class="keyword">this</span>.field6 = f6;</span><br><span class="line"> <span class="number">45</span>         <span class="keyword">this</span>.field7 = f7;</span><br><span class="line"> <span class="number">46</span>         <span class="keyword">this</span>.field8 = f8;</span><br><span class="line"> <span class="number">47</span>         <span class="keyword">this</span>.field9 = f9;</span><br><span class="line"> <span class="number">48</span>         <span class="keyword">this</span>.field10 = f10;</span><br><span class="line"> <span class="number">49</span>         </span><br><span class="line"> <span class="number">50</span>         <span class="keyword">if</span>(field2 == <span class="keyword">null</span>||field2.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">51</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入员工姓名"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">52</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">53</span>         &#125;</span><br><span class="line"> <span class="number">54</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field3 == <span class="keyword">null</span>||field3.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">55</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入性别"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">56</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">57</span>         &#125;</span><br><span class="line"> <span class="number">58</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field4 == <span class="keyword">null</span>||field4.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">59</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入出生年月"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">60</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">61</span>         &#125;</span><br><span class="line"> <span class="number">62</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field5 == <span class="keyword">null</span>||field5.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">63</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入民族"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">64</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">65</span>         &#125;</span><br><span class="line"> <span class="number">66</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field6 == <span class="keyword">null</span>||field6.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">67</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入地址"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">68</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">69</span>         &#125;</span><br><span class="line"> <span class="number">70</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field7 == <span class="keyword">null</span>||field7.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">71</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入部门"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">72</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">73</span>         &#125;</span><br><span class="line"> <span class="number">74</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field8 == <span class="keyword">null</span>||field8.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">75</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入薪酬"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">76</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">77</span>         &#125;</span><br><span class="line"> <span class="number">78</span>         <span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="number">79</span>             sql = <span class="string">"insert into Person(PersonID,Name,Sex,Birth,Nat,Address,DeptID,Salary,Assess,Other)"</span></span><br><span class="line"> <span class="number">80</span>                 +<span class="string">"values('"</span>+field1+<span class="string">"','"</span>+field2+<span class="string">"','"</span>+field3+<span class="string">"','"</span>+field4+<span class="string">"','"</span>+field5+<span class="string">"',"</span></span><br><span class="line"> <span class="number">81</span>                 + <span class="string">"'"</span>+field6+<span class="string">"','"</span>+field7+<span class="string">"','"</span>+field8+<span class="string">"','"</span>+field9+<span class="string">"','"</span>+field10+<span class="string">"')"</span>;</span><br><span class="line"> <span class="number">82</span>             <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">83</span>                 DB.OpenConn();</span><br><span class="line"> <span class="number">84</span>                 DB.executeUpdate(sql);</span><br><span class="line"> <span class="number">85</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功添加一条记录！"</span>);</span><br><span class="line"> <span class="number">86</span>             &#125;</span><br><span class="line"> <span class="number">87</span>             <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">88</span>                 System.out.println(e);</span><br><span class="line"> <span class="number">89</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"保存失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">90</span>             &#125;</span><br><span class="line"> <span class="number">91</span>             <span class="keyword">finally</span>&#123;</span><br><span class="line"> <span class="number">92</span>                 DB.closeStmt();</span><br><span class="line"> <span class="number">93</span>                 DB.closeConn();</span><br><span class="line"> <span class="number">94</span>             &#125;</span><br><span class="line"> <span class="number">95</span>         &#125;</span><br><span class="line"> <span class="number">96</span>     &#125;</span><br><span class="line"> <span class="number">97</span>     </span><br><span class="line"> <span class="number">98</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 99      * 修改信息</span></span><br><span class="line"><span class="comment">100      */</span></span><br><span class="line"><span class="number">101</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(String f1,String f2,String f3,String f4,String f5,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="number">102</span>                     String f6,String f7,String f8,String f9,String f10)</span></span></span><br><span class="line"><span class="function">103     </span>&#123;</span><br><span class="line"><span class="number">104</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">105</span>         </span><br><span class="line"><span class="number">106</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">107</span>         <span class="keyword">this</span>.field2 = f2;</span><br><span class="line"><span class="number">108</span>         <span class="keyword">this</span>.field3 = f3;</span><br><span class="line"><span class="number">109</span>         <span class="keyword">this</span>.field4 = f4;</span><br><span class="line"><span class="number">110</span>         <span class="keyword">this</span>.field5 = f5;</span><br><span class="line"><span class="number">111</span>         <span class="keyword">this</span>.field6 = f6;</span><br><span class="line"><span class="number">112</span>         <span class="keyword">this</span>.field7 = f7;</span><br><span class="line"><span class="number">113</span>         <span class="keyword">this</span>.field8 = f8;</span><br><span class="line"><span class="number">114</span>         <span class="keyword">this</span>.field9 = f9;</span><br><span class="line"><span class="number">115</span>         <span class="keyword">this</span>.field10 = f10;</span><br><span class="line"><span class="number">116</span>         </span><br><span class="line"><span class="number">117</span>         <span class="keyword">if</span>(field2 == <span class="keyword">null</span>||field2.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">118</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入员工姓名"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">119</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">120</span>         &#125;</span><br><span class="line"><span class="number">121</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field3 == <span class="keyword">null</span>||field3.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">122</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入性别"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">123</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">124</span>         &#125;</span><br><span class="line"><span class="number">125</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field4 == <span class="keyword">null</span>||field4.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">126</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入出生年月"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">127</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">128</span>         &#125;</span><br><span class="line"><span class="number">129</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field5 == <span class="keyword">null</span>||field5.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">130</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入民族"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">131</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">132</span>         &#125;</span><br><span class="line"><span class="number">133</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field6 == <span class="keyword">null</span>||field6.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">134</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入地址"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">135</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">136</span>         &#125;</span><br><span class="line"><span class="number">137</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field7 == <span class="keyword">null</span>||field7.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">138</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入部门"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">139</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">140</span>         &#125;</span><br><span class="line"><span class="number">141</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field8 == <span class="keyword">null</span>||field8.equals(<span class="string">""</span>))&#123;</span><br><span class="line"><span class="number">142</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入薪酬"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">143</span>             <span class="keyword">return</span>;</span><br><span class="line"><span class="number">144</span>         &#125;</span><br><span class="line"><span class="number">145</span>         <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">146</span>             sql = <span class="string">"update Person set Name= '"</span>+field2+<span class="string">"',"</span>+<span class="string">"Sex='"</span>+field3+<span class="string">"','"</span>+<span class="string">"Birth='"</span>+field4+<span class="string">"','"</span></span><br><span class="line"><span class="number">147</span>                  +<span class="string">"Nat='"</span>+field5+<span class="string">"','"</span>+<span class="string">"Address='"</span>+field6+<span class="string">"','"</span>+<span class="string">"'"</span>+<span class="string">"DeptID='"</span>+field7+<span class="string">"','"</span>+<span class="string">"Salary='"</span>+field8+<span class="string">"','"</span></span><br><span class="line"><span class="number">148</span>                     +<span class="string">"Assess='"</span>+field9+<span class="string">"','"</span>+<span class="string">"Other='"</span>+field10+<span class="string">"','"</span>+<span class="string">"where PersonID='"</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">149</span>             <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">150</span>                 DB.OpenConn();</span><br><span class="line"><span class="number">151</span>                 DB.executeUpdate(sql);</span><br><span class="line"><span class="number">152</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功修改一条新的记录！"</span>);</span><br><span class="line"><span class="number">153</span>             &#125;</span><br><span class="line"><span class="number">154</span>             <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">155</span>                 System.out.println(e);</span><br><span class="line"><span class="number">156</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"更新失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">157</span>             &#125;</span><br><span class="line"><span class="number">158</span>             <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">159</span>                 DB.closeStmt();</span><br><span class="line"><span class="number">160</span>                 DB.closeConn();</span><br><span class="line"><span class="number">161</span>             &#125;</span><br><span class="line"><span class="number">162</span>         &#125;</span><br><span class="line"><span class="number">163</span>     &#125;</span><br><span class="line"><span class="number">164</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">165      * 删除信息</span></span><br><span class="line"><span class="comment">166      */</span></span><br><span class="line"><span class="number">167</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(String f1)</span></span></span><br><span class="line"><span class="function">168     </span>&#123;</span><br><span class="line"><span class="number">169</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">170</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">171</span>         </span><br><span class="line"><span class="number">172</span>         sql = <span class="string">"delect from Person where PersonID ="</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">173</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">174</span>             DB.OpenConn();</span><br><span class="line"><span class="number">175</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">176</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功删除一条记录！"</span>);</span><br><span class="line"><span class="number">177</span>         &#125;</span><br><span class="line"><span class="number">178</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">179</span>             System.out.println(e);</span><br><span class="line"><span class="number">180</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"删除失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">181</span>         &#125;</span><br><span class="line"><span class="number">182</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">183</span>             DB.closeStmt();</span><br><span class="line"><span class="number">184</span>             DB.closeConn();</span><br><span class="line"><span class="number">185</span>         &#125;</span><br><span class="line"><span class="number">186</span>     &#125;</span><br><span class="line"><span class="number">187</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">188      * 根据编号查询信息</span></span><br><span class="line"><span class="comment">189      */</span></span><br><span class="line"><span class="number">190</span>     <span class="keyword">public</span> String[] search(String f1)</span><br><span class="line"><span class="number">191</span>     &#123;</span><br><span class="line"><span class="number">192</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">193</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">194</span>         String[] s = <span class="keyword">new</span> String[<span class="number">10</span>];</span><br><span class="line"><span class="number">195</span>         sql = <span class="string">"select * from Person where PersonID = "</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">196</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">197</span>             DB.OpenConn();</span><br><span class="line"><span class="number">198</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">199</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">200</span>                 s[<span class="number">0</span>] = rs.getString(<span class="string">"PersonID"</span>);</span><br><span class="line"><span class="number">201</span>                 s[<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"><span class="number">202</span>                 s[<span class="number">2</span>] = rs.getString(<span class="string">"Sex"</span>);</span><br><span class="line"><span class="number">203</span>                 s[<span class="number">3</span>] = rs.getString(<span class="string">"Birth"</span>);</span><br><span class="line"><span class="number">204</span>                 s[<span class="number">4</span>] = rs.getString(<span class="string">"Nat"</span>);</span><br><span class="line"><span class="number">205</span>                 s[<span class="number">5</span>] = rs.getString(<span class="string">"Address"</span>);</span><br><span class="line"><span class="number">206</span>                 s[<span class="number">6</span>] = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">207</span>                 s[<span class="number">7</span>] = rs.getString(<span class="string">"Salary"</span>);</span><br><span class="line"><span class="number">208</span>                 s[<span class="number">8</span>] = rs.getString(<span class="string">"Assess"</span>);</span><br><span class="line"><span class="number">209</span>                 s[<span class="number">9</span>] = rs.getString(<span class="string">"Other"</span>);</span><br><span class="line"><span class="number">210</span>             &#125;</span><br><span class="line"><span class="number">211</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">212</span>                 s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">213</span>         &#125;</span><br><span class="line"><span class="number">214</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">215</span>         &#125;</span><br><span class="line"><span class="number">216</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">217</span>             DB.closeStmt();</span><br><span class="line"><span class="number">218</span>             DB.closeConn();</span><br><span class="line"><span class="number">219</span>         &#125;</span><br><span class="line"><span class="number">220</span>         <span class="keyword">return</span> s;</span><br><span class="line"><span class="number">221</span>     &#125;</span><br><span class="line"><span class="number">222</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">223      * 人员记录综合查询（查询所有记录）</span></span><br><span class="line"><span class="comment">224      */</span></span><br><span class="line"><span class="number">225</span>     <span class="keyword">public</span> String[][] searchAllForNode()</span><br><span class="line"><span class="number">226</span>     &#123;</span><br><span class="line"><span class="number">227</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">228</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">229</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">230</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">231</span>         sql = <span class="string">"select PersonID,Name,Sex,Dept.DeptID as DeptID,B_Dept,S_Dept,Salary,Assess "</span></span><br><span class="line"><span class="number">232</span>                 + <span class="string">"from Dept,Person where Dept.DeptID = Person.DeptID order by PersonID"</span>;</span><br><span class="line"><span class="number">233</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">234</span>             DB.OpenConn();</span><br><span class="line"><span class="number">235</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">236</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">237</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">238</span>             &#125;</span><br><span class="line"><span class="number">239</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">240</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line"><span class="number">241</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">242</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">243</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">244</span>                 sn[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">245</span>                 sn[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">246</span>                 sn[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">247</span>             &#125;</span><br><span class="line"><span class="number">248</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">249</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"><span class="number">250</span>                 rs.first();</span><br><span class="line"><span class="number">251</span>                 rs.previous();</span><br><span class="line"><span class="number">252</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">253</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"PersonID"</span>);</span><br><span class="line"><span class="number">254</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"><span class="number">255</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"Sex"</span>);</span><br><span class="line"><span class="number">256</span>                     sn[i][<span class="number">3</span>] = rs.getString(<span class="string">"B_Dept"</span>)+<span class="string">"-"</span>+rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">257</span>                     sn[i][<span class="number">4</span>] = rs.getString(<span class="string">"Salary"</span>);</span><br><span class="line"><span class="number">258</span>                     sn[i][<span class="number">5</span>] = rs.getString(<span class="string">"Assess"</span>);</span><br><span class="line"><span class="number">259</span>                     i++;</span><br><span class="line"><span class="number">260</span>                 &#125;</span><br><span class="line"><span class="number">261</span>             &#125;</span><br><span class="line"><span class="number">262</span>         &#125;</span><br><span class="line"><span class="number">263</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">264</span>             </span><br><span class="line"><span class="number">265</span>         &#125;</span><br><span class="line"><span class="number">266</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">267</span>             DB.closeStmt();</span><br><span class="line"><span class="number">268</span>             DB.closeConn();</span><br><span class="line"><span class="number">269</span>         &#125;</span><br><span class="line"><span class="number">270</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">271</span>     &#125;</span><br><span class="line"><span class="number">272</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">273      * 修改信息</span></span><br><span class="line"><span class="comment">274      */</span></span><br><span class="line"><span class="number">275</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateDept</span><span class="params">(String f1,String f7)</span></span></span><br><span class="line"><span class="function">276     </span>&#123;</span><br><span class="line"><span class="number">277</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">278</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">279</span>         <span class="keyword">this</span>.field7 = f7;</span><br><span class="line"><span class="number">280</span>         </span><br><span class="line"><span class="number">281</span>         sql = <span class="string">"update Person set DeptID = "</span>+field7+<span class="string">"where PersonID ="</span>+field1;</span><br><span class="line"><span class="number">282</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">283</span>             DB.OpenConn();</span><br><span class="line"><span class="number">284</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">285</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"人员调动成功！"</span>);</span><br><span class="line"><span class="number">286</span>         &#125;</span><br><span class="line"><span class="number">287</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">288</span>             System.out.println(e);</span><br><span class="line"><span class="number">289</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"更新失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">290</span>         &#125;</span><br><span class="line"><span class="number">291</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">292</span>             DB.closeStmt();</span><br><span class="line"><span class="number">293</span>             DB.closeConn();</span><br><span class="line"><span class="number">294</span>         &#125;</span><br><span class="line"><span class="number">295</span>     &#125;</span><br><span class="line"><span class="number">296</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">297      * 修改信息</span></span><br><span class="line"><span class="comment">298      */</span></span><br><span class="line"><span class="number">299</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateSalary</span><span class="params">(String f1,String f8)</span></span></span><br><span class="line"><span class="function">300     </span>&#123;</span><br><span class="line"><span class="number">301</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">302</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">303</span>         <span class="keyword">this</span>.field8 = f8;</span><br><span class="line"><span class="number">304</span>         </span><br><span class="line"><span class="number">305</span>         sql = <span class="string">"update Person set Salary ='"</span>+field8+<span class="string">"'where PersonID ="</span>+field1;</span><br><span class="line"><span class="number">306</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">307</span>             DB.OpenConn();</span><br><span class="line"><span class="number">308</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">309</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"劳资更改成功！"</span>);</span><br><span class="line"><span class="number">310</span>         &#125;</span><br><span class="line"><span class="number">311</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">312</span>             System.out.println(e);</span><br><span class="line"><span class="number">313</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"更新失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">314</span>         &#125;</span><br><span class="line"><span class="number">315</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">316</span>             DB.closeStmt();</span><br><span class="line"><span class="number">317</span>             DB.closeConn();</span><br><span class="line"><span class="number">318</span>         &#125;</span><br><span class="line"><span class="number">319</span>     &#125;</span><br><span class="line"><span class="number">320</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">321      * 修改信息</span></span><br><span class="line"><span class="comment">322      */</span></span><br><span class="line"><span class="number">323</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateAssess</span><span class="params">(String f1,String f9)</span></span></span><br><span class="line"><span class="function">324     </span>&#123;</span><br><span class="line"><span class="number">325</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">326</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">327</span>         <span class="keyword">this</span>.field8 = f9;</span><br><span class="line"><span class="number">328</span>         </span><br><span class="line"><span class="number">329</span>         sql = <span class="string">"update Person set Assess ='"</span>+field9+<span class="string">"'where PersonID ="</span>+field1;</span><br><span class="line"><span class="number">330</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">331</span>             DB.OpenConn();</span><br><span class="line"><span class="number">332</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">333</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"人员考核成功！"</span>);</span><br><span class="line"><span class="number">334</span>         &#125;</span><br><span class="line"><span class="number">335</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">336</span>             System.out.println(e);</span><br><span class="line"><span class="number">337</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"更新失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">338</span>         &#125;</span><br><span class="line"><span class="number">339</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">340</span>             DB.closeStmt();</span><br><span class="line"><span class="number">341</span>             DB.closeConn();</span><br><span class="line"><span class="number">342</span>         &#125;</span><br><span class="line"><span class="number">343</span>     &#125;</span><br><span class="line"><span class="number">344</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">345      * 人员信息综合查询</span></span><br><span class="line"><span class="comment">346      */</span></span><br><span class="line"><span class="number">347</span>     <span class="keyword">public</span> String[][] searchAll()</span><br><span class="line"><span class="number">348</span>     &#123;</span><br><span class="line"><span class="number">349</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">350</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">351</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">352</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">353</span>         sql = <span class="string">"select * from Person order by PersonID"</span>;</span><br><span class="line"><span class="number">354</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">355</span>             DB.OpenConn();</span><br><span class="line"><span class="number">356</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">357</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">358</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">359</span>             &#125;</span><br><span class="line"><span class="number">360</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">361</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line"><span class="number">362</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">363</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">364</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">365</span>                 sn[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">366</span>                 sn[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">367</span>                 sn[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">368</span>             &#125;</span><br><span class="line"><span class="number">369</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">370</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"><span class="number">371</span>                 rs.first();</span><br><span class="line"><span class="number">372</span>                 rs.previous();</span><br><span class="line"><span class="number">373</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">374</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"PersonID"</span>);</span><br><span class="line"><span class="number">375</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"><span class="number">376</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"Sex"</span>);</span><br><span class="line"><span class="number">377</span>                     sn[i][<span class="number">3</span>] = rs.getString(<span class="string">"Nat"</span>);</span><br><span class="line"><span class="number">378</span>                     sn[i][<span class="number">4</span>] = rs.getString(<span class="string">"Address"</span>);</span><br><span class="line"><span class="number">379</span>                     DeptBean dp = <span class="keyword">new</span> DeptBean();</span><br><span class="line"><span class="number">380</span>                     sn[i][<span class="number">5</span>] = dp.getDeptStr(rs.getString(<span class="string">"DeptID"</span>));</span><br><span class="line"><span class="number">381</span>                     i++;</span><br><span class="line"><span class="number">382</span>                 &#125;</span><br><span class="line"><span class="number">383</span>             &#125;</span><br><span class="line"><span class="number">384</span>         &#125;</span><br><span class="line"><span class="number">385</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">386</span>             </span><br><span class="line"><span class="number">387</span>         &#125;</span><br><span class="line"><span class="number">388</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">389</span>             DB.closeStmt();</span><br><span class="line"><span class="number">390</span>             DB.closeConn();</span><br><span class="line"><span class="number">391</span>         &#125;</span><br><span class="line"><span class="number">392</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">393</span>     &#125;</span><br><span class="line"><span class="number">394</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">395      * 获得新的ID</span></span><br><span class="line"><span class="comment">396      */</span></span><br><span class="line"><span class="number">397</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span></span><br><span class="line"><span class="function">398     </span>&#123;</span><br><span class="line"><span class="number">399</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">400</span>         <span class="keyword">int</span> ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">401</span>         sql = <span class="string">"select max(PersonID) from Person"</span>;</span><br><span class="line"><span class="number">402</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">403</span>             DB.OpenConn();</span><br><span class="line"><span class="number">404</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">405</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">406</span>                 ID = rs.getInt(<span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="number">407</span>             &#125;</span><br><span class="line"><span class="number">408</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">409</span>                 ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">410</span>         &#125;</span><br><span class="line"><span class="number">411</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">412</span>             </span><br><span class="line"><span class="number">413</span>         &#125;</span><br><span class="line"><span class="number">414</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">415</span>             DB.closeStmt();</span><br><span class="line"><span class="number">416</span>             DB.closeConn();</span><br><span class="line"><span class="number">417</span>         &#125;</span><br><span class="line"><span class="number">418</span>         <span class="keyword">return</span> ID;</span><br><span class="line"><span class="number">419</span>     &#125;</span><br><span class="line"><span class="number">420</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">421      * 取得DeptID</span></span><br><span class="line"><span class="comment">422      */</span></span><br><span class="line"><span class="number">423</span>     <span class="function"><span class="keyword">public</span> String <span class="title">getDeptId</span><span class="params">(String f1)</span></span></span><br><span class="line"><span class="function">424     </span>&#123;</span><br><span class="line"><span class="number">425</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">426</span>         sql = <span class="string">"select DeptID from Person where personID = "</span>+f1;</span><br><span class="line"><span class="number">427</span>         String deptid = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">428</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">429</span>             DB.OpenConn();</span><br><span class="line"><span class="number">430</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">431</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">432</span>                 deptid = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">433</span>             &#125;</span><br><span class="line"><span class="number">434</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">435</span>                 deptid = <span class="string">""</span>;</span><br><span class="line"><span class="number">436</span>         &#125;</span><br><span class="line"><span class="number">437</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">438</span>             </span><br><span class="line"><span class="number">439</span>         &#125;</span><br><span class="line"><span class="number">440</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">441</span>             DB.closeStmt();</span><br><span class="line"><span class="number">442</span>             DB.closeConn();</span><br><span class="line"><span class="number">443</span>         &#125;</span><br><span class="line"><span class="number">444</span>         <span class="keyword">return</span> deptid;</span><br><span class="line"><span class="number">445</span>     &#125;</span><br><span class="line"><span class="number">446</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">447      * 取得Name</span></span><br><span class="line"><span class="comment">448      */</span></span><br><span class="line"><span class="number">449</span>     <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">(String f1)</span></span></span><br><span class="line"><span class="function">450     </span>&#123;</span><br><span class="line"><span class="number">451</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">452</span>         sql = <span class="string">"select Name from Person where personID = "</span>+f1;</span><br><span class="line"><span class="number">453</span>         String name = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">454</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">455</span>             DB.OpenConn();</span><br><span class="line"><span class="number">456</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">457</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">458</span>                 name = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">459</span>             &#125;</span><br><span class="line"><span class="number">460</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">461</span>                 name = <span class="string">""</span>;</span><br><span class="line"><span class="number">462</span>         &#125;</span><br><span class="line"><span class="number">463</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">464</span>             </span><br><span class="line"><span class="number">465</span>         &#125;</span><br><span class="line"><span class="number">466</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">467</span>             DB.closeStmt();</span><br><span class="line"><span class="number">468</span>             DB.closeConn();</span><br><span class="line"><span class="number">469</span>         &#125;</span><br><span class="line"><span class="number">470</span>         <span class="keyword">return</span> name;</span><br><span class="line"><span class="number">471</span>     &#125;</span><br><span class="line"><span class="number">472</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">473      * 获得表中的所有编号</span></span><br><span class="line"><span class="comment">474      */</span></span><br><span class="line"><span class="number">475</span>     <span class="keyword">public</span> String[] getAllId()</span><br><span class="line"><span class="number">476</span>     &#123;</span><br><span class="line"><span class="number">477</span>         String[] s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">478</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">479</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">480</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">481</span>         sql = <span class="string">"select PersonID,name from Person order by PersonID"</span>;</span><br><span class="line"><span class="number">482</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">483</span>             DB.OpenConn();</span><br><span class="line"><span class="number">484</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">485</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">486</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">487</span>             &#125;</span><br><span class="line"><span class="number">488</span>             <span class="keyword">if</span>(row == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">489</span>                 s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">490</span>             &#125;</span><br><span class="line"><span class="number">491</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">492</span>                 s = <span class="keyword">new</span> String[row];</span><br><span class="line"><span class="number">493</span>                 rs.first();</span><br><span class="line"><span class="number">494</span>                 rs.previous();</span><br><span class="line"><span class="number">495</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">496</span>                     s[i] = rs.getString(<span class="number">1</span>)+<span class="string">"-"</span>+rs.getShort(<span class="number">2</span>);</span><br><span class="line"><span class="number">497</span>                     i++;</span><br><span class="line"><span class="number">498</span>                 &#125;</span><br><span class="line"><span class="number">499</span>             &#125;</span><br><span class="line"><span class="number">500</span>         &#125;</span><br><span class="line"><span class="number">501</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">502</span>             System.out.println(e);</span><br><span class="line"><span class="number">503</span>         &#125;</span><br><span class="line"><span class="number">504</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">505</span>             DB.closeStmt();</span><br><span class="line"><span class="number">506</span>             DB.closeConn();</span><br><span class="line"><span class="number">507</span>         &#125;</span><br><span class="line"><span class="number">508</span>         <span class="keyword">return</span> s;</span><br><span class="line"><span class="number">509</span>     &#125;</span><br><span class="line"><span class="number">510</span> &#125;</span><br><span class="line"></span><br><span class="line">有关部门信息数据库操作的类主要代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="comment">//import java.util.*;</span></span><br><span class="line">  <span class="number">4</span> <span class="keyword">import</span> java.sql.*;</span><br><span class="line">  <span class="number">5</span> <span class="keyword">import</span> javax.swing.*;</span><br><span class="line">  <span class="number">6</span> </span><br><span class="line">  <span class="number">7</span> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  8  * </span></span><br><span class="line"><span class="comment">  9  * 有关部门信息数据库操作的类</span></span><br><span class="line"><span class="comment"> 10  *</span></span><br><span class="line"><span class="comment"> 11  */</span></span><br><span class="line"> <span class="number">12</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeptBean</span></span></span><br><span class="line"><span class="class"> 13 </span>&#123;</span><br><span class="line"> <span class="number">14</span>     String sql;</span><br><span class="line"> <span class="number">15</span>     ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">16</span>     </span><br><span class="line"> <span class="number">17</span>     String field1;   <span class="comment">//DeptID</span></span><br><span class="line"> <span class="number">18</span>     String field2;   <span class="comment">//B_Dept</span></span><br><span class="line"> <span class="number">19</span>     String field3;   <span class="comment">//S_Dept</span></span><br><span class="line"> <span class="number">20</span>     </span><br><span class="line"> <span class="number">21</span>     String colName;  <span class="comment">//列名</span></span><br><span class="line"> <span class="number">22</span>     String colValue;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">23</span>     String colValue2;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">24</span>     </span><br><span class="line"> <span class="number">25</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 26      * 添加信息</span></span><br><span class="line"><span class="comment"> 27      */</span></span><br><span class="line"> <span class="number">28</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String f1,String f2,String f3)</span></span></span><br><span class="line"><span class="function"> 29     </span>&#123;</span><br><span class="line"> <span class="number">30</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"> <span class="number">31</span>         </span><br><span class="line"> <span class="number">32</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"> <span class="number">33</span>         <span class="keyword">this</span>.field2 = f2;</span><br><span class="line"> <span class="number">34</span>         <span class="keyword">this</span>.field3 = f3;</span><br><span class="line"> <span class="number">35</span>         </span><br><span class="line"> <span class="number">36</span>         <span class="keyword">if</span>(field2 == <span class="keyword">null</span>||field2.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">37</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入一级部门名称"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">38</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">39</span>         &#125;</span><br><span class="line"> <span class="number">40</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field3 == <span class="keyword">null</span>||field3.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">41</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入二级部门名称"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">42</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">43</span>         &#125;</span><br><span class="line"> <span class="number">44</span>         <span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="number">45</span>             sql = <span class="string">"insert into Dept(DeptID,B_Dept,S_Dept) values('"</span>+field1+<span class="string">"','"</span>+field2+<span class="string">"','"</span>+field3+<span class="string">"')"</span>;</span><br><span class="line"> <span class="number">46</span>             <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">47</span>                 DB.OpenConn();</span><br><span class="line"> <span class="number">48</span>                 DB.executeUpdate(sql);</span><br><span class="line"> <span class="number">49</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功添加一条新的记录！"</span>);</span><br><span class="line"> <span class="number">50</span>             &#125;</span><br><span class="line"> <span class="number">51</span>             <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">52</span>                 System.out.println(e);</span><br><span class="line"> <span class="number">53</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"保存失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">54</span>             &#125;</span><br><span class="line"> <span class="number">55</span>             <span class="keyword">finally</span>&#123;</span><br><span class="line"> <span class="number">56</span>                 DB.closeStmt();</span><br><span class="line"> <span class="number">57</span>                 DB.closeConn();</span><br><span class="line"> <span class="number">58</span>             &#125;</span><br><span class="line"> <span class="number">59</span>         &#125;</span><br><span class="line"> <span class="number">60</span>     &#125;</span><br><span class="line"> <span class="number">61</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 62      * 修改信息</span></span><br><span class="line"><span class="comment"> 63      */</span></span><br><span class="line"> <span class="number">64</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(String f1,String f2,String f3)</span></span></span><br><span class="line"><span class="function"> 65     </span>&#123;</span><br><span class="line"> <span class="number">66</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"> <span class="number">67</span>         </span><br><span class="line"> <span class="number">68</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"> <span class="number">69</span>         <span class="keyword">this</span>.field2 = f2;</span><br><span class="line"> <span class="number">70</span>         <span class="keyword">this</span>.field3 = f3;</span><br><span class="line"> <span class="number">71</span>         </span><br><span class="line"> <span class="number">72</span>         <span class="keyword">if</span>(field2 == <span class="keyword">null</span>||field2.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">73</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入一级部门名称"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">74</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">75</span>         &#125;</span><br><span class="line"> <span class="number">76</span>         <span class="keyword">else</span> <span class="keyword">if</span>(field3 == <span class="keyword">null</span>||field3.equals(<span class="string">""</span>))&#123;</span><br><span class="line"> <span class="number">77</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"请输入二级部门名称"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">78</span>             <span class="keyword">return</span>;</span><br><span class="line"> <span class="number">79</span>         &#125;</span><br><span class="line"> <span class="number">80</span>         <span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="number">81</span>             sql = <span class="string">"update Dept set B_Dept = '"</span>+field2+<span class="string">"',S_Dept = '"</span>+field3+<span class="string">"' where DeptID = "</span>+field1+<span class="string">""</span>;</span><br><span class="line"> <span class="number">82</span>             <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">83</span>                 DB.OpenConn();</span><br><span class="line"> <span class="number">84</span>                 DB.executeUpdate(sql);</span><br><span class="line"> <span class="number">85</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功修改一条新的记录！"</span>);</span><br><span class="line"> <span class="number">86</span>             &#125;</span><br><span class="line"> <span class="number">87</span>             <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">88</span>                 System.out.println(e);</span><br><span class="line"> <span class="number">89</span>                 JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"更新失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">90</span>             &#125;</span><br><span class="line"> <span class="number">91</span>             <span class="keyword">finally</span>&#123;</span><br><span class="line"> <span class="number">92</span>                 DB.closeStmt();</span><br><span class="line"> <span class="number">93</span>                 DB.closeConn();</span><br><span class="line"> <span class="number">94</span>             &#125;</span><br><span class="line"> <span class="number">95</span>         &#125;</span><br><span class="line"> <span class="number">96</span>     &#125;</span><br><span class="line"> <span class="number">97</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 98      * 删除信息</span></span><br><span class="line"><span class="comment"> 99      */</span></span><br><span class="line"><span class="number">100</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(String f1)</span></span></span><br><span class="line"><span class="function">101     </span>&#123;</span><br><span class="line"><span class="number">102</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">103</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">104</span>         </span><br><span class="line"><span class="number">105</span>         sql = <span class="string">"delect from Dept where DeptID ="</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">106</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">107</span>             DB.OpenConn();</span><br><span class="line"><span class="number">108</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">109</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"成功删除一条记录！"</span>);</span><br><span class="line"><span class="number">110</span>         &#125;</span><br><span class="line"><span class="number">111</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">112</span>             System.out.println(e);</span><br><span class="line"><span class="number">113</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"删除失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"><span class="number">114</span>         &#125;</span><br><span class="line"><span class="number">115</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">116</span>             DB.closeStmt();</span><br><span class="line"><span class="number">117</span>             DB.closeConn();</span><br><span class="line"><span class="number">118</span>         &#125;</span><br><span class="line"><span class="number">119</span>     &#125;</span><br><span class="line"><span class="number">120</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">121      * 根据编号查询信息</span></span><br><span class="line"><span class="comment">122      */</span></span><br><span class="line"><span class="number">123</span>     <span class="keyword">public</span> String[] search(String f1)</span><br><span class="line"><span class="number">124</span>     &#123;</span><br><span class="line"><span class="number">125</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">126</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">127</span>         String[] s = <span class="keyword">new</span> String[<span class="number">10</span>];</span><br><span class="line"><span class="number">128</span>         sql = <span class="string">"select * from Dept where DeptID = "</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">129</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">130</span>             DB.OpenConn();</span><br><span class="line"><span class="number">131</span>             DB.executeUpdate(sql);</span><br><span class="line"><span class="number">132</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">133</span>                 s[<span class="number">0</span>] = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">134</span>                 s[<span class="number">1</span>] = rs.getString(<span class="string">"B_Dept"</span>);</span><br><span class="line"><span class="number">135</span>                 s[<span class="number">2</span>] = rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">136</span>             &#125;</span><br><span class="line"><span class="number">137</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">138</span>                 s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">139</span>         &#125;</span><br><span class="line"><span class="number">140</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">141</span>         &#125;</span><br><span class="line"><span class="number">142</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">143</span>             DB.closeStmt();</span><br><span class="line"><span class="number">144</span>             DB.closeConn();</span><br><span class="line"><span class="number">145</span>         &#125;</span><br><span class="line"><span class="number">146</span>         <span class="keyword">return</span> s;</span><br><span class="line"><span class="number">147</span>     &#125;</span><br><span class="line"><span class="number">148</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">149      * 查询所有记录</span></span><br><span class="line"><span class="comment">150      */</span></span><br><span class="line"><span class="number">151</span>     <span class="keyword">public</span> String[][] searchAll()</span><br><span class="line"><span class="number">152</span>     &#123;</span><br><span class="line"><span class="number">153</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">154</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">155</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">156</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">157</span>         sql = <span class="string">"select * from Dept order by DeptID"</span>;</span><br><span class="line"><span class="number">158</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">159</span>             DB.OpenConn();</span><br><span class="line"><span class="number">160</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">161</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">162</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">163</span>             &#125;</span><br><span class="line"><span class="number">164</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">165</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line"><span class="number">166</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">167</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">168</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">169</span>             &#125;</span><br><span class="line"><span class="number">170</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">171</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">3</span>];</span><br><span class="line"><span class="number">172</span>                 rs.first();</span><br><span class="line"><span class="number">173</span>                 rs.previous();</span><br><span class="line"><span class="number">174</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">175</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">176</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"B_Dept"</span>);</span><br><span class="line"><span class="number">177</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">178</span>                     i++;</span><br><span class="line"><span class="number">179</span>                 &#125;</span><br><span class="line"><span class="number">180</span>             &#125;</span><br><span class="line"><span class="number">181</span>         &#125;</span><br><span class="line"><span class="number">182</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">183</span>             </span><br><span class="line"><span class="number">184</span>         &#125;</span><br><span class="line"><span class="number">185</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">186</span>             DB.closeStmt();</span><br><span class="line"><span class="number">187</span>             DB.closeConn();</span><br><span class="line"><span class="number">188</span>         &#125;</span><br><span class="line"><span class="number">189</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">190</span>     &#125;</span><br><span class="line"><span class="number">191</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">192      * 为人事管理提供查询</span></span><br><span class="line"><span class="comment">193      */</span></span><br><span class="line"><span class="number">194</span>     <span class="meta">@SuppressWarnings</span>(<span class="string">"null"</span>)</span><br><span class="line"><span class="number">195</span>     <span class="keyword">public</span> String[] searchAllForNode()</span><br><span class="line"><span class="number">196</span>     &#123;</span><br><span class="line"><span class="number">197</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">198</span>         String[] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">199</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">200</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">201</span>         sql = <span class="string">"select * from Dept order by DeptID"</span>;</span><br><span class="line"><span class="number">202</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">203</span>             DB.OpenConn();</span><br><span class="line"><span class="number">204</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">205</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">206</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">207</span>             &#125;</span><br><span class="line"><span class="number">208</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">209</span>                 sn[<span class="number">0</span>] = <span class="string">""</span>;</span><br><span class="line"><span class="number">210</span>                 sn[<span class="number">1</span>] = <span class="string">""</span>;</span><br><span class="line"><span class="number">211</span>                 sn[<span class="number">2</span>] = <span class="string">""</span>;</span><br><span class="line"><span class="number">212</span>             &#125;</span><br><span class="line"><span class="number">213</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">214</span>                 sn = <span class="keyword">new</span> String[row];</span><br><span class="line"><span class="number">215</span>                 rs.first();</span><br><span class="line"><span class="number">216</span>                 rs.previous();</span><br><span class="line"><span class="number">217</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">218</span>                     sn[i] = rs.getString(<span class="string">"DeptID"</span>)+<span class="string">"-"</span>+rs.getString(<span class="string">"B_Dept"</span>)+<span class="string">"-"</span>+rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">219</span>                     i++;</span><br><span class="line"><span class="number">220</span>                 &#125;</span><br><span class="line"><span class="number">221</span>             &#125;</span><br><span class="line"><span class="number">222</span>         &#125;</span><br><span class="line"><span class="number">223</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">224</span>             </span><br><span class="line"><span class="number">225</span>         &#125;</span><br><span class="line"><span class="number">226</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">227</span>             DB.closeStmt();</span><br><span class="line"><span class="number">228</span>             DB.closeConn();</span><br><span class="line"><span class="number">229</span>         &#125;</span><br><span class="line"><span class="number">230</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">231</span>     &#125;</span><br><span class="line"><span class="number">232</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">233      * 人员记录综合查询（按ID查询）</span></span><br><span class="line"><span class="comment">234      */</span></span><br><span class="line"><span class="number">235</span>     <span class="keyword">public</span> String[][] searchAll(String f1)</span><br><span class="line"><span class="number">236</span>     &#123;</span><br><span class="line"><span class="number">237</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">238</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">239</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">240</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">241</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">242</span>         sql = <span class="string">"select * from Dept where DeptID="</span>+field1+<span class="string">" order by DeptID"</span>;</span><br><span class="line"><span class="number">243</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">244</span>             DB.OpenConn();</span><br><span class="line"><span class="number">245</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">246</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">247</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">248</span>             &#125;</span><br><span class="line"><span class="number">249</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">250</span>                 sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">251</span>             &#125;</span><br><span class="line"><span class="number">252</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">253</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"><span class="number">254</span>                 rs.first();</span><br><span class="line"><span class="number">255</span>                 rs.previous();</span><br><span class="line"><span class="number">256</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">257</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"DeptID"</span>);</span><br><span class="line"><span class="number">258</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"B_Dept"</span>);</span><br><span class="line"><span class="number">259</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">260</span>                     i++;</span><br><span class="line"><span class="number">261</span>                 &#125;</span><br><span class="line"><span class="number">262</span>             &#125;</span><br><span class="line"><span class="number">263</span>         &#125;</span><br><span class="line"><span class="number">264</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">265</span>             </span><br><span class="line"><span class="number">266</span>         &#125;</span><br><span class="line"><span class="number">267</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">268</span>             DB.closeStmt();</span><br><span class="line"><span class="number">269</span>             DB.closeConn();</span><br><span class="line"><span class="number">270</span>         &#125;</span><br><span class="line"><span class="number">271</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">272</span>     &#125;</span><br><span class="line"><span class="number">273</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">274      * 获得新的ID</span></span><br><span class="line"><span class="comment">275      */</span></span><br><span class="line"><span class="number">276</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span></span><br><span class="line"><span class="function">277     </span>&#123;</span><br><span class="line"><span class="number">278</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">279</span>         <span class="keyword">int</span> ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">280</span>         sql = <span class="string">"select max(DeptID) from Dept"</span>;</span><br><span class="line"><span class="number">281</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">282</span>             DB.OpenConn();</span><br><span class="line"><span class="number">283</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">284</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">285</span>                 ID = rs.getInt(<span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="number">286</span>             &#125;</span><br><span class="line"><span class="number">287</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">288</span>                 ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">289</span>         &#125;</span><br><span class="line"><span class="number">290</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">291</span>             </span><br><span class="line"><span class="number">292</span>         &#125;</span><br><span class="line"><span class="number">293</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">294</span>             DB.closeStmt();</span><br><span class="line"><span class="number">295</span>             DB.closeConn();</span><br><span class="line"><span class="number">296</span>         &#125;</span><br><span class="line"><span class="number">297</span>         <span class="keyword">return</span> ID;</span><br><span class="line"><span class="number">298</span>     &#125;</span><br><span class="line"><span class="number">299</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">300      * 获得表中的所有编号</span></span><br><span class="line"><span class="comment">301      */</span></span><br><span class="line"><span class="number">302</span>     <span class="keyword">public</span> String[] getAllId()</span><br><span class="line"><span class="number">303</span>     &#123;</span><br><span class="line"><span class="number">304</span>         String[] s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">305</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">306</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">307</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">308</span>         sql = <span class="string">"select DeptID from DeptType order by DeptID"</span>;</span><br><span class="line"><span class="number">309</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">310</span>             DB.OpenConn();</span><br><span class="line"><span class="number">311</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">312</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">313</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">314</span>             &#125;</span><br><span class="line"><span class="number">315</span>             <span class="keyword">if</span>(row == <span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">316</span>                 s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">317</span>             &#125;</span><br><span class="line"><span class="number">318</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">319</span>                 s = <span class="keyword">new</span> String[row];</span><br><span class="line"><span class="number">320</span>                 rs.first();</span><br><span class="line"><span class="number">321</span>                 rs.previous();</span><br><span class="line"><span class="number">322</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">323</span>                     s[i] = rs.getString(<span class="number">1</span>);</span><br><span class="line"><span class="number">324</span>                     i++;</span><br><span class="line"><span class="number">325</span>                 &#125;</span><br><span class="line"><span class="number">326</span>             &#125;</span><br><span class="line"><span class="number">327</span>         &#125;</span><br><span class="line"><span class="number">328</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">329</span>             System.out.println(e);</span><br><span class="line"><span class="number">330</span>         &#125;</span><br><span class="line"><span class="number">331</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">332</span>             DB.closeStmt();</span><br><span class="line"><span class="number">333</span>             DB.closeConn();</span><br><span class="line"><span class="number">334</span>         &#125;</span><br><span class="line"><span class="number">335</span>         <span class="keyword">return</span> s;</span><br><span class="line"><span class="number">336</span>     &#125;</span><br><span class="line"><span class="number">337</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">338      * 根据编号查询信息</span></span><br><span class="line"><span class="comment">339      */</span></span><br><span class="line"><span class="number">340</span>     <span class="function"><span class="keyword">public</span> String <span class="title">getDeptStr</span><span class="params">(String f1)</span></span></span><br><span class="line"><span class="function">341     </span>&#123;</span><br><span class="line"><span class="number">342</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">343</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"><span class="number">344</span>         String s = <span class="string">""</span>;</span><br><span class="line"><span class="number">345</span>         sql = <span class="string">"select * from Dept where DeptID ="</span>+field1+<span class="string">""</span>;</span><br><span class="line"><span class="number">346</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">347</span>             DB.OpenConn();</span><br><span class="line"><span class="number">348</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">349</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">350</span>                 s = rs.getString(<span class="string">"B_Dept"</span>)+<span class="string">"-"</span>+rs.getString(<span class="string">"S_Dept"</span>);</span><br><span class="line"><span class="number">351</span>             &#125;</span><br><span class="line"><span class="number">352</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">353</span>                 s = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">354</span>         &#125;</span><br><span class="line"><span class="number">355</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">356</span>             </span><br><span class="line"><span class="number">357</span>         &#125;</span><br><span class="line"><span class="number">358</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">359</span>             DB.closeStmt();</span><br><span class="line"><span class="number">360</span>             DB.closeConn();</span><br><span class="line"><span class="number">361</span>         &#125;</span><br><span class="line"><span class="number">362</span>         <span class="keyword">return</span> s;</span><br><span class="line"><span class="number">363</span>     &#125;</span><br><span class="line"><span class="number">364</span> &#125;</span><br><span class="line"></span><br><span class="line">有历史流水数据库操作的类主要代码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="number">1</span> <span class="keyword">package</span> PersonSystem;</span><br><span class="line">  <span class="number">2</span> </span><br><span class="line">  <span class="number">3</span> <span class="comment">//import java.util.*;</span></span><br><span class="line">  <span class="number">4</span> <span class="keyword">import</span> java.sql.*;</span><br><span class="line">  <span class="number">5</span> <span class="keyword">import</span> javax.swing.*;</span><br><span class="line">  <span class="number">6</span> <span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line">  <span class="number">7</span> </span><br><span class="line">  <span class="number">8</span> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  9 * </span></span><br><span class="line"><span class="comment"> 10 * 有历史流水数据库操作的类</span></span><br><span class="line"><span class="comment"> 11 *</span></span><br><span class="line"><span class="comment"> 12 */</span></span><br><span class="line"> <span class="number">13</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HistrjnBean</span> </span></span><br><span class="line"><span class="class"> 14 </span>&#123;</span><br><span class="line"> <span class="number">15</span>     String sql;</span><br><span class="line"> <span class="number">16</span>     ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">17</span>     </span><br><span class="line"> <span class="number">18</span>     String field1;   <span class="comment">//JourNo</span></span><br><span class="line"> <span class="number">19</span>     String field2;   <span class="comment">//FromAcc</span></span><br><span class="line"> <span class="number">20</span>     String field3;   <span class="comment">//OldInfo</span></span><br><span class="line"> <span class="number">21</span>     String field4;   <span class="comment">//NewInfo</span></span><br><span class="line"> <span class="number">22</span>     String field5;   <span class="comment">//ChgTime</span></span><br><span class="line"> <span class="number">23</span>     String field6;   <span class="comment">//RegDate</span></span><br><span class="line"> <span class="number">24</span>     String field7;   <span class="comment">//PersonID</span></span><br><span class="line"> <span class="number">25</span>     </span><br><span class="line"> <span class="number">26</span>     String colName;  <span class="comment">//列名</span></span><br><span class="line"> <span class="number">27</span>     String colValue;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">28</span>     String colValue2;  <span class="comment">//列值</span></span><br><span class="line"> <span class="number">29</span>     </span><br><span class="line"> <span class="number">30</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 31      * 添加信息</span></span><br><span class="line"><span class="comment"> 32      */</span></span><br><span class="line"> <span class="number">33</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String f1,String f2,String f3,String f4,String f5,String f6,String f7)</span></span></span><br><span class="line"><span class="function"> 34     </span>&#123;</span><br><span class="line"> <span class="number">35</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"> <span class="number">36</span>         </span><br><span class="line"> <span class="number">37</span>         <span class="keyword">this</span>.field1 = f1;</span><br><span class="line"> <span class="number">38</span>         <span class="keyword">this</span>.field2 = f2;</span><br><span class="line"> <span class="number">39</span>         <span class="keyword">this</span>.field3 = f3;</span><br><span class="line"> <span class="number">40</span>         <span class="keyword">this</span>.field4 = f4;</span><br><span class="line"> <span class="number">41</span>         <span class="keyword">this</span>.field5 = f5;</span><br><span class="line"> <span class="number">42</span>         <span class="keyword">this</span>.field6 = f6;</span><br><span class="line"> <span class="number">43</span>         <span class="keyword">this</span>.field7 = f7;</span><br><span class="line"> <span class="number">44</span>         </span><br><span class="line"> <span class="number">45</span>         sql = <span class="string">"insert into Histrjn(JourNo,FromAcc,OldInfo,NewInfo,ChgTime,RegDate,PersonID)"</span></span><br><span class="line"> <span class="number">46</span>                 +<span class="string">"values('"</span>+field1+<span class="string">"','"</span>+field2+<span class="string">"','"</span>+field3+<span class="string">"','"</span>+field4+<span class="string">"','"</span>+field5+<span class="string">"',"</span></span><br><span class="line"> <span class="number">47</span>                 + <span class="string">"'"</span>+field6+<span class="string">"','"</span>+field7+<span class="string">"')"</span>;</span><br><span class="line"> <span class="number">48</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">49</span>             DB.OpenConn();</span><br><span class="line"> <span class="number">50</span>             DB.executeUpdate(sql);</span><br><span class="line"> <span class="number">51</span>         &#125;</span><br><span class="line"> <span class="number">52</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"> <span class="number">53</span>             System.out.println(e);</span><br><span class="line"> <span class="number">54</span>             JOptionPane.showMessageDialog(<span class="keyword">null</span>, <span class="string">"保存失败"</span>,<span class="string">"错误"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line"> <span class="number">55</span>         &#125;</span><br><span class="line"> <span class="number">56</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"> <span class="number">57</span>             DB.closeStmt();</span><br><span class="line"> <span class="number">58</span>             DB.closeConn();</span><br><span class="line"> <span class="number">59</span>         &#125;</span><br><span class="line"> <span class="number">60</span>     &#125;</span><br><span class="line"> <span class="number">61</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment"> 62      * 查询所有记录</span></span><br><span class="line"><span class="comment"> 63      */</span></span><br><span class="line"> <span class="number">64</span>     <span class="keyword">public</span> String[][] searchAllForDept()</span><br><span class="line"> <span class="number">65</span>     &#123;</span><br><span class="line"> <span class="number">66</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"> <span class="number">67</span>         DeptBean deptBean = <span class="keyword">new</span> DeptBean();</span><br><span class="line"> <span class="number">68</span>         </span><br><span class="line"> <span class="number">69</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"> <span class="number">70</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"> <span class="number">71</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"> <span class="number">72</span>         sql = <span class="string">"select * from Histrjn,Person where Fromacc='人员调动' and "</span></span><br><span class="line"> <span class="number">73</span>                 + <span class="string">"Person.PersonID=Histrjn.PersonID order by Histrjn.PersonID,ChgTime"</span>;</span><br><span class="line"> <span class="number">74</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="number">75</span>             DB.OpenConn();</span><br><span class="line"> <span class="number">76</span>             rs = DB.executeQuery(sql);</span><br><span class="line"> <span class="number">77</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"> <span class="number">78</span>                 row = rs.getRow();</span><br><span class="line"> <span class="number">79</span>             &#125;</span><br><span class="line"> <span class="number">80</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"> <span class="number">81</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line"> <span class="number">82</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">83</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">84</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">85</span>                 sn[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">86</span>                 sn[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">87</span>                 sn[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">" "</span>;</span><br><span class="line"> <span class="number">88</span>             &#125;</span><br><span class="line"> <span class="number">89</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="number">90</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"> <span class="number">91</span>                 rs.first();</span><br><span class="line"> <span class="number">92</span>                 rs.previous();</span><br><span class="line"> <span class="number">93</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"> <span class="number">94</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"JourNo"</span>);</span><br><span class="line"> <span class="number">95</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"> <span class="number">96</span>                     sn[i][<span class="number">2</span>] = deptBean.getDeptStr(rs.getString(<span class="string">"OldInfo"</span>));</span><br><span class="line"> <span class="number">97</span>                     sn[i][<span class="number">3</span>] = deptBean.getDeptStr(rs.getString(<span class="string">"NewInfo"</span>));</span><br><span class="line"> <span class="number">98</span>                     sn[i][<span class="number">4</span>] = rs.getString(<span class="string">"ChgTime"</span>);</span><br><span class="line"> <span class="number">99</span>                     sn[i][<span class="number">5</span>] = rs.getString(<span class="string">"RegDate"</span>);</span><br><span class="line"><span class="number">100</span>                     i++;</span><br><span class="line"><span class="number">101</span>                 &#125;</span><br><span class="line"><span class="number">102</span>             &#125;</span><br><span class="line"><span class="number">103</span>         &#125;</span><br><span class="line"><span class="number">104</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">105</span>             </span><br><span class="line"><span class="number">106</span>         &#125;</span><br><span class="line"><span class="number">107</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">108</span>             DB.closeStmt();</span><br><span class="line"><span class="number">109</span>             DB.closeConn();</span><br><span class="line"><span class="number">110</span>         &#125;</span><br><span class="line"><span class="number">111</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">112</span>     &#125;</span><br><span class="line"><span class="number">113</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">114      * 查询所有记录</span></span><br><span class="line"><span class="comment">115      */</span></span><br><span class="line"><span class="number">116</span>     <span class="keyword">public</span> String[][] searchAllForSalary()</span><br><span class="line"><span class="number">117</span>     &#123;</span><br><span class="line"><span class="number">118</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">119</span>         </span><br><span class="line"><span class="number">120</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">121</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">122</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">123</span>         sql = <span class="string">"select * from Histrjn,Person where Fromacc='劳资分配' and "</span></span><br><span class="line"><span class="number">124</span>                 + <span class="string">"Person.PersonID=Histrjn.PersonID order by Histrjn.PersonID,ChgTime"</span>;</span><br><span class="line"><span class="number">125</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">126</span>             DB.OpenConn();</span><br><span class="line"><span class="number">127</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">128</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">129</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">130</span>             &#125;</span><br><span class="line"><span class="number">131</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">132</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line"><span class="number">133</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">134</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">135</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">136</span>                 sn[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">137</span>                 sn[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">138</span>                 sn[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">139</span>             &#125;</span><br><span class="line"><span class="number">140</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">141</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"><span class="number">142</span>                 rs.first();</span><br><span class="line"><span class="number">143</span>                 rs.previous();</span><br><span class="line"><span class="number">144</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">145</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"JourNo"</span>);</span><br><span class="line"><span class="number">146</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"><span class="number">147</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"OldInfo"</span>);</span><br><span class="line"><span class="number">148</span>                     sn[i][<span class="number">3</span>] = rs.getString(<span class="string">"NewInfo"</span>);</span><br><span class="line"><span class="number">149</span>                     sn[i][<span class="number">4</span>] = rs.getString(<span class="string">"ChgTime"</span>);</span><br><span class="line"><span class="number">150</span>                     sn[i][<span class="number">5</span>] = rs.getString(<span class="string">"RegDate"</span>);</span><br><span class="line"><span class="number">151</span>                     i++;</span><br><span class="line"><span class="number">152</span>                 &#125;</span><br><span class="line"><span class="number">153</span>             &#125;</span><br><span class="line"><span class="number">154</span>         &#125;</span><br><span class="line"><span class="number">155</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">156</span>             </span><br><span class="line"><span class="number">157</span>         &#125;</span><br><span class="line"><span class="number">158</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">159</span>             DB.closeStmt();</span><br><span class="line"><span class="number">160</span>             DB.closeConn();</span><br><span class="line"><span class="number">161</span>         &#125;</span><br><span class="line"><span class="number">162</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">163</span>     &#125;</span><br><span class="line"><span class="number">164</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">165      * 查询所有记录</span></span><br><span class="line"><span class="comment">166      */</span></span><br><span class="line"><span class="number">167</span>     <span class="keyword">public</span> String[][] searchAllForAssess()</span><br><span class="line"><span class="number">168</span>     &#123;</span><br><span class="line"><span class="number">169</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">170</span>         </span><br><span class="line"><span class="number">171</span>         String[][] sn = <span class="keyword">null</span>;</span><br><span class="line"><span class="number">172</span>         <span class="keyword">int</span> row = <span class="number">0</span>;</span><br><span class="line"><span class="number">173</span>         <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="number">174</span>         sql = <span class="string">"select * from Histrjn,Person where Fromacc='人员考核' and "</span></span><br><span class="line"><span class="number">175</span>                 + <span class="string">"Person.PersonID=Histrjn.PersonID order by Histrjn.PersonID,ChgTime"</span>;</span><br><span class="line"><span class="number">176</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">177</span>             DB.OpenConn();</span><br><span class="line"><span class="number">178</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">179</span>             <span class="keyword">if</span>(rs.last())&#123;</span><br><span class="line"><span class="number">180</span>                 row = rs.getRow();</span><br><span class="line"><span class="number">181</span>             &#125;</span><br><span class="line"><span class="number">182</span>             <span class="keyword">if</span>(row==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="number">183</span>                 sn = <span class="keyword">new</span> String[<span class="number">1</span>][<span class="number">6</span>];</span><br><span class="line"><span class="number">184</span>                 sn[<span class="number">0</span>][<span class="number">0</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">185</span>                 sn[<span class="number">0</span>][<span class="number">1</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">186</span>                 sn[<span class="number">0</span>][<span class="number">2</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">187</span>                 sn[<span class="number">0</span>][<span class="number">3</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">188</span>                 sn[<span class="number">0</span>][<span class="number">4</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">189</span>                 sn[<span class="number">0</span>][<span class="number">5</span>] = <span class="string">" "</span>;</span><br><span class="line"><span class="number">190</span>             &#125;</span><br><span class="line"><span class="number">191</span>             <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="number">192</span>                 sn = <span class="keyword">new</span> String[row][<span class="number">6</span>];</span><br><span class="line"><span class="number">193</span>                 rs.first();</span><br><span class="line"><span class="number">194</span>                 rs.previous();</span><br><span class="line"><span class="number">195</span>                 <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line"><span class="number">196</span>                     sn[i][<span class="number">0</span>] = rs.getString(<span class="string">"JourNo"</span>);</span><br><span class="line"><span class="number">197</span>                     sn[i][<span class="number">1</span>] = rs.getString(<span class="string">"Name"</span>);</span><br><span class="line"><span class="number">198</span>                     sn[i][<span class="number">2</span>] = rs.getString(<span class="string">"OldInfo"</span>);</span><br><span class="line"><span class="number">199</span>                     sn[i][<span class="number">3</span>] = rs.getString(<span class="string">"NewInfo"</span>);</span><br><span class="line"><span class="number">200</span>                     sn[i][<span class="number">4</span>] = rs.getString(<span class="string">"ChgTime"</span>);</span><br><span class="line"><span class="number">201</span>                     sn[i][<span class="number">5</span>] = rs.getString(<span class="string">"RegDate"</span>);</span><br><span class="line"><span class="number">202</span>                     i++;</span><br><span class="line"><span class="number">203</span>                 &#125;</span><br><span class="line"><span class="number">204</span>             &#125;</span><br><span class="line"><span class="number">205</span>         &#125;</span><br><span class="line"><span class="number">206</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">207</span>             </span><br><span class="line"><span class="number">208</span>         &#125;</span><br><span class="line"><span class="number">209</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">210</span>             DB.closeStmt();</span><br><span class="line"><span class="number">211</span>             DB.closeConn();</span><br><span class="line"><span class="number">212</span>         &#125;</span><br><span class="line"><span class="number">213</span>         <span class="keyword">return</span> sn;</span><br><span class="line"><span class="number">214</span>     &#125;</span><br><span class="line"><span class="number">215</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">216      * 获得新的ID</span></span><br><span class="line"><span class="comment">217      */</span></span><br><span class="line"><span class="number">218</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span></span><br><span class="line"><span class="function">219     </span>&#123;</span><br><span class="line"><span class="number">220</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">221</span>         <span class="keyword">int</span> ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">222</span>         sql = <span class="string">"select max(JourNo) from Histrjn"</span>;</span><br><span class="line"><span class="number">223</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">224</span>             DB.OpenConn();</span><br><span class="line"><span class="number">225</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">226</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">227</span>                 ID = rs.getInt(<span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="number">228</span>             &#125;</span><br><span class="line"><span class="number">229</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">230</span>                 ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">231</span>         &#125;</span><br><span class="line"><span class="number">232</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">233</span>             </span><br><span class="line"><span class="number">234</span>         &#125;</span><br><span class="line"><span class="number">235</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">236</span>             DB.closeStmt();</span><br><span class="line"><span class="number">237</span>             DB.closeConn();</span><br><span class="line"><span class="number">238</span>         &#125;</span><br><span class="line"><span class="number">239</span>         <span class="keyword">return</span> ID;</span><br><span class="line"><span class="number">240</span>     &#125;</span><br><span class="line"><span class="number">241</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">242      * 获得新的ID</span></span><br><span class="line"><span class="comment">243      */</span></span><br><span class="line"><span class="number">244</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getChgTime</span><span class="params">(String f2,String f7)</span></span></span><br><span class="line"><span class="function">245     </span>&#123;</span><br><span class="line"><span class="number">246</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">247</span>         <span class="keyword">int</span> ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">248</span>         sql = <span class="string">"select max(ChgTime) from Histrjn where FromAcc='"</span>+f2+<span class="string">"' and PersonID="</span>+f7;</span><br><span class="line"><span class="number">249</span>         System.out.println(<span class="string">"sql="</span>+sql);</span><br><span class="line"><span class="number">250</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">251</span>             DB.OpenConn();</span><br><span class="line"><span class="number">252</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">253</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">254</span>                 ID = rs.getInt(<span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="number">255</span>             &#125;</span><br><span class="line"><span class="number">256</span>             <span class="keyword">else</span></span><br><span class="line"><span class="number">257</span>                 ID = <span class="number">1</span>;</span><br><span class="line"><span class="number">258</span>         &#125;</span><br><span class="line"><span class="number">259</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">260</span>             </span><br><span class="line"><span class="number">261</span>         &#125;</span><br><span class="line"><span class="number">262</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">263</span>             DB.closeStmt();</span><br><span class="line"><span class="number">264</span>             DB.closeConn();</span><br><span class="line"><span class="number">265</span>         &#125;</span><br><span class="line"><span class="number">266</span>         <span class="keyword">return</span> ID;</span><br><span class="line"><span class="number">267</span>     &#125;</span><br><span class="line"><span class="number">268</span>     <span class="comment">/**</span></span><br><span class="line"><span class="comment">269      * 判断是否有记录</span></span><br><span class="line"><span class="comment">270      */</span></span><br><span class="line"><span class="number">271</span>     <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRows</span><span class="params">(String f7)</span></span></span><br><span class="line"><span class="function">272     </span>&#123;</span><br><span class="line"><span class="number">273</span>         Database DB = <span class="keyword">new</span> Database();</span><br><span class="line"><span class="number">274</span>         </span><br><span class="line"><span class="number">275</span>         <span class="keyword">boolean</span> have = <span class="keyword">true</span>;</span><br><span class="line"><span class="number">276</span>         sql = <span class="string">"select * from Histrjn where PersonID="</span>+f7;</span><br><span class="line"><span class="number">277</span>         <span class="keyword">try</span>&#123;</span><br><span class="line"><span class="number">278</span>             DB.OpenConn();</span><br><span class="line"><span class="number">279</span>             rs = DB.executeQuery(sql);</span><br><span class="line"><span class="number">280</span>             <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line"><span class="number">281</span>                 have = <span class="keyword">false</span>;</span><br><span class="line"><span class="number">282</span>             &#125;</span><br><span class="line"><span class="number">283</span>         &#125;</span><br><span class="line"><span class="number">284</span>         <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"><span class="number">285</span>             </span><br><span class="line"><span class="number">286</span>         &#125;</span><br><span class="line"><span class="number">287</span>         <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="number">288</span>             DB.closeStmt();</span><br><span class="line"><span class="number">289</span>             DB.closeConn();</span><br><span class="line"><span class="number">290</span>         &#125;</span><br><span class="line"><span class="number">291</span>         <span class="keyword">return</span> have;</span><br><span class="line"><span class="number">292</span>     &#125;</span><br><span class="line"><span class="number">293</span> &#125;</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><blockquote><p>Original author: Yan XiGun</p><p>Original link: <a href="https://yanxigun99.github.io/2020/01/27/study python 39 day/">https://yanxigun99.github.io/2020/01/27/study python 39 day/</a></p><p>Copyright Notice: Please indicate the source of the reprint (must retain the author's signature and link)</p></blockquote></div><div class="tags"><a href="/tags/java-%E9%A1%B9%E7%9B%AE/">java 项目</a></div><div class="post-share"><div class="social-share"><span>Share:</span></div></div><div class="post-nav"><a href="/2020/01/28/study%20python%2040%20day/" class="pre">study java day 40</a><a href="/2020/01/26/study%20python%2038%20day/" class="next">study java day 38</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Contents</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#java课程设计—-人事管理系统"><span class="toc-text">java课程设计—-人事管理系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#人事管理系统—-数据库操作类"><span class="toc-text">人事管理系统—-数据库操作类</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/12/20/hello-world/">Welcome to my Blog</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/study%20python%2060%20day/">study java day 60 第七个代码模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/15/study%20python%2059%20day/">study java day 59 实战：文件拷贝</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/14/study%20python%2058%20day/">study java day 58 正则表达式</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/13/study%20python%2057%20day/">study java day 57 第五个代码模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/12/study%20python%2056%20day/">study java day 56 多线程实战</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/11/study%20python%2055%20day/">study java day 55 设计模式-多例模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/10/study%20python%2054%20day/">study java day 54 设计模式-单例模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/09/study%20python%2053%20day/">study java day 53 代码模型-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/08/study%20python%2052%20day/">study java day 52 包和jar</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/300-lines-of-code/">300 lines of code</a><span class="category-list-count">42</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/code/">code</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E4%BB%A3%E7%A0%81%E6%A8%A1%E5%9E%8B/">java 代码模型</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E5%AE%9E%E6%88%98/">java 实战</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/">java 排序算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">java 正则表达式</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E7%9F%A5%E8%AF%86%E7%82%B9%E5%AE%9E%E6%88%98/">java 知识点实战</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/">java 知识点总结</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">java 设计模式</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E8%AF%BE%E7%A8%8B/">java 课程</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">java 课程笔记</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java-%E9%A1%B9%E7%9B%AE/">java 项目</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tool/">tool</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a><span class="category-list-count">9</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"><a href="/tags/Blog/" style="font-size: 15px;">Blog</a> <a href="/tags/code/" style="font-size: 15px;">code</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/MongoDB/" style="font-size: 15px;">MongoDB</a> <a href="/tags/MYSQL/" style="font-size: 15px;">MYSQL</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">项目</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">工具</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/java-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">java 课程笔记</a> <a href="/tags/java-%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">java 项目</a> <a href="/tags/java-%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/" style="font-size: 15px;">java 知识点总结</a> <a href="/tags/java-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" style="font-size: 15px;">java 排序算法</a> <a href="/tags/java-%E8%AF%BE%E7%A8%8B/" style="font-size: 15px;">java 课程</a> <a href="/tags/java-%E4%BB%A3%E7%A0%81%E6%A8%A1%E5%9E%8B/" style="font-size: 15px;">java 代码模型</a> <a href="/tags/java-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">java 设计模式</a> <a href="/tags/java-%E7%9F%A5%E8%AF%86%E7%82%B9%E5%AE%9E%E6%88%98/" style="font-size: 15px;">java 知识点实战</a> <a href="/tags/java-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 15px;">java 正则表达式</a> <a href="/tags/java-%E5%AE%9E%E6%88%98/" style="font-size: 15px;">java 实战</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archive</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">59</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">31</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> Blogroll</i></div><ul></ul><a href="https://www.nowcoder.com/" title="牛客网" target="_blank">牛客网</a><ul></ul><a href="https://www.ximalaya.com/" title="喜马拉雅" target="_blank">喜马拉雅</a><ul></ul><a href="https://www.csdn.net/" title="CSDN" target="_blank">CSDN</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Site Map</a> |  <a href="/atom.xml">Subscribe to this site</a> |  <a href="/about/">Contact the blogger</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">Yan XiGun.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>