<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    
    
    
    <title>log&amp;lom | time is the all zip</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    
    <meta name="theme-color" content="#77AAFF">
    
    
    <meta name="keywords" content="时间 努力 坚持">
    
    

    

    <!-- Baidu Push -->
<script>
	(function(){
		var bp = document.createElement('script');
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	})();

	var _hmt = _hmt || [];
</script>



    
    <meta name="description" content="在python的路上砥砺前行">
<meta property="og:type" content="website">
<meta property="og:title" content="log&amp;lom">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="log&amp;lom">
<meta property="og:description" content="在python的路上砥砺前行">
<meta property="article:author" content="Yan XiGun">
<meta property="article:tag" content="时间 努力 坚持">
<meta name="twitter:card" content="summary">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link id="style" rel="stylesheet" href="/css/style.css?v=3.0">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    
            
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>
    <aside id="menu"   >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" >
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg" alt="avatar">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname" id="name">Yan XiGun</h5>
          
            <div id="yiyanmotto" class="motto">&nbsp;</div>
          
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
              <li class="waves-block waves-effect">
                  <a href="/"  >
                    <i class="icon icon-lg icon-home"></i>
                    <span>主 页</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/archives"  >
                    <i class="icon icon-lg icon-archives"></i>
                    <span>归 档</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/categories"  >
                    <i class="icon icon-lg icon-th-list"></i>
                    <span>分 类</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/tags"  >
                    <i class="icon icon-lg icon-tags"></i>
                    <span>标 签</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/about"  >
                    <i class="icon icon-lg icon-smile-o"></i>
                    <span>关 于</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
      <div class="nav2">
          
              <a class="nav2item" data-title="Email" href="mailto:807403854@qq.com" target="_parent"title="Email" >
                <i class="icon icon-lg icon-envelope-o envelope-o"></i>
              </a>
          
              <a class="nav2item" data-title="Github" href="https://github.com/yanxigun99" target="_blank"title="Github" >
                <i class="icon icon-lg icon-github github"></i>
              </a>
          
              <a class="nav2item" data-title="微博" href="https://weibo.com/u/807403854" target="_blank"title="微博" >
                <i class="icon icon-lg icon-weibo weibo"></i>
              </a>
          

            </div>
        
      </ul>
        
    </div>
  </div>
 
</aside>


    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">log&amp;lom</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        <a href="../../atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" id="Rss">
            <i class="icon icon-lg icon-rss"></i>
        </a>
    </div>
</header>
<header class="content-header index-header">
    
    
    <div class="container fade-scale">
        <div id="myheader">
            <h1 class="title">
                 
                    log&amp;lom
                
            </h1>
            <h5 class="subtitle">
                
                    在python的道路上努力前行
                
            </h5>
        </div>
    </div>

</header>

<div class="container body-wrap">
    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-10"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-10/">python 2.X和3.X day 09-10</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line">Python2.x与<span class="number">3</span>​​.x版本区别</span><br><span class="line">Python的<span class="number">3</span>​​<span class="number">.0</span>版本，常被称为Python <span class="number">3000</span>，或简称Py3k。相对于Python的早期版本，这是一个较大的升级。</span><br><span class="line"></span><br><span class="line">为了不带入过多的累赘，Python <span class="number">3.0</span>在设计的时候没有考虑向下相容。</span><br><span class="line"></span><br><span class="line">许多针对早期Python版本设计的程式都无法在Python <span class="number">3.0</span>上正常执行。</span><br><span class="line"></span><br><span class="line">为了照顾现有程式，Python <span class="number">2.6</span>作为一个过渡版本，基本使用了Python <span class="number">2.</span>x的语法和库，同时考虑了向Python <span class="number">3.0</span>的迁移，允许使用部分Python <span class="number">3.0</span>的语法与函数。</span><br><span class="line"></span><br><span class="line">新的Python程式建议使用Python <span class="number">3.0</span>版本的语法。</span><br><span class="line"></span><br><span class="line">除非执行环境无法安装Python <span class="number">3.0</span>或者程式本身使用了不支援Python <span class="number">3.0</span>的第三方库。目前不支援Python <span class="number">3.0</span>的第三方库有Twisted, py2exe, PIL等。</span><br><span class="line"></span><br><span class="line">大多数第三方库都正在努力地相容Python <span class="number">3.0</span>版本。即使无法立即使用Python <span class="number">3.0</span>，也建议编写相容Python <span class="number">3.0</span>版本的程式，然后使用Python <span class="number">2.6</span>, Python <span class="number">2.7</span>来执行。</span><br><span class="line"></span><br><span class="line">Python <span class="number">3.0</span>的变化主要在以下几个方面:</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> 函数</span><br><span class="line"><span class="keyword">print</span>语句没有了，取而代之的是print()函数。 Python <span class="number">2.6</span>与Python <span class="number">2.7</span>部分地支持这种形式的<span class="keyword">print</span>语法。在Python <span class="number">2.6</span>与Python <span class="number">2.7</span>里面，以下三种形式是等价的：</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"fish"</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"fish"</span>) <span class="comment">#注意print后面有个空格</span></span><br><span class="line">print(<span class="string">"fish"</span>) <span class="comment">#print()不能带有任何其它参数</span></span><br><span class="line">然而，Python <span class="number">2.6</span>实际已经支持新的print()语法：</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line">print(<span class="string">"fish"</span>, <span class="string">"panda"</span>, sep=<span class="string">', '</span>)</span><br><span class="line">Unicode</span><br><span class="line">Python <span class="number">2</span> 有 ASCII str() 类型，unicode() 是单独的，不是 byte 类型。</span><br><span class="line"></span><br><span class="line">现在， 在 Python <span class="number">3</span>，我们最终有了 Unicode (utf<span class="number">-8</span>) 字符串，以及一个字节类：byte 和 bytearrays。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">由于 Python3.X 源码文件默认使用utf<span class="number">-8</span>编码，这就使得以下代码是合法的：</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>中国 = <span class="string">'china'</span> </span><br><span class="line">&gt;&gt;&gt;print(中国) </span><br><span class="line">china</span><br><span class="line">Python <span class="number">2.</span>x</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str = <span class="string">"我爱北京天安门"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str</span><br><span class="line"><span class="string">'\xe6\x88\x91\xe7\x88\xb1\xe5\x8c\x97\xe4\xba\xac\xe5\xa4\xa9\xe5\xae\x89\xe9\x97\xa8'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str = <span class="string">u"我爱北京天安门"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str</span><br><span class="line"><span class="string">u'\u6211\u7231\u5317\u4eac\u5929\u5b89\u95e8'</span></span><br><span class="line">Python <span class="number">3.</span>x</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str = <span class="string">"我爱北京天安门"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str</span><br><span class="line"><span class="string">'我爱北京天安门'</span></span><br><span class="line">除法运算</span><br><span class="line">Python中的除法较其它语言显得非常高端，有套很复杂的规则。Python中的除法有两个运算符，/和//</span><br><span class="line"></span><br><span class="line">首先来说/除法:</span><br><span class="line"></span><br><span class="line">在python <span class="number">2.</span>x中/除法就跟我们熟悉的大多数语言，比如Java啊C啊差不多，整数相除的结果是一个整数，把小数部分完全忽略掉，浮点数除法会保留小数点的部分得到一个浮点数的结果。</span><br><span class="line"></span><br><span class="line">在python <span class="number">3.</span>x中/除法不再这么做了，对于整数之间的相除，结果也会是浮点数。</span><br><span class="line"></span><br><span class="line">Python <span class="number">2.</span>x:</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> / <span class="number">2</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1.0</span> / <span class="number">2.0</span></span><br><span class="line"><span class="number">0.5</span></span><br><span class="line">Python <span class="number">3.</span>x:</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span>/<span class="number">2</span></span><br><span class="line"><span class="number">0.5</span></span><br><span class="line">而对于//除法，这种除法叫做floor除法，会对除法的结果自动进行一个floor操作，在python <span class="number">2.</span>x和python <span class="number">3.</span>x中是一致的。</span><br><span class="line"></span><br><span class="line">python <span class="number">2.</span>x:</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-1</span> // <span class="number">2</span></span><br><span class="line"><span class="number">-1</span></span><br><span class="line">python <span class="number">3.</span>x:</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-1</span> // <span class="number">2</span></span><br><span class="line"><span class="number">-1</span></span><br><span class="line">注意的是并不是舍弃小数部分，而是执行 floor 操作，如果要截取整数部分，那么需要使用 math 模块的 trunc 函数</span><br><span class="line"></span><br><span class="line">python <span class="number">3.</span>x:</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.trunc(<span class="number">1</span> / <span class="number">2</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.trunc(<span class="number">-1</span> / <span class="number">2</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line">异常</span><br><span class="line">在 Python <span class="number">3</span> 中处理异常也轻微的改变了，在 Python <span class="number">3</span> 中我们现在使用 <span class="keyword">as</span> 作为关键词。</span><br><span class="line"></span><br><span class="line">捕获异常的语法由 <span class="keyword">except</span> exc, var 改为 <span class="keyword">except</span> exc <span class="keyword">as</span> var。</span><br><span class="line"></span><br><span class="line">使用语法<span class="keyword">except</span> (exc1, exc2) <span class="keyword">as</span> var可以同时捕获多种类别的异常。 Python <span class="number">2.6</span>已经支持这两种语法。</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 在<span class="number">2.</span>x时代，所有类型的对象都是可以被直接抛出的，在<span class="number">3.</span>x时代，只有继承自BaseException的对象才可以被抛出。</span><br><span class="line"><span class="number">2.</span> <span class="number">2.</span>x <span class="keyword">raise</span>语句使用逗号将抛出对象类型和参数分开，<span class="number">3.</span>x取消了这种奇葩的写法，直接调用构造函数抛出对象即可。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在<span class="number">2.</span>x时代，异常在代码中除了表示程序错误，还经常做一些普通控制结构应该做的事情，在<span class="number">3.</span>x中可以看出，设计者让异常变的更加专一，只有在错误发生的情况才能去用异常捕获语句来处理。</span><br><span class="line"></span><br><span class="line">xrange</span><br><span class="line">在 Python <span class="number">2</span> 中 xrange() 创建迭代对象的用法是非常流行的。比如： <span class="keyword">for</span> 循环或者是列表/集合/字典推导式。</span><br><span class="line"></span><br><span class="line">这个表现十分像生成器（比如。<span class="string">"惰性求值"</span>）。但是这个 xrange-iterable 是无穷的，意味着你可以无限遍历。</span><br><span class="line"></span><br><span class="line">由于它的惰性求值，如果你不得仅仅不遍历它一次，xrange() 函数 比 range() 更快（比如 <span class="keyword">for</span> 循环）。尽管如此，对比迭代一次，不建议你重复迭代多次，因为生成器每次都从头开始。</span><br><span class="line"></span><br><span class="line">在 Python <span class="number">3</span> 中，range() 是像 xrange() 那样实现以至于一个专门的 xrange() 函数都不再存在（在 Python <span class="number">3</span> 中 xrange() 会抛出命名异常）。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line">n = <span class="number">10000</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_range</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_xrange</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(n):</span><br><span class="line">        <span class="keyword">pass</span>   </span><br><span class="line">Python <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Python'</span>, python_version()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'\ntiming range()'</span> </span><br><span class="line">%timeit test_range(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'\n\ntiming xrange()'</span> </span><br><span class="line">%timeit test_xrange(n)</span><br><span class="line"></span><br><span class="line">Python <span class="number">2.7</span><span class="number">.6</span></span><br><span class="line"></span><br><span class="line">timing range()</span><br><span class="line"><span class="number">1000</span> loops, best of <span class="number">3</span>: <span class="number">433</span> µs per loop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">timing xrange()</span><br><span class="line"><span class="number">1000</span> loops, best of <span class="number">3</span>: <span class="number">350</span> µs per loop</span><br><span class="line">Python <span class="number">3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'Python'</span>, python_version())</span><br><span class="line"></span><br><span class="line">print(<span class="string">'\ntiming range()'</span>)</span><br><span class="line">%timeit test_range(n)</span><br><span class="line"></span><br><span class="line">Python <span class="number">3.4</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">timing range()</span><br><span class="line"><span class="number">1000</span> loops, best of <span class="number">3</span>: <span class="number">520</span> µs per loop</span><br><span class="line">print(xrange(<span class="number">10</span>))</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">NameError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-5</span><span class="number">-5</span>d8f9b79ea70&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 print(xrange(10))</span><br><span class="line"></span><br><span class="line">NameError: name <span class="string">'xrange'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line">八进制字面量表示</span><br><span class="line">八进制数必须写成<span class="number">0o777</span>，原来的形式<span class="number">0777</span>不能用了；二进制必须写成<span class="number">0b111</span>。</span><br><span class="line"></span><br><span class="line">新增了一个bin()函数用于将一个整数转换成二进制字串。 Python <span class="number">2.6</span>已经支持这两种语法。</span><br><span class="line"></span><br><span class="line">在Python <span class="number">3.</span>x中，表示八进制字面量的方式只有一种，就是<span class="number">0o1000</span>。</span><br><span class="line"></span><br><span class="line">python <span class="number">2.</span>x</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">0o1000</span></span><br><span class="line"><span class="number">512</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">01000</span></span><br><span class="line"><span class="number">512</span></span><br><span class="line">python <span class="number">3.</span>x</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">01000</span></span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span></span><br><span class="line">    <span class="number">01000</span></span><br><span class="line">        ^</span><br><span class="line">SyntaxError: invalid token</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">0o1000</span></span><br><span class="line"><span class="number">512</span></span><br><span class="line">不等运算符</span><br><span class="line">Python <span class="number">2.</span>x中不等于有两种写法 != 和 &lt;&gt;</span><br><span class="line"></span><br><span class="line">Python <span class="number">3.</span>x中去掉了&lt;&gt;, 只有!=一种写法，还好，我从来没有使用&lt;&gt;的习惯</span><br><span class="line"></span><br><span class="line">去掉了repr表达式``</span><br><span class="line">Python <span class="number">2.</span>x 中反引号``相当于repr函数的作用</span><br><span class="line"></span><br><span class="line">Python <span class="number">3.</span>x 中去掉了``这种写法，只允许使用repr函数，这样做的目的是为了使代码看上去更清晰么？不过我感觉用repr的机会很少，一般只在debug的时候才用，多数时候还是用str函数来用字符串描述对象。</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendMail</span><span class="params">(from_: str, to: str, title: str, body: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">多个模块被改名（根据PEP8）</span><br><span class="line">旧的名字	新的名字</span><br><span class="line">_winreg	winreg</span><br><span class="line">ConfigParser	configparser</span><br><span class="line">copy_reg	copyreg</span><br><span class="line">Queue	queue</span><br><span class="line">SocketServer	socketserver</span><br><span class="line">repr	reprlib</span><br><span class="line">StringIO模块现在被合并到新的io模组内。 new, md5, gopherlib等模块被删除。 Python <span class="number">2.6</span>已经支援新的io模组。</span><br><span class="line"></span><br><span class="line">httplib, BaseHTTPServer, CGIHTTPServer, SimpleHTTPServer, Cookie, cookielib被合并到http包内。</span><br><span class="line"></span><br><span class="line">取消了<span class="keyword">exec</span>语句，只剩下exec()函数。 Python <span class="number">2.6</span>已经支援exec()函数。</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>数据类型</span><br><span class="line"><span class="number">1</span>）Py3.X去除了long类型，现在只有一种整型——int，但它的行为就像<span class="number">2.</span>X版本的long</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>）新增了bytes类型，对应于<span class="number">2.</span>X版本的八位串，定义一个bytes字面量的方法如下：</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">b'china'</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(b) </span><br><span class="line">&lt;type <span class="string">'bytes'</span>&gt; </span><br><span class="line">str 对象和 bytes 对象可以使用 .encode() (str -&gt; bytes) 或 .decode() (bytes -&gt; str)方法相互转化。</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = b.decode() </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s </span><br><span class="line"><span class="string">'china'</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b1 = s.encode() </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b1 </span><br><span class="line"><span class="string">b'china'</span> </span><br><span class="line"><span class="number">3</span>）dict的.keys()、.items 和.values()方法返回迭代器，而之前的iterkeys()等函数都被废弃。同时去掉的还有 dict.has_key()，用 <span class="keyword">in</span>替代它吧 。</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-10/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-3"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-3/">python CGI day 09-3</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br></pre></td><td class="code"><pre><span class="line">Python CGI编程</span><br><span class="line">什么是 CGI</span><br><span class="line">CGI 目前由 NCSA 维护，NCSA 定义 CGI 如下：</span><br><span class="line"></span><br><span class="line">CGI(Common Gateway Interface)，通用网关接口，它是一段程序，运行在服务器上如：HTTP 服务器，提供同客户端 HTML 页面的接口。</span><br><span class="line"></span><br><span class="line">网页浏览</span><br><span class="line">为了更好的了解 CGI 是如何工作的，我们可以从在网页上点击一个链接或 URL 的流程：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、使用你的浏览器访问 URL 并连接到 HTTP web 服务器。</span><br><span class="line"><span class="number">2</span>、Web 服务器接收到请求信息后会解析 URL，并查找访问的文件在服务器上是否存在，如果存在返回文件的内容，否则返回错误信息。</span><br><span class="line"><span class="number">3</span>、浏览器从服务器上接收信息，并显示接收的文件或者错误信息。</span><br><span class="line">CGI 程序可以是 Python 脚本，PERL 脚本，SHELL 脚本，C 或者 C++ 程序等。</span><br><span class="line"></span><br><span class="line">CGI架构图</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Web 服务器支持及配置</span><br><span class="line">在你进行 CGI 编程前，确保您的 Web 服务器支持 CGI 及已经配置了 CGI 的处理程序。</span><br><span class="line"></span><br><span class="line">Apache 支持 CGI 配置：</span><br><span class="line"></span><br><span class="line">设置好CGI目录：</span><br><span class="line"></span><br><span class="line">ScriptAlias /cgi-bin/ /var/www/cgi-bin/</span><br><span class="line">所有的HTTP服务器执行 CGI 程序都保存在一个预先配置的目录。这个目录被称为 CGI 目录，并按照惯例，它被命名为 /var/www/cgi-bin 目录。</span><br><span class="line"></span><br><span class="line">CGI 文件的扩展名为 .cgi，python 也可以使用 .py 扩展名。</span><br><span class="line"></span><br><span class="line">默认情况下，Linux 服务器配置运行的 cgi-bin 目录中为 /var/www。</span><br><span class="line"></span><br><span class="line">如果你想指定其他运行 CGI 脚本的目录，可以修改 httpd.conf 配置文件，如下所示：</span><br><span class="line"></span><br><span class="line">&lt;Directory <span class="string">"/var/www/cgi-bin"</span>&gt;</span><br><span class="line">   AllowOverride <span class="literal">None</span></span><br><span class="line">   Options +ExecCGI</span><br><span class="line">   Order allow,deny</span><br><span class="line">   Allow <span class="keyword">from</span> all</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">在 AddHandler 中添加 .py 后缀，这样我们就可以访问 .py 结尾的 python 脚本文件：</span><br><span class="line"></span><br><span class="line">AddHandler cgi-script .cgi .pl .py</span><br><span class="line">第一个CGI程序</span><br><span class="line">我们使用 Python 创建第一个 CGI 程序，文件名为 hello.py，文件位于 /var/www/cgi-bin 目录中，内容如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span>                               <span class="comment"># 空行，告诉服务器结束头部</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;html&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;head&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;meta charset="utf-8"&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;title&gt;Hello World - 我的第一个 CGI 程序！&lt;/title&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;/head&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;body&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;h2&gt;Hello World! 我是来自菜鸟教程的第一CGI程序&lt;/h2&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;/body&gt;'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'&lt;/html&gt;'</span></span><br><span class="line">文件保存后修改 hello.py，修改文件权限为 <span class="number">755</span>：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> hello.py </span><br><span class="line">以上程序在浏览器访问 http://localhost/cgi-bin/hello.py 显示结果如下：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Hello World! 我是来自菜鸟教程的第一CGI程序</span><br><span class="line">这个的hello.py脚本是一个简单的Python脚本，脚本第一行的输出内容<span class="string">"Content-type:text/html"</span>发送到浏览器并告知浏览器显示的内容类型为<span class="string">"text/html"</span>。</span><br><span class="line"></span><br><span class="line">用 <span class="keyword">print</span> 输出一个空行用于告诉服务器结束头部信息。</span><br><span class="line"></span><br><span class="line">HTTP头部</span><br><span class="line">hello.py文件内容中的<span class="string">" Content-type:text/html"</span>即为HTTP头部的一部分，它会发送给浏览器告诉浏览器文件的内容类型。</span><br><span class="line"></span><br><span class="line">HTTP头部的格式如下：</span><br><span class="line"></span><br><span class="line">HTTP 字段名: 字段内容</span><br><span class="line">例如：</span><br><span class="line"></span><br><span class="line">Content-type: text/html</span><br><span class="line">以下表格介绍了CGI程序中HTTP头部经常使用的信息：</span><br><span class="line"></span><br><span class="line">头	描述</span><br><span class="line">Content-type:	请求的与实体对应的MIME信息。例如: Content-type:text/html</span><br><span class="line">Expires: Date	响应过期的日期和时间</span><br><span class="line">Location: URL	用来重定向接收方到非请求URL的位置来完成请求或标识新的资源</span><br><span class="line">Last-modified: Date	请求资源的最后修改时间</span><br><span class="line">Content-length: N	请求的内容长度</span><br><span class="line">Set-Cookie: String	设置Http Cookie</span><br><span class="line">CGI环境变量</span><br><span class="line">所有的CGI程序都接收以下的环境变量，这些变量在CGI程序中发挥了重要的作用：</span><br><span class="line"></span><br><span class="line">变量名	描述</span><br><span class="line">CONTENT_TYPE	这个环境变量的值指示所传递来的信息的MIME类型。目前，环境变量CONTENT_TYPE一般都是：application/x-www-form-urlencoded,他表示数据来自于HTML表单。</span><br><span class="line">CONTENT_LENGTH	如果服务器与CGI程序信息的传递方式是POST，这个环境变量即使从标准输入STDIN中可以读到的有效数据的字节数。这个环境变量在读取所输入的数据时必须使用。</span><br><span class="line">HTTP_COOKIE	客户机内的 COOKIE 内容。</span><br><span class="line">HTTP_USER_AGENT	提供包含了版本数或其他专有数据的客户浏览器信息。</span><br><span class="line">PATH_INFO	这个环境变量的值表示紧接在CGI程序名之后的其他路径信息。它常常作为CGI程序的参数出现。</span><br><span class="line">QUERY_STRING	如果服务器与CGI程序信息的传递方式是GET，这个环境变量的值即使所传递的信息。这个信息经跟在CGI程序名的后面，两者中间用一个问号<span class="string">'?'</span>分隔。</span><br><span class="line">REMOTE_ADDR	这个环境变量的值是发送请求的客户机的IP地址，例如上面的<span class="number">192.168</span><span class="number">.1</span><span class="number">.67</span>。这个值总是存在的。而且它是Web客户机需要提供给Web服务器的唯一标识，可以在CGI程序中用它来区分不同的Web客户机。</span><br><span class="line">REMOTE_HOST	这个环境变量的值包含发送CGI请求的客户机的主机名。如果不支持你想查询，则无需定义此环境变量。</span><br><span class="line">REQUEST_METHOD	提供脚本被调用的方法。对于使用 HTTP/<span class="number">1.0</span> 协议的脚本，仅 GET 和 POST 有意义。</span><br><span class="line">SCRIPT_FILENAME	CGI脚本的完整路径</span><br><span class="line">SCRIPT_NAME	CGI脚本的的名称</span><br><span class="line">SERVER_NAME	这是你的 WEB 服务器的主机名、别名或IP地址。</span><br><span class="line">SERVER_SOFTWARE	这个环境变量的值包含了调用CGI程序的HTTP服务器的名称和版本号。例如，上面的值为Apache/<span class="number">2.2</span><span class="number">.14</span>(Unix)</span><br><span class="line">以下是一个简单的CGI脚本输出CGI的环境变量：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="comment"># filename:test.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type: text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;b&gt;环境变量&lt;/b&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;ul&gt;"</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> os.environ.keys():</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"&lt;li&gt;&lt;span style='color:green'&gt;%30s &lt;/span&gt; : %s &lt;/li&gt;"</span> % (key,os.environ[key])</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/ul&gt;"</span></span><br><span class="line">将以上点保存为 test.py ,并修改文件权限为 <span class="number">755</span>，执行结果如下：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET和POST方法</span><br><span class="line">浏览器客户端通过两种方法向服务器传递信息，这两种方法就是 GET 方法和 POST 方法。</span><br><span class="line"></span><br><span class="line">使用GET方法传输数据</span><br><span class="line">GET方法发送编码后的用户信息到服务端，数据信息包含在请求页面的URL上，以<span class="string">"?"</span>号分割, 如下所示：</span><br><span class="line"></span><br><span class="line">http://www.test.com/cgi-bin/hello.py?key1=value1&amp;key2=value2</span><br><span class="line">有关 GET 请求的其他一些注释：</span><br><span class="line"></span><br><span class="line">GET 请求可被缓存</span><br><span class="line">GET 请求保留在浏览器历史记录中</span><br><span class="line">GET 请求可被收藏为书签</span><br><span class="line">GET 请求不应在处理敏感数据时使用</span><br><span class="line">GET 请求有长度限制</span><br><span class="line">GET 请求只应当用于取回数据</span><br><span class="line">简单的url实例：GET方法</span><br><span class="line">以下是一个简单的URL，使用GET方法向hello_get.py程序发送两个参数：</span><br><span class="line"></span><br><span class="line">/cgi-bin/test.py?name=菜鸟教程&amp;url=http://www.runoob.com</span><br><span class="line">以下为hello_get.py文件的代码：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># filename：test.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CGI处理模块</span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage 的实例化</span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取数据</span></span><br><span class="line">site_name = form.getvalue(<span class="string">'name'</span>)</span><br><span class="line">site_url  = form.getvalue(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt;%s官网：%s&lt;/h2&gt;"</span> % (site_name, site_url)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">文件保存后修改 hello_get.py，修改文件权限为 <span class="number">755</span>：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> hello_get.py </span><br><span class="line">浏览器请求输出结果：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">简单的表单实例：GET方法</span><br><span class="line">以下是一个通过HTML的表单使用GET方法向服务器发送两个数据，提交的服务器脚本同样是hello_get.py文件，hello_get.html 代码如下：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/hello_get.py"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">站点名称: &lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;  &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">站点 URL: &lt;input type=<span class="string">"text"</span> name=<span class="string">"url"</span> /&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">默认情况下 cgi-bin 目录只能存放脚本文件，我们将 hello_get.html 存储在 test 目录下，修改文件权限为 <span class="number">755</span>：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> hello_get.html</span><br><span class="line">Gif 演示如下所示：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用POST方法传递数据</span><br><span class="line">使用POST方法向服务器传递数据是更安全可靠的，像一些敏感信息如用户密码等需要使用POST传输数据。</span><br><span class="line"></span><br><span class="line">以下同样是hello_get.py ，它也可以处理浏览器提交的POST表单数据:</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CGI处理模块</span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage 的实例化</span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取数据</span></span><br><span class="line">site_name = form.getvalue(<span class="string">'name'</span>)</span><br><span class="line">site_url  = form.getvalue(<span class="string">'url'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt;%s官网：%s&lt;/h2&gt;"</span> % (site_name, site_url)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">以下为表单通过POST方法（method=<span class="string">"post"</span>）向服务器脚本 hello_get.py 提交数据:</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/hello_get.py"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">站点名称: &lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;  &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">站点 URL: &lt;input type=<span class="string">"text"</span> name=<span class="string">"url"</span> /&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">Gif 演示如下所示：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过CGI程序传递checkbox数据</span><br><span class="line">checkbox用于提交一个或者多个选项数据，HTML代码如下：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/checkbox.py"</span> method=<span class="string">"POST"</span> target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> name=<span class="string">"runoob"</span> value=<span class="string">"on"</span> /&gt; 菜鸟教程</span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> name=<span class="string">"google"</span> value=<span class="string">"on"</span> /&gt; Google</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"选择站点"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">以下为 checkbox.py 文件的代码：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入 CGI 处理模块 </span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage的实例 </span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收字段数据</span></span><br><span class="line"><span class="keyword">if</span> form.getvalue(<span class="string">'google'</span>):</span><br><span class="line">   google_flag = <span class="string">"是"</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   google_flag = <span class="string">"否"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> form.getvalue(<span class="string">'runoob'</span>):</span><br><span class="line">   runoob_flag = <span class="string">"是"</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   runoob_flag = <span class="string">"否"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt; 菜鸟教程是否选择了 : %s&lt;/h2&gt;"</span> % runoob_flag</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt; Google 是否选择了 : %s&lt;/h2&gt;"</span> % google_flag</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">修改 checkbox.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> checkbox.py</span><br><span class="line">浏览器访问 Gif 演示图：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过CGI程序传递Radio数据</span><br><span class="line">Radio 只向服务器传递一个数据，HTML代码如下：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/radiobutton.py"</span> method=<span class="string">"post"</span> target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"radio"</span> name=<span class="string">"site"</span> value=<span class="string">"runoob"</span> /&gt; 菜鸟教程</span><br><span class="line">&lt;input type=<span class="string">"radio"</span> name=<span class="string">"site"</span> value=<span class="string">"google"</span> /&gt; Google</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">radiobutton.py 脚本代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入 CGI 处理模块 </span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage的实例 </span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收字段数据</span></span><br><span class="line"><span class="keyword">if</span> form.getvalue(<span class="string">'site'</span>):</span><br><span class="line">   site = form.getvalue(<span class="string">'site'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   site = <span class="string">"提交数据为空"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt; 选中的网站是 %s&lt;/h2&gt;"</span> % site</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">修改 radiobutton.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> radiobutton.py</span><br><span class="line">浏览器访问 Gif 演示图：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过CGI程序传递 Textarea 数据</span><br><span class="line">Textarea 向服务器传递多行数据，HTML代码如下：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/textarea.py"</span> method=<span class="string">"post"</span> target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">&lt;textarea name=<span class="string">"textcontent"</span> cols=<span class="string">"40"</span> rows=<span class="string">"4"</span>&gt;</span><br><span class="line">在这里输入内容...</span><br><span class="line">&lt;/textarea&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">textarea.py 脚本代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入 CGI 处理模块 </span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage的实例 </span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收字段数据</span></span><br><span class="line"><span class="keyword">if</span> form.getvalue(<span class="string">'textcontent'</span>):</span><br><span class="line">   text_content = form.getvalue(<span class="string">'textcontent'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   text_content = <span class="string">"没有内容"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt; 输入的内容是：%s&lt;/h2&gt;"</span> % text_content</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">修改 textarea.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> textarea.py</span><br><span class="line">浏览器访问 Gif 演示图：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过CGI程序传递下拉数据。</span><br><span class="line">HTML 下拉框代码如下：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/cgi-bin/dropdown.py"</span> method=<span class="string">"post"</span> target=<span class="string">"_blank"</span>&gt;</span><br><span class="line">&lt;select name=<span class="string">"dropdown"</span>&gt;</span><br><span class="line">&lt;option value="runoob" selected&gt;菜鸟教程&lt;/option&gt;</span><br><span class="line">&lt;option value="google"&gt;Google&lt;/option&gt;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">dropdown.py 脚本代码如下所示：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入 CGI 处理模块 </span></span><br><span class="line"><span class="keyword">import</span> cgi, cgitb </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 FieldStorage的实例 </span></span><br><span class="line">form = cgi.FieldStorage() </span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收字段数据</span></span><br><span class="line"><span class="keyword">if</span> form.getvalue(<span class="string">'dropdown'</span>):</span><br><span class="line">   dropdown_value = form.getvalue(<span class="string">'dropdown'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   dropdown_value = <span class="string">"没有内容"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type:text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;html&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;meta charset=\"utf-8\"&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;title&gt;菜鸟教程 CGI 测试实例&lt;/title&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/head&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;h2&gt; 选中的选项是：%s&lt;/h2&gt;"</span> % dropdown_value</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/body&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;/html&gt;"</span></span><br><span class="line">修改 dropdown.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> dropdown.py</span><br><span class="line">浏览器访问 Gif 演示图：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGI中使用Cookie</span><br><span class="line">在 http 协议一个很大的缺点就是不对用户身份的进行判断，这样给编程人员带来很大的不便， 而 cookie 功能的出现弥补了这个不足。</span><br><span class="line"></span><br><span class="line">cookie 就是在客户访问脚本的同时，通过客户的浏览器，在客户硬盘上写入纪录数据 ，当下次客户访问脚本时取回数据信息，从而达到身份判别的功能，cookie 常用在身份校验中。</span><br><span class="line"></span><br><span class="line">　</span><br><span class="line"></span><br><span class="line">cookie的语法</span><br><span class="line">http cookie的发送是通过http头部来实现的，他早于文件的传递，头部set-cookie的语法如下：</span><br><span class="line"></span><br><span class="line">Set-cookie:name=name;expires=date;path=path;domain=domain;secure </span><br><span class="line">name=name: 需要设置cookie的值(name不能使用<span class="string">";"</span>和<span class="string">","</span>号),有多个name值时用 <span class="string">";"</span> 分隔，例如：name1=name1;name2=name2;name3=name3。</span><br><span class="line">expires=date: cookie的有效期限,格式： expires=<span class="string">"Wdy,DD-Mon-YYYY HH:MM:SS"</span></span><br><span class="line"></span><br><span class="line">path=path: 设置cookie支持的路径,如果path是一个路径，则cookie对这个目录下的所有文件及子目录生效，例如： path=<span class="string">"/cgi-bin/"</span>，如果path是一个文件，则cookie指对这个文件生效，例如：path=<span class="string">"/cgi-bin/cookie.cgi"</span>。</span><br><span class="line">domain=domain: 对cookie生效的域名，例如：domain=<span class="string">"www.runoob.com"</span></span><br><span class="line">secure: 如果给出此标志，表示cookie只能通过SSL协议的https服务器来传递。</span><br><span class="line">cookie的接收是通过设置环境变量HTTP_COOKIE来实现的，CGI程序可以通过检索该变量获取cookie信息。</span><br><span class="line">Cookie设置</span><br><span class="line">Cookie的设置非常简单，cookie会在http头部单独发送。以下实例在cookie中设置了name 和 expires：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Content-Type: text/html'</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Set-Cookie: name="菜鸟教程";expires=Wed, 28 Aug 2016 18:30:00 GMT'</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset="utf-8"&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;Cookie set OK!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">将以上代码保存到 cookie_set.py，并修改 cookie_set.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> cookie_set.py</span><br><span class="line">以上实例使用了 Set-Cookie 头信息来设置Cookie信息，可选项中设置了Cookie的其他属性，如过期时间Expires，域名Domain，路径Path。这些信息设置在 <span class="string">"Content-type:text/html"</span>之前。</span><br><span class="line"></span><br><span class="line">检索Cookie信息</span><br><span class="line">Cookie信息检索页非常简单，Cookie信息存储在CGI的环境变量HTTP_COOKIE中，存储格式如下：</span><br><span class="line"></span><br><span class="line">key1=value1;key2=value2;key3=value3....</span><br><span class="line">以下是一个简单的CGI检索cookie信息的程序：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入模块</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> Cookie</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-type: text/html"</span></span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">&lt;meta charset="utf-8"&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;h1&gt;读取cookie信息&lt;/h1&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">'HTTP_COOKIE'</span> <span class="keyword">in</span> os.environ:</span><br><span class="line">    cookie_string=os.environ.get(<span class="string">'HTTP_COOKIE'</span>)</span><br><span class="line">    c=Cookie.SimpleCookie()</span><br><span class="line">    c.load(cookie_string)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data=c[<span class="string">'name'</span>].value</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"cookie data: "</span>+data+<span class="string">"&lt;br&gt;"</span></span><br><span class="line">    <span class="keyword">except</span> KeyError:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"cookie 没有设置或者已过期&lt;br&gt;"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">将以上代码保存到 cookie_get.py，并修改 cookie_get.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> cookie_get.py</span><br><span class="line">以上 cookie 设置颜色 Gif 如下所示：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">文件上传实例</span><br><span class="line">HTML设置上传文件的表单需要设置 enctype 属性为 multipart/form-data，代码如下所示：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;form enctype=<span class="string">"multipart/form-data"</span> </span><br><span class="line">                     action=<span class="string">"/cgi-bin/save_file.py"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">   &lt;p&gt;选中文件: &lt;input type="file" name="filename" /&gt;&lt;/p&gt;</span><br><span class="line">   &lt;p&gt;&lt;input type="submit" value="上传" /&gt;&lt;/p&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">save_file.py脚本文件代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cgi, os</span><br><span class="line"><span class="keyword">import</span> cgitb; cgitb.enable()</span><br><span class="line"></span><br><span class="line">form = cgi.FieldStorage()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取文件名</span></span><br><span class="line">fileitem = form[<span class="string">'filename'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检测文件是否上传</span></span><br><span class="line"><span class="keyword">if</span> fileitem.filename:</span><br><span class="line">   <span class="comment"># 设置文件路径 </span></span><br><span class="line">   fn = os.path.basename(fileitem.filename)</span><br><span class="line">   open(<span class="string">'/tmp/'</span> + fn, <span class="string">'wb'</span>).write(fileitem.file.read())</span><br><span class="line"></span><br><span class="line">   message = <span class="string">'文件 "'</span> + fn + <span class="string">'" 上传成功'</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   message = <span class="string">'文件没有上传'</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">print</span> <span class="string">"""\</span></span><br><span class="line"><span class="string">Content-Type: text/html\n</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">&lt;meta charset="utf-8"&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">   &lt;p&gt;%s&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">"""</span> % (message,)</span><br><span class="line">将以上代码保存到 save_file.py，并修改 save_file.py 权限：</span><br><span class="line"></span><br><span class="line">chmod <span class="number">755</span> save_file.py</span><br><span class="line">以上 cookie 设置颜色 Gif 如下所示：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果你使用的系统是Unix/Linux，你必须替换文件分隔符，在window下只需要使用open()语句即可：</span><br><span class="line"></span><br><span class="line">fn = os.path.basename(fileitem.filename.replace(<span class="string">"\\"</span>, <span class="string">"/"</span> ))</span><br><span class="line">文件下载对话框</span><br><span class="line">我们先在当前目录下创建 foo.txt 文件，用于程序的下载。</span><br><span class="line"></span><br><span class="line">文件下载通过设置HTTP头信息来实现，功能代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTP 头部</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Content-Disposition: attachment; filename=\"foo.txt\""</span>;</span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="comment"># 打开文件</span></span><br><span class="line">fo = open(<span class="string">"foo.txt"</span>, <span class="string">"rb"</span>)</span><br><span class="line"></span><br><span class="line">str = fo.read();</span><br><span class="line"><span class="keyword">print</span> str</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭文件</span></span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-3/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-4"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-4/">python Myspl day 09-4</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line">Python 操作 MySQL 数据库</span><br><span class="line">Python 标准数据库接口为 Python DB-API，Python DB-API为开发人员提供了数据库应用编程接口。</span><br><span class="line"></span><br><span class="line">Python 数据库接口支持非常多的数据库，你可以选择适合你项目的数据库：</span><br><span class="line"></span><br><span class="line">GadFly</span><br><span class="line">mSQL</span><br><span class="line">MySQL</span><br><span class="line">PostgreSQL</span><br><span class="line">Microsoft SQL Server <span class="number">2000</span></span><br><span class="line">Informix</span><br><span class="line">Interbase</span><br><span class="line">Oracle</span><br><span class="line">Sybase</span><br><span class="line">你可以访问Python数据库接口及API查看详细的支持数据库列表。</span><br><span class="line"></span><br><span class="line">不同的数据库你需要下载不同的DB API模块，例如你需要访问Oracle数据库和Mysql数据，你需要下载Oracle和MySQL数据库模块。</span><br><span class="line"></span><br><span class="line">DB-API 是一个规范. 它定义了一系列必须的对象和数据库存取方式, 以便为各种各样的底层数据库系统和多种多样的数据库接口程序提供一致的访问接口 。</span><br><span class="line"></span><br><span class="line">Python的DB-API，为大多数的数据库实现了接口，使用它连接各数据库后，就可以用相同的方式操作各数据库。</span><br><span class="line"></span><br><span class="line">Python DB-API使用流程：</span><br><span class="line"></span><br><span class="line">引入 API 模块。</span><br><span class="line">获取与数据库的连接。</span><br><span class="line">执行SQL语句和存储过程。</span><br><span class="line">关闭数据库连接。</span><br><span class="line">什么是MySQLdb?</span><br><span class="line">MySQLdb 是用于Python链接Mysql数据库的接口，它实现了 Python 数据库 API 规范 V2<span class="number">.0</span>，基于 MySQL C API 上建立的。</span><br><span class="line"></span><br><span class="line">如何安装MySQLdb?</span><br><span class="line">为了用DB-API编写MySQL脚本，必须确保已经安装了MySQL。复制以下代码，并执行：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line">如果执行后的输出结果如下所示，意味着你没有安装 MySQLdb 模块：</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"test.py"</span>, line <span class="number">3</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">import</span> MySQLdb</span><br><span class="line">ImportError: No module named MySQLdb</span><br><span class="line">安装MySQLdb，请访问 http://sourceforge.net/projects/mysql-python ，(Linux平台可以访问：https://pypi.python.org/pypi/MySQL-python)从这里可选择适合您的平台的安装包，分为预编译的二进制文件和源代码安装包。</span><br><span class="line"></span><br><span class="line">如果您选择二进制文件发行版本的话，安装过程基本安装提示即可完成。如果从源代码进行安装的话，则需要切换到MySQLdb发行版本的顶级目录，并键入下列命令:</span><br><span class="line"></span><br><span class="line">$ gunzip MySQL-python<span class="number">-1.2</span><span class="number">.2</span>.tar.gz</span><br><span class="line">$ tar -xvf MySQL-python<span class="number">-1.2</span><span class="number">.2</span>.tar</span><br><span class="line">$ cd MySQL-python<span class="number">-1.2</span><span class="number">.2</span></span><br><span class="line">$ python setup.py build</span><br><span class="line">$ python setup.py install</span><br><span class="line">注意：请确保您有root权限来安装上述模块。</span><br><span class="line"></span><br><span class="line">数据库连接</span><br><span class="line">连接数据库前，请先确认以下事项：</span><br><span class="line"></span><br><span class="line">您已经创建了数据库 TESTDB.</span><br><span class="line">在TESTDB数据库中您已经创建了表 EMPLOYEE</span><br><span class="line">EMPLOYEE表字段为 FIRST_NAME, LAST_NAME, AGE, SEX 和 INCOME。</span><br><span class="line">连接数据库TESTDB使用的用户名为 <span class="string">"testuser"</span> ，密码为 <span class="string">"test123"</span>,你可以可以自己设定或者直接使用root用户名及其密码，Mysql数据库用户授权请使用Grant命令。</span><br><span class="line">在你的机子上已经安装了 Python MySQLdb 模块。</span><br><span class="line">如果您对sql语句不熟悉，可以访问我们的 SQL基础教程</span><br><span class="line">实例：</span><br><span class="line">以下实例链接Mysql的TESTDB数据库：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用execute方法执行SQL语句</span></span><br><span class="line">cursor.execute(<span class="string">"SELECT VERSION()"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 fetchone() 方法获取一条数据</span></span><br><span class="line">data = cursor.fetchone()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Database version : %s "</span> % data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">执行以上脚本输出结果如下：</span><br><span class="line"></span><br><span class="line">Database version : <span class="number">5.0</span><span class="number">.45</span></span><br><span class="line">创建数据库表</span><br><span class="line">如果数据库连接存在我们可以使用execute()方法来为数据库创建表，如下所示创建表EMPLOYEE：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果数据表已经存在使用 execute() 方法删除表。</span></span><br><span class="line">cursor.execute(<span class="string">"DROP TABLE IF EXISTS EMPLOYEE"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据表SQL语句</span></span><br><span class="line">sql = <span class="string">"""CREATE TABLE EMPLOYEE (</span></span><br><span class="line"><span class="string">         FIRST_NAME  CHAR(20) NOT NULL,</span></span><br><span class="line"><span class="string">         LAST_NAME  CHAR(20),</span></span><br><span class="line"><span class="string">         AGE INT,  </span></span><br><span class="line"><span class="string">         SEX CHAR(1),</span></span><br><span class="line"><span class="string">         INCOME FLOAT )"""</span></span><br><span class="line"></span><br><span class="line">cursor.execute(sql)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">数据库插入操作</span><br><span class="line">以下实例使用执行 SQL INSERT 语句向表 EMPLOYEE 插入记录：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL 插入语句</span></span><br><span class="line">sql = <span class="string">"""INSERT INTO EMPLOYEE(FIRST_NAME,</span></span><br><span class="line"><span class="string">         LAST_NAME, AGE, SEX, INCOME)</span></span><br><span class="line"><span class="string">         VALUES ('Mac', 'Mohan', 20, 'M', 2000)"""</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行sql语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 提交到数据库执行</span></span><br><span class="line">   db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="comment"># Rollback in case there is any error</span></span><br><span class="line">   db.rollback()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">以上例子也可以写成如下形式：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL 插入语句</span></span><br><span class="line">sql = <span class="string">"INSERT INTO EMPLOYEE(FIRST_NAME, \</span></span><br><span class="line"><span class="string">       LAST_NAME, AGE, SEX, INCOME) \</span></span><br><span class="line"><span class="string">       VALUES (%s, %s, %s, %s, %s )"</span> % \</span><br><span class="line">       (<span class="string">'Mac'</span>, <span class="string">'Mohan'</span>, <span class="number">20</span>, <span class="string">'M'</span>, <span class="number">2000</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行sql语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 提交到数据库执行</span></span><br><span class="line">   db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="comment"># 发生错误时回滚</span></span><br><span class="line">   db.rollback()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">实例：</span><br><span class="line">以下代码使用变量向SQL语句中传递参数:</span><br><span class="line"></span><br><span class="line">..................................</span><br><span class="line">user_id = <span class="string">"test123"</span></span><br><span class="line">password = <span class="string">"password"</span></span><br><span class="line"></span><br><span class="line">con.execute(<span class="string">'insert into Login values(%s, %s)'</span> % \</span><br><span class="line">             (user_id, password))</span><br><span class="line">..................................</span><br><span class="line">数据库查询操作</span><br><span class="line">Python查询Mysql使用 fetchone() 方法获取单条数据, 使用fetchall() 方法获取多条数据。</span><br><span class="line"></span><br><span class="line">fetchone(): 该方法获取下一个查询结果集。结果集是一个对象</span><br><span class="line">fetchall():接收全部的返回结果行.</span><br><span class="line">rowcount: 这是一个只读属性，并返回执行execute()方法后影响的行数。</span><br><span class="line">实例：</span><br><span class="line">查询EMPLOYEE表中salary（工资）字段大于<span class="number">1000</span>的所有数据：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL 查询语句</span></span><br><span class="line">sql = <span class="string">"SELECT * FROM EMPLOYEE \</span></span><br><span class="line"><span class="string">       WHERE INCOME &gt; %s"</span> % (<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行SQL语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 获取所有记录列表</span></span><br><span class="line">   results = cursor.fetchall()</span><br><span class="line">   <span class="keyword">for</span> row <span class="keyword">in</span> results:</span><br><span class="line">      fname = row[<span class="number">0</span>]</span><br><span class="line">      lname = row[<span class="number">1</span>]</span><br><span class="line">      age = row[<span class="number">2</span>]</span><br><span class="line">      sex = row[<span class="number">3</span>]</span><br><span class="line">      income = row[<span class="number">4</span>]</span><br><span class="line">      <span class="comment"># 打印结果</span></span><br><span class="line">      <span class="keyword">print</span> <span class="string">"fname=%s,lname=%s,age=%s,sex=%s,income=%s"</span> % \</span><br><span class="line">             (fname, lname, age, sex, income )</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="keyword">print</span> <span class="string">"Error: unable to fecth data"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">以上脚本执行结果如下：</span><br><span class="line"></span><br><span class="line">fname=Mac, lname=Mohan, age=<span class="number">20</span>, sex=M, income=<span class="number">2000</span></span><br><span class="line">数据库更新操作</span><br><span class="line">更新操作用于更新数据表的的数据，以下实例将 EMPLOYEE 表中的 SEX 字段为 <span class="string">'M'</span> 的 AGE 字段递增 <span class="number">1</span>：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL 更新语句</span></span><br><span class="line">sql = <span class="string">"UPDATE EMPLOYEE SET AGE = AGE + 1 WHERE SEX = '%c'"</span> % (<span class="string">'M'</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行SQL语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 提交到数据库执行</span></span><br><span class="line">   db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="comment"># 发生错误时回滚</span></span><br><span class="line">   db.rollback()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">db.close()</span><br><span class="line">删除操作</span><br><span class="line"></span><br><span class="line">删除操作用于删除数据表中的数据，以下实例演示了删除数据表 EMPLOYEE 中 AGE 大于 <span class="number">20</span> 的所有数据：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开数据库连接</span></span><br><span class="line">db = MySQLdb.connect(<span class="string">"localhost"</span>, <span class="string">"testuser"</span>, <span class="string">"test123"</span>, <span class="string">"TESTDB"</span>, charset=<span class="string">'utf8'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用cursor()方法获取操作游标 </span></span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL 删除语句</span></span><br><span class="line">sql = <span class="string">"DELETE FROM EMPLOYEE WHERE AGE &gt; %s"</span> % (<span class="number">20</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行SQL语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 提交修改</span></span><br><span class="line">   db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="comment"># 发生错误时回滚</span></span><br><span class="line">   db.rollback()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">db.close()</span><br><span class="line">执行事务</span><br><span class="line">事务机制可以确保数据一致性。</span><br><span class="line"></span><br><span class="line">事务应该具有<span class="number">4</span>个属性：原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性。</span><br><span class="line"></span><br><span class="line">原子性（atomicity）。一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。</span><br><span class="line">一致性（consistency）。事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。</span><br><span class="line">隔离性（isolation）。一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</span><br><span class="line">持久性（durability）。持续性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。</span><br><span class="line">Python DB API <span class="number">2.0</span> 的事务提供了两个方法 commit 或 rollback。</span><br><span class="line"></span><br><span class="line">实例：</span><br><span class="line"><span class="comment"># SQL删除记录语句</span></span><br><span class="line">sql = <span class="string">"DELETE FROM EMPLOYEE WHERE AGE &gt; %s"</span> % (<span class="number">20</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   <span class="comment"># 执行SQL语句</span></span><br><span class="line">   cursor.execute(sql)</span><br><span class="line">   <span class="comment"># 向数据库提交</span></span><br><span class="line">   db.commit()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">   <span class="comment"># 发生错误时回滚</span></span><br><span class="line">   db.rollback()</span><br><span class="line">对于支持事务的数据库， 在Python数据库编程中，当游标建立之时，就自动开始了一个隐形的数据库事务。</span><br><span class="line"></span><br><span class="line">commit()方法游标的所有更新操作，rollback（）方法回滚当前游标的所有操作。每一个方法都开始了一个新的事务。</span><br><span class="line"></span><br><span class="line">错误处理</span><br><span class="line">DB API中定义了一些数据库操作的错误及异常，下表列出了这些错误和异常:</span><br><span class="line"></span><br><span class="line">异常	描述</span><br><span class="line">Warning	当有严重警告时触发，例如插入数据是被截断等等。必须是 StandardError 的子类。</span><br><span class="line">Error	警告以外所有其他错误类。必须是 StandardError 的子类。</span><br><span class="line">InterfaceError	当有数据库接口模块本身的错误（而不是数据库的错误）发生时触发。 必须是Error的子类。</span><br><span class="line">DatabaseError	和数据库有关的错误发生时触发。 必须是Error的子类。</span><br><span class="line">DataError	当有数据处理时的错误发生时触发，例如：除零错误，数据超范围等等。 必须是DatabaseError的子类。</span><br><span class="line">OperationalError	指非用户控制的，而是操作数据库时发生的错误。例如：连接意外断开、 数据库名未找到、事务处理失败、内存分配错误等等操作数据库是发生的错误。 必须是DatabaseError的子类。</span><br><span class="line">IntegrityError	完整性相关的错误，例如外键检查失败等。必须是DatabaseError子类。</span><br><span class="line">InternalError	数据库的内部错误，例如游标（cursor）失效了、事务同步失败等等。 必须是DatabaseError子类。</span><br><span class="line">ProgrammingError	程序错误，例如数据表（table）没找到或已存在、SQL语句语法错误、 参数数量错误等等。必须是DatabaseError的子类。</span><br><span class="line">NotSupportedError	不支持错误，指使用了数据库不支持的函数或API等。例如在连接对象上 使用.rollback()函数，然而数据库并不支持事务或者事务已关闭。 必须是DatabaseError的子类。</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-4/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-5"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-5/">python 网络编程 day 09-5</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">Python 网络编程</span><br><span class="line">Python 提供了两个级别访问的网络服务。：</span><br><span class="line"></span><br><span class="line">低级别的网络服务支持基本的 Socket，它提供了标准的 BSD Sockets API，可以访问底层操作系统Socket接口的全部方法。</span><br><span class="line">高级别的网络服务模块 SocketServer， 它提供了服务器中心类，可以简化网络服务器的开发。</span><br><span class="line">什么是 Socket?</span><br><span class="line">Socket又称<span class="string">"套接字"</span>，应用程序通常通过<span class="string">"套接字"</span>向网络发出请求或者应答网络请求，使主机间或者一台计算机上的进程间可以通讯。</span><br><span class="line"></span><br><span class="line">socket()函数</span><br><span class="line">Python 中，我们用 socket（）函数来创建套接字，语法格式如下：</span><br><span class="line"></span><br><span class="line">socket.socket([family[, type[, proto]]])</span><br><span class="line">参数</span><br><span class="line">family: 套接字家族可以使AF_UNIX或者AF_INET</span><br><span class="line">type: 套接字类型可以根据是面向连接的还是非连接分为SOCK_STREAM或SOCK_DGRAM</span><br><span class="line">protocol: 一般不填默认为<span class="number">0.</span></span><br><span class="line">Socket 对象(内建)方法</span><br><span class="line">函数	描述</span><br><span class="line">服务器端套接字</span><br><span class="line">s.bind()	绑定地址（host,port）到套接字， 在AF_INET下,以元组（host,port）的形式表示地址。</span><br><span class="line">s.listen()	开始TCP监听。backlog指定在拒绝连接之前，操作系统可以挂起的最大连接数量。该值至少为<span class="number">1</span>，大部分应用程序设为<span class="number">5</span>就可以了。</span><br><span class="line">s.accept()	被动接受TCP客户端连接,(阻塞式)等待连接的到来</span><br><span class="line">客户端套接字</span><br><span class="line">s.connect()	主动初始化TCP服务器连接，。一般address的格式为元组（hostname,port），如果连接出错，返回socket.error错误。</span><br><span class="line">s.connect_ex()	connect()函数的扩展版本,出错时返回出错码,而不是抛出异常</span><br><span class="line">公共用途的套接字函数</span><br><span class="line">s.recv()	接收TCP数据，数据以字符串形式返回，bufsize指定要接收的最大数据量。flag提供有关消息的其他信息，通常可以忽略。</span><br><span class="line">s.send()	发送TCP数据，将string中的数据发送到连接的套接字。返回值是要发送的字节数量，该数量可能小于string的字节大小。</span><br><span class="line">s.sendall()	完整发送TCP数据，完整发送TCP数据。将string中的数据发送到连接的套接字，但在返回之前会尝试发送所有数据。成功返回<span class="literal">None</span>，失败则抛出异常。</span><br><span class="line">s.recvfrom()	接收UDP数据，与recv()类似，但返回值是（data,address）。其中data是包含接收数据的字符串，address是发送数据的套接字地址。</span><br><span class="line">s.sendto()	发送UDP数据，将数据发送到套接字，address是形式为（ipaddr，port）的元组，指定远程地址。返回值是发送的字节数。</span><br><span class="line">s.close()	关闭套接字</span><br><span class="line">s.getpeername()	返回连接套接字的远程地址。返回值通常是元组（ipaddr,port）。</span><br><span class="line">s.getsockname()	返回套接字自己的地址。通常是一个元组(ipaddr,port)</span><br><span class="line">s.setsockopt(level,optname,value)	设置给定套接字选项的值。</span><br><span class="line">s.getsockopt(level,optname[.buflen])	返回套接字选项的值。</span><br><span class="line">s.settimeout(timeout)	设置套接字操作的超时期，timeout是一个浮点数，单位是秒。值为<span class="literal">None</span>表示没有超时期。一般，超时期应该在刚创建套接字时设置，因为它们可能用于连接的操作（如connect()）</span><br><span class="line">s.gettimeout()	返回当前超时期的值，单位是秒，如果没有设置超时期，则返回<span class="literal">None</span>。</span><br><span class="line">s.fileno()	返回套接字的文件描述符。</span><br><span class="line">s.setblocking(flag)	如果flag为<span class="number">0</span>，则将套接字设为非阻塞模式，否则将套接字设为阻塞模式（默认值）。非阻塞模式下，如果调用recv()没有发现任何数据，或send()调用无法立即发送数据，那么将引起socket.error异常。</span><br><span class="line">s.makefile()	创建一个与该套接字相关连的文件</span><br><span class="line">简单实例</span><br><span class="line">服务端</span><br><span class="line">我们使用 socket 模块的 socket 函数来创建一个 socket 对象。socket 对象可以通过调用其他函数来设置一个 socket 服务。</span><br><span class="line"></span><br><span class="line">现在我们可以通过调用 bind(hostname, port) 函数来指定服务的 port(端口)。</span><br><span class="line"></span><br><span class="line">接着，我们调用 socket 对象的 accept 方法。该方法等待客户端的连接，并返回 connection 对象，表示已连接到客户端。</span><br><span class="line"></span><br><span class="line">完整代码如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- # 文件名：server.py import socket # 导入 socket 模块 s = socket.socket() # 创建 socket 对象 host = socket.gethostname() # 获取本地主机名 port = 12345 # 设置端口 s.bind((host, port)) # 绑定端口 s.listen(5) # 等待客户端连接 while True: c,addr = s.accept() # 建立客户端连接 print '连接地址：', addr c.send('欢迎访问菜鸟教程！') c.close() # 关闭连接</span></span><br><span class="line"></span><br><span class="line">客户端</span><br><span class="line">接下来我们写一个简单的客户端实例连接到以上创建的服务。端口号为 <span class="number">12345</span>。</span><br><span class="line"></span><br><span class="line">socket.connect(hosname, port ) 方法打开一个 TCP 连接到主机为 hostname 端口为 port 的服务商。连接后我们就可以从服务端获取数据，记住，操作完成后需要关闭连接。</span><br><span class="line"></span><br><span class="line">完整代码如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- # 文件名：client.py import socket # 导入 socket 模块 s = socket.socket() # 创建 socket 对象 host = socket.gethostname() # 获取本地主机名 port = 12345 # 设置端口号 s.connect((host, port)) print s.recv(1024) s.close()</span></span><br><span class="line"></span><br><span class="line">现在我们打开两个终端，第一个终端执行 server.py 文件：</span><br><span class="line"></span><br><span class="line">$ python server.py</span><br><span class="line">第二个终端执行 client.py 文件：</span><br><span class="line"></span><br><span class="line">$ python client.py </span><br><span class="line">欢迎访问菜鸟教程！</span><br><span class="line">这时我们再打开第一个终端，就会看到有以下信息输出：</span><br><span class="line"></span><br><span class="line">连接地址： (<span class="string">'192.168.0.118'</span>, <span class="number">62461</span>)</span><br><span class="line">Python Internet 模块</span><br><span class="line">以下列出了 Python 网络编程的一些重要模块：</span><br><span class="line"></span><br><span class="line">协议	功能用处	端口号	Python 模块</span><br><span class="line">HTTP	网页访问	<span class="number">80</span>	httplib, urllib, xmlrpclib</span><br><span class="line">NNTP	阅读和张贴新闻文章，俗称为<span class="string">"帖子"</span>	<span class="number">119</span>	nntplib</span><br><span class="line">FTP	文件传输	<span class="number">20</span>	ftplib, urllib</span><br><span class="line">SMTP	发送邮件	<span class="number">25</span>	smtplib</span><br><span class="line">POP3	接收邮件	<span class="number">110</span>	poplib</span><br><span class="line">IMAP4	获取邮件	<span class="number">143</span>	imaplib</span><br><span class="line">Telnet	命令行	<span class="number">23</span>	telnetlib</span><br><span class="line">Gopher	信息查找	<span class="number">70</span>	gopherlib, urllib</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-5/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-6"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-6/">python SMTP发送邮件 day 09-6</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">Python SMTP发送邮件</span><br><span class="line">SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。</span><br><span class="line"></span><br><span class="line">python的smtplib提供了一种很方便的途径发送电子邮件。它对smtp协议进行了简单的封装。</span><br><span class="line"></span><br><span class="line">Python创建 SMTP 对象语法如下：</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"></span><br><span class="line">smtpObj = smtplib.SMTP( [host [, port [, local_hostname]]] )</span><br><span class="line">参数说明：</span><br><span class="line"></span><br><span class="line">host: SMTP 服务器主机。 你可以指定主机的ip地址或者域名如: runoob.com，这个是可选参数。</span><br><span class="line">port: 如果你提供了 host 参数, 你需要指定 SMTP 服务使用的端口号，一般情况下 SMTP 端口号为<span class="number">25</span>。</span><br><span class="line">local_hostname: 如果 SMTP 在你的本机上，你只需要指定服务器地址为 localhost 即可。</span><br><span class="line">Python SMTP 对象使用 sendmail 方法发送邮件，语法如下：</span><br><span class="line"></span><br><span class="line">SMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options])</span><br><span class="line">参数说明：</span><br><span class="line"></span><br><span class="line">from_addr: 邮件发送者地址。</span><br><span class="line">to_addrs: 字符串列表，邮件发送地址。</span><br><span class="line">msg: 发送消息</span><br><span class="line">这里要注意一下第三个参数，msg 是字符串，表示邮件。我们知道邮件一般由标题，发信人，收件人，邮件内容，附件等构成，发送邮件的时候，要注意 msg 的格式。这个格式就是 smtp 协议中定义的格式。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line">以下执行实例需要你本机已安装了支持 SMTP 的服务，如：sendmail。</span><br><span class="line"></span><br><span class="line">以下是一个使用 Python 发送邮件简单的实例：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.text import MIMEText from email.header import Header sender = 'from@runoob.com' receivers = ['429240967@qq.com'] # 接收邮件，可设置为你的QQ邮箱或者其他邮箱 # 三个参数：第一个为文本内容，第二个 plain 设置文本格式，第三个 utf-8 设置编码 message = MIMEText('Python 邮件发送测试...', 'plain', 'utf-8') message['From'] = Header("菜鸟教程", 'utf-8') # 发送者 message['To'] = Header("测试", 'utf-8') # 接收者 subject = 'Python SMTP 邮件测试' message['Subject'] = Header(subject, 'utf-8') try: smtpObj = smtplib.SMTP('localhost') smtpObj.sendmail(sender, receivers, message.as_string()) print "邮件发送成功" except smtplib.SMTPException: print "Error: 无法发送邮件"</span></span><br><span class="line"></span><br><span class="line">我们使用三个引号来设置邮件信息，标准邮件需要三个头部信息： From, To, 和 Subject ，每个信息直接使用空行分割。</span><br><span class="line"></span><br><span class="line">我们通过实例化 smtplib 模块的 SMTP 对象 smtpObj 来连接到 SMTP 访问，并使用 sendmail 方法来发送信息。</span><br><span class="line"></span><br><span class="line">执行以上程序，如果你本机安装 sendmail（邮件传输代理程序），就会输出：</span><br><span class="line"></span><br><span class="line">$ python test.py </span><br><span class="line">邮件发送成功</span><br><span class="line">查看我们的收件箱(一般在垃圾箱)，就可以查看到邮件信息：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">如果我们本机没有 sendmail 访问，也可以使用其他邮件服务商的 SMTP 访问（QQ、网易、Google等）。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.text import MIMEText from email.header import Header # 第三方 SMTP 服务 mail_host="smtp.XXX.com" #设置服务器 mail_user="XXXX" #用户名 mail_pass="XXXXXX" #口令 sender = 'from@runoob.com' receivers = ['429240967@qq.com'] # 接收邮件，可设置为你的QQ邮箱或者其他邮箱 message = MIMEText('Python 邮件发送测试...', 'plain', 'utf-8') message['From'] = Header("菜鸟教程", 'utf-8') message['To'] = Header("测试", 'utf-8') subject = 'Python SMTP 邮件测试' message['Subject'] = Header(subject, 'utf-8') try: smtpObj = smtplib.SMTP() smtpObj.connect(mail_host, 25) # 25 为 SMTP 端口号 smtpObj.login(mail_user,mail_pass) smtpObj.sendmail(sender, receivers, message.as_string()) print "邮件发送成功" except smtplib.SMTPException: print "Error: 无法发送邮件"</span></span><br><span class="line"></span><br><span class="line">使用Python发送HTML格式的邮件</span><br><span class="line">Python发送HTML格式的邮件与发送纯文本消息的邮件不同之处就是将MIMEText中_subtype设置为html。具体代码如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.text import MIMEText from email.header import Header sender = 'from@runoob.com' receivers = ['429240967@qq.com'] # 接收邮件，可设置为你的QQ邮箱或者其他邮箱 mail_msg = """ &lt;p&gt;Python 邮件发送测试...&lt;/p&gt; &lt;p&gt;&lt;a href="http://www.runoob.com"&gt;这是一个链接&lt;/a&gt;&lt;/p&gt; """ message = MIMEText(mail_msg, 'html', 'utf-8') message['From'] = Header("菜鸟教程", 'utf-8') message['To'] = Header("测试", 'utf-8') subject = 'Python SMTP 邮件测试' message['Subject'] = Header(subject, 'utf-8') try: smtpObj = smtplib.SMTP('localhost') smtpObj.sendmail(sender, receivers, message.as_string()) print "邮件发送成功" except smtplib.SMTPException: print "Error: 无法发送邮件"</span></span><br><span class="line"></span><br><span class="line">执行以上程序，如果你本机安装sendmail，就会输出：</span><br><span class="line"></span><br><span class="line">$ python test.py </span><br><span class="line">邮件发送成功</span><br><span class="line">查看我们的收件箱(一般在垃圾箱)，就可以查看到邮件信息：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Python 发送带附件的邮件</span><br><span class="line">发送带附件的邮件，首先要创建MIMEMultipart()实例，然后构造附件，如果有多个附件，可依次构造，最后利用smtplib.smtp发送。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.text import MIMEText from email.mime.multipart import MIMEMultipart from email.header import Header sender = 'from@runoob.com' receivers = ['429240967@qq.com'] # 接收邮件，可设置为你的QQ邮箱或者其他邮箱 #创建一个带附件的实例 message = MIMEMultipart() message['From'] = Header("菜鸟教程", 'utf-8') message['To'] = Header("测试", 'utf-8') subject = 'Python SMTP 邮件测试' message['Subject'] = Header(subject, 'utf-8') #邮件正文内容 message.attach(MIMEText('这是菜鸟教程Python 邮件发送测试……', 'plain', 'utf-8')) # 构造附件1，传送当前目录下的 test.txt 文件 att1 = MIMEText(open('test.txt', 'rb').read(), 'base64', 'utf-8') att1["Content-Type"] = 'application/octet-stream' # 这里的filename可以任意写，写什么名字，邮件中显示什么名字 att1["Content-Disposition"] = 'attachment; filename="test.txt"' message.attach(att1) # 构造附件2，传送当前目录下的 runoob.txt 文件 att2 = MIMEText(open('runoob.txt', 'rb').read(), 'base64', 'utf-8') att2["Content-Type"] = 'application/octet-stream' att2["Content-Disposition"] = 'attachment; filename="runoob.txt"' message.attach(att2) try: smtpObj = smtplib.SMTP('localhost') smtpObj.sendmail(sender, receivers, message.as_string()) print "邮件发送成功" except smtplib.SMTPException: print "Error: 无法发送邮件"</span></span><br><span class="line"></span><br><span class="line">$ python test.py </span><br><span class="line">邮件发送成功</span><br><span class="line">查看我们的收件箱(一般在垃圾箱)，就可以查看到邮件信息：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在 HTML 文本中添加图片</span><br><span class="line">邮件的 HTML 文本中一般邮件服务商添加外链是无效的，正确添加图片的实例如下所示：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.image import MIMEImage from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.header import Header sender = 'from@runoob.com' receivers = ['429240967@qq.com'] # 接收邮件，可设置为你的QQ邮箱或者其他邮箱 msgRoot = MIMEMultipart('related') msgRoot['From'] = Header("菜鸟教程", 'utf-8') msgRoot['To'] = Header("测试", 'utf-8') subject = 'Python SMTP 邮件测试' msgRoot['Subject'] = Header(subject, 'utf-8') msgAlternative = MIMEMultipart('alternative') msgRoot.attach(msgAlternative) mail_msg = """ &lt;p&gt;Python 邮件发送测试...&lt;/p&gt; &lt;p&gt;&lt;a href="http://www.runoob.com"&gt;菜鸟教程链接&lt;/a&gt;&lt;/p&gt; &lt;p&gt;图片演示：&lt;/p&gt; &lt;p&gt;&lt;img src="cid:image1"&gt;&lt;/p&gt; """ msgAlternative.attach(MIMEText(mail_msg, 'html', 'utf-8')) # 指定图片为当前目录 fp = open('test.png', 'rb') msgImage = MIMEImage(fp.read()) fp.close() # 定义图片 ID，在 HTML 文本中引用 msgImage.add_header('Content-ID', '&lt;image1&gt;') msgRoot.attach(msgImage) try: smtpObj = smtplib.SMTP('localhost') smtpObj.sendmail(sender, receivers, msgRoot.as_string()) print "邮件发送成功" except smtplib.SMTPException: print "Error: 无法发送邮件"</span></span><br><span class="line"></span><br><span class="line">$ python test.py </span><br><span class="line">邮件发送成功</span><br><span class="line">查看我们的收件箱(如果在垃圾箱可能需要移动到收件箱才可正常显示)，就可以查看到邮件信息：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用第三方 SMTP 服务发送</span><br><span class="line">这里使用了 QQ 邮箱(你也可以使用 <span class="number">163</span>，Gmail等)的 SMTP 服务，需要做以下配置：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QQ 邮箱通过生成授权码来设置密码：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QQ 邮箱 SMTP 服务器地址：smtp.qq.com，ssl 端口：<span class="number">465</span>。</span><br><span class="line"></span><br><span class="line">以下实例你需要修改：发件人邮箱（你的QQ邮箱），密码，收件人邮箱（可发给自己）。</span><br><span class="line"></span><br><span class="line">QQ SMTP</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import smtplib from email.mime.text import MIMEText from email.utils import formataddr my_sender='429240967@qq.com' # 发件人邮箱账号 my_pass = 'xxxxxxxxxx' # 发件人邮箱密码 my_user='429240967@qq.com' # 收件人邮箱账号，我这边发送给自己 def mail(): ret=True try: msg=MIMEText('填写邮件内容','plain','utf-8') msg['From']=formataddr(["FromRunoob",my_sender]) # 括号里的对应发件人邮箱昵称、发件人邮箱账号 msg['To']=formataddr(["FK",my_user]) # 括号里的对应收件人邮箱昵称、收件人邮箱账号 msg['Subject']="菜鸟教程发送邮件测试" # 邮件的主题，也可以说是标题 server=smtplib.SMTP_SSL("smtp.qq.com", 465) # 发件人邮箱中的SMTP服务器，端口是25 server.login(my_sender, my_pass) # 括号中对应的是发件人邮箱账号、邮箱密码 server.sendmail(my_sender,[my_user,],msg.as_string()) # 括号中对应的是发件人邮箱账号、收件人邮箱账号、发送邮件 server.quit() # 关闭连接 except Exception: # 如果 try 中的语句没有执行，则会执行下面的 ret=False ret=False return ret ret=mail() if ret: print("邮件发送成功") else: print("邮件发送失败")</span></span><br><span class="line"></span><br><span class="line">$ python test.py </span><br><span class="line">邮件发送成功</span><br><span class="line">发送成功后，登陆收件人邮箱即可查看：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">更多内容请参阅：https://docs.python.org/<span class="number">2</span>/library/email-examples.html。</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-6/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-7"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-7/">python 多线程 day 09-7</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">Python 多线程</span><br><span class="line">多线程类似于同时执行多个不同程序，多线程运行有如下优点：</span><br><span class="line"></span><br><span class="line">使用线程可以把占据长时间的程序中的任务放到后台去处理。</span><br><span class="line">用户界面可以更加吸引人，这样比如用户点击了一个按钮去触发某些事件的处理，可以弹出一个进度条来显示处理的进度</span><br><span class="line">程序的运行速度可能加快</span><br><span class="line">在一些等待的任务实现上如用户输入、文件读写和网络收发数据等，线程就比较有用了。在这种情况下我们可以释放一些珍贵的资源如内存占用等等。</span><br><span class="line">线程在执行过程中与进程还是有区别的。每个独立的进程有一个程序运行的入口、顺序执行序列和程序的出口。但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制。</span><br><span class="line"></span><br><span class="line">每个线程都有他自己的一组CPU寄存器，称为线程的上下文，该上下文反映了线程上次运行该线程的CPU寄存器的状态。</span><br><span class="line"></span><br><span class="line">指令指针和堆栈指针寄存器是线程上下文中两个最重要的寄存器，线程总是在进程得到上下文中运行的，这些地址都用于标志拥有线程的进程地址空间中的内存。</span><br><span class="line"></span><br><span class="line">线程可以被抢占（中断）。</span><br><span class="line">在其他线程正在运行时，线程可以暂时搁置（也称为睡眠） -- 这就是线程的退让。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">开始学习Python线程</span><br><span class="line">Python中使用线程有两种方式：函数或者用类来包装线程对象。</span><br><span class="line"></span><br><span class="line">函数式：调用thread模块中的start_new_thread()函数来产生新线程。语法如下:</span><br><span class="line"></span><br><span class="line">thread.start_new_thread ( function, args[, kwargs] )</span><br><span class="line">参数说明:</span><br><span class="line"></span><br><span class="line">function - 线程函数。</span><br><span class="line">args - 传递给线程函数的参数,他必须是个tuple类型。</span><br><span class="line">kwargs - 可选参数。</span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import thread import time # 为线程定义一个函数 def print_time( threadName, delay): count = 0 while count &lt; 5: time.sleep(delay) count += 1 print "%s: %s" % ( threadName, time.ctime(time.time()) ) # 创建两个线程 try: thread.start_new_thread( print_time, ("Thread-1", 2, ) ) thread.start_new_thread( print_time, ("Thread-2", 4, ) ) except: print "Error: unable to start thread" while 1: pass</span></span><br><span class="line"></span><br><span class="line">执行以上程序输出结果如下：</span><br><span class="line"></span><br><span class="line">Thread<span class="number">-1</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">17</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">19</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">19</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">21</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">23</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">23</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">25</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">27</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">31</span> <span class="number">2009</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Jan <span class="number">22</span> <span class="number">15</span>:<span class="number">42</span>:<span class="number">35</span> <span class="number">2009</span></span><br><span class="line">线程的结束一般依靠线程函数的自然结束；也可以在线程函数中调用thread.exit()，他抛出SystemExit exception，达到退出线程的目的。</span><br><span class="line"></span><br><span class="line">线程模块</span><br><span class="line">Python通过两个标准库thread和threading提供对线程的支持。thread提供了低级别的、原始的线程以及一个简单的锁。</span><br><span class="line"></span><br><span class="line">threading 模块提供的其他方法：</span><br><span class="line"></span><br><span class="line">threading.currentThread(): 返回当前的线程变量。</span><br><span class="line">threading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。</span><br><span class="line">threading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。</span><br><span class="line">除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法:</span><br><span class="line"></span><br><span class="line">run(): 用以表示线程活动的方法。</span><br><span class="line">start():启动线程活动。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">join([time]): 等待至线程中止。这阻塞调用线程直至线程的join() 方法被调用中止-正常退出或者抛出未处理的异常-或者是可选的超时发生。</span><br><span class="line">isAlive(): 返回线程是否活动的。</span><br><span class="line">getName(): 返回线程名。</span><br><span class="line">setName(): 设置线程名。</span><br><span class="line">使用Threading模块创建线程</span><br><span class="line">使用Threading模块创建线程，直接从threading.Thread继承，然后重写__init__方法和run方法：</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import threading import time exitFlag = 0 class myThread (threading.Thread): #继承父类threading.Thread def __init__(self, threadID, name, counter): threading.Thread.__init__(self) self.threadID = threadID self.name = name self.counter = counter def run(self): #把要执行的代码写到run函数里面 线程在创建后会直接运行run函数 print "Starting " + self.name print_time(self.name, self.counter, 5) print "Exiting " + self.name def print_time(threadName, delay, counter): while counter: if exitFlag: (threading.Thread).exit() time.sleep(delay) print "%s: %s" % (threadName, time.ctime(time.time())) counter -= 1 # 创建新线程 thread1 = myThread(1, "Thread-1", 1) thread2 = myThread(2, "Thread-2", 2) # 开启线程 thread1.start() thread2.start() print "Exiting Main Thread"</span></span><br><span class="line"></span><br><span class="line">以上程序执行结果如下；</span><br><span class="line"></span><br><span class="line">Starting Thread<span class="number">-1</span></span><br><span class="line">Starting Thread<span class="number">-2</span></span><br><span class="line">Exiting Main Thread</span><br><span class="line">Thread<span class="number">-1</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">03</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">04</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">04</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">05</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">06</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">06</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-1</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">07</span> <span class="number">2013</span></span><br><span class="line">Exiting Thread<span class="number">-1</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">08</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">10</span> <span class="number">2013</span></span><br><span class="line">Thread<span class="number">-2</span>: Thu Mar <span class="number">21</span> <span class="number">09</span>:<span class="number">10</span>:<span class="number">12</span> <span class="number">2013</span></span><br><span class="line">Exiting Thread<span class="number">-2</span></span><br><span class="line">线程同步</span><br><span class="line">如果多个线程共同对某个数据修改，则可能出现不可预料的结果，为了保证数据的正确性，需要对多个线程进行同步。</span><br><span class="line"></span><br><span class="line">使用Thread对象的Lock和Rlock可以实现简单的线程同步，这两个对象都有acquire方法和release方法，对于那些需要每次只允许一个线程操作的数据，可以将其操作放到acquire和release方法之间。如下：</span><br><span class="line"></span><br><span class="line">多线程的优势在于可以同时运行多个任务（至少感觉起来是这样）。但是当线程需要共享数据时，可能存在数据不同步的问题。</span><br><span class="line"></span><br><span class="line">考虑这样一种情况：一个列表里所有元素都是<span class="number">0</span>，线程<span class="string">"set"</span>从后向前把所有元素改成<span class="number">1</span>，而线程<span class="string">"print"</span>负责从前往后读取列表并打印。</span><br><span class="line"></span><br><span class="line">那么，可能线程<span class="string">"set"</span>开始改的时候，线程<span class="string">"print"</span>便来打印列表了，输出就成了一半<span class="number">0</span>一半<span class="number">1</span>，这就是数据的不同步。为了避免这种情况，引入了锁的概念。</span><br><span class="line"></span><br><span class="line">锁有两种状态——锁定和未锁定。每当一个线程比如<span class="string">"set"</span>要访问共享数据时，必须先获得锁定；如果已经有别的线程比如<span class="string">"print"</span>获得锁定了，那么就让线程<span class="string">"set"</span>暂停，也就是同步阻塞；等到线程<span class="string">"print"</span>访问完毕，释放锁以后，再让线程<span class="string">"set"</span>继续。</span><br><span class="line"></span><br><span class="line">经过这样的处理，打印列表时要么全部输出<span class="number">0</span>，要么全部输出<span class="number">1</span>，不会再出现一半<span class="number">0</span>一半<span class="number">1</span>的尴尬场面。</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import threading import time class myThread (threading.Thread): def __init__(self, threadID, name, counter): threading.Thread.__init__(self) self.threadID = threadID self.name = name self.counter = counter def run(self): print "Starting " + self.name # 获得锁，成功获得锁定后返回True # 可选的timeout参数不填时将一直阻塞直到获得锁定 # 否则超时后将返回False threadLock.acquire() print_time(self.name, self.counter, 3) # 释放锁 threadLock.release() def print_time(threadName, delay, counter): while counter: time.sleep(delay) print "%s: %s" % (threadName, time.ctime(time.time())) counter -= 1 threadLock = threading.Lock() threads = [] # 创建新线程 thread1 = myThread(1, "Thread-1", 1) thread2 = myThread(2, "Thread-2", 2) # 开启新线程 thread1.start() thread2.start() # 添加线程到线程列表 threads.append(thread1) threads.append(thread2) # 等待所有线程完成 for t in threads: t.join() print "Exiting Main Thread"</span></span><br><span class="line"></span><br><span class="line">线程优先级队列（ Queue）</span><br><span class="line">Python的Queue模块中提供了同步的、线程安全的队列类，包括FIFO（先入先出)队列Queue，LIFO（后入先出）队列LifoQueue，和优先级队列PriorityQueue。这些队列都实现了锁原语，能够在多线程中直接使用。可以使用队列来实现线程间的同步。</span><br><span class="line"></span><br><span class="line">Queue模块中的常用方法:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Queue.qsize() 返回队列的大小</span><br><span class="line">Queue.empty() 如果队列为空，返回<span class="literal">True</span>,反之<span class="literal">False</span></span><br><span class="line">Queue.full() 如果队列满了，返回<span class="literal">True</span>,反之<span class="literal">False</span></span><br><span class="line">Queue.full 与 maxsize 大小对应</span><br><span class="line">Queue.get([block[, timeout]])获取队列，timeout等待时间</span><br><span class="line">Queue.get_nowait() 相当Queue.get(<span class="literal">False</span>)</span><br><span class="line">Queue.put(item) 写入队列，timeout等待时间</span><br><span class="line">Queue.put_nowait(item) 相当Queue.put(item, <span class="literal">False</span>)</span><br><span class="line">Queue.task_done() 在完成一项工作之后，Queue.task_done()函数向任务已经完成的队列发送一个信号</span><br><span class="line">Queue.join() 实际上意味着等到队列为空，再执行别的操作</span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import Queue import threading import time exitFlag = 0 class myThread (threading.Thread): def __init__(self, threadID, name, q): threading.Thread.__init__(self) self.threadID = threadID self.name = name self.q = q def run(self): print "Starting " + self.name process_data(self.name, self.q) print "Exiting " + self.name def process_data(threadName, q): while not exitFlag: queueLock.acquire() if not workQueue.empty(): data = q.get() queueLock.release() print "%s processing %s" % (threadName, data) else: queueLock.release() time.sleep(1) threadList = ["Thread-1", "Thread-2", "Thread-3"] nameList = ["One", "Two", "Three", "Four", "Five"] queueLock = threading.Lock() workQueue = Queue.Queue(10) threads = [] threadID = 1 # 创建新线程 for tName in threadList: thread = myThread(threadID, tName, workQueue) thread.start() threads.append(thread) threadID += 1 # 填充队列 queueLock.acquire() for word in nameList: workQueue.put(word) queueLock.release() # 等待队列清空 while not workQueue.empty(): pass # 通知线程是时候退出 exitFlag = 1 # 等待所有线程完成 for t in threads: t.join() print "Exiting Main Thread"</span></span><br><span class="line"></span><br><span class="line">以上程序执行结果：</span><br><span class="line"></span><br><span class="line">Starting Thread<span class="number">-1</span></span><br><span class="line">Starting Thread<span class="number">-2</span></span><br><span class="line">Starting Thread<span class="number">-3</span></span><br><span class="line">Thread<span class="number">-1</span> processing One</span><br><span class="line">Thread<span class="number">-2</span> processing Two</span><br><span class="line">Thread<span class="number">-3</span> processing Three</span><br><span class="line">Thread<span class="number">-1</span> processing Four</span><br><span class="line">Thread<span class="number">-2</span> processing Five</span><br><span class="line">Exiting Thread<span class="number">-3</span></span><br><span class="line">Exiting Thread<span class="number">-1</span></span><br><span class="line">Exiting Thread<span class="number">-2</span></span><br><span class="line">Exiting Main Thread</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-7/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-8"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-8/">python XML day 09-8</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">Python XML 解析</span><br><span class="line">什么是 XML？</span><br><span class="line">XML 指可扩展标记语言（eXtensible Markup Language）。 你可以通过本站学习 XML 教程</span><br><span class="line"></span><br><span class="line">XML 被设计用来传输和存储数据。</span><br><span class="line"></span><br><span class="line">XML 是一套定义语义标记的规则，这些标记将文档分成许多部件并对这些部件加以标识。</span><br><span class="line"></span><br><span class="line">它也是元标记语言，即定义了用于定义其他与特定领域有关的、语义的、结构化的标记语言的句法语言。</span><br><span class="line"></span><br><span class="line">Python 对 XML 的解析</span><br><span class="line">常见的 XML 编程接口有 DOM 和 SAX，这两种接口处理 XML 文件的方式不同，当然使用场合也不同。</span><br><span class="line"></span><br><span class="line">Python 有三种方法解析 XML，SAX，DOM，以及 ElementTree:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>SAX (simple API <span class="keyword">for</span> XML )</span><br><span class="line">Python 标准库包含 SAX 解析器，SAX 用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>DOM(Document Object Model)</span><br><span class="line">将 XML 数据在内存中解析成一个树，通过对树的操作来操作XML。</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>ElementTree(元素树)</span><br><span class="line">ElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。</span><br><span class="line"></span><br><span class="line">注：因DOM需要将XML数据映射到内存中的树，一是比较慢，二是比较耗内存，而SAX流式读取XML文件，比较快，占用内存少，但需要用户实现回调函数（handler）。</span><br><span class="line"></span><br><span class="line">本章节使用到的 XML 实例文件 movies.xml 内容如下：</span><br><span class="line"></span><br><span class="line">movies.xml</span><br><span class="line">&lt;collection shelf="New Arrivals"&gt; &lt;movie title="Enemy Behind"&gt; &lt;type&gt;War, Thriller&lt;/type&gt; &lt;format&gt;DVD&lt;/format&gt; &lt;year&gt;2003&lt;/year&gt; &lt;rating&gt;PG&lt;/rating&gt; &lt;stars&gt;10&lt;/stars&gt; &lt;description&gt;Talk about a US-Japan war&lt;/description&gt; &lt;/movie&gt; &lt;movie title="Transformers"&gt; &lt;type&gt;Anime, Science Fiction&lt;/type&gt; &lt;format&gt;DVD&lt;/format&gt; &lt;year&gt;1989&lt;/year&gt; &lt;rating&gt;R&lt;/rating&gt; &lt;stars&gt;8&lt;/stars&gt; &lt;description&gt;A schientific fiction&lt;/description&gt; &lt;/movie&gt; &lt;movie title="Trigun"&gt; &lt;type&gt;Anime, Action&lt;/type&gt; &lt;format&gt;DVD&lt;/format&gt; &lt;episodes&gt;4&lt;/episodes&gt; &lt;rating&gt;PG&lt;/rating&gt; &lt;stars&gt;10&lt;/stars&gt; &lt;description&gt;Vash the Stampede!&lt;/description&gt; &lt;/movie&gt; &lt;movie title="Ishtar"&gt; &lt;type&gt;Comedy&lt;/type&gt; &lt;format&gt;VHS&lt;/format&gt; &lt;rating&gt;PG&lt;/rating&gt; &lt;stars&gt;2&lt;/stars&gt; &lt;description&gt;Viewable boredom&lt;/description&gt; &lt;/movie&gt; &lt;/collection&gt;</span><br><span class="line"></span><br><span class="line">python使用SAX解析xml</span><br><span class="line">SAX是一种基于事件驱动的 API。</span><br><span class="line"></span><br><span class="line">利用SAX解析XML文档牵涉到两个部分: 解析器和事件处理器。</span><br><span class="line"></span><br><span class="line">解析器负责读取XML文档，并向事件处理器发送事件，如元素开始跟元素结束事件。</span><br><span class="line"></span><br><span class="line">而事件处理器则负责对事件作出响应，对传递的XML数据进行处理。</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、对大型文件进行处理；</span><br><span class="line"><span class="number">2</span>、只需要文件的部分内容，或者只需从文件中得到特定信息。</span><br><span class="line"><span class="number">3</span>、想建立自己的对象模型的时候。</span><br><span class="line">在python中使用sax方式处理xml要先引入xml.sax中的parse函数，还有xml.sax.handler中的ContentHandler。</span><br><span class="line"></span><br><span class="line">ContentHandler类方法介绍</span><br><span class="line">characters(content)方法</span><br><span class="line"></span><br><span class="line">调用时机：</span><br><span class="line"></span><br><span class="line">从行开始，遇到标签之前，存在字符，content 的值为这些字符串。</span><br><span class="line"></span><br><span class="line">从一个标签，遇到下一个标签之前， 存在字符，content 的值为这些字符串。</span><br><span class="line"></span><br><span class="line">从一个标签，遇到行结束符之前，存在字符，content 的值为这些字符串。</span><br><span class="line"></span><br><span class="line">标签可以是开始标签，也可以是结束标签。</span><br><span class="line"></span><br><span class="line">startDocument() 方法</span><br><span class="line"></span><br><span class="line">文档启动的时候调用。</span><br><span class="line"></span><br><span class="line">endDocument() 方法</span><br><span class="line"></span><br><span class="line">解析器到达文档结尾时调用。</span><br><span class="line"></span><br><span class="line">startElement(name, attrs)方法</span><br><span class="line"></span><br><span class="line">遇到XML开始标签时调用，name是标签的名字，attrs是标签的属性值字典。</span><br><span class="line"></span><br><span class="line">endElement(name) 方法</span><br><span class="line"></span><br><span class="line">遇到XML结束标签时调用。</span><br><span class="line"></span><br><span class="line">make_parser方法</span><br><span class="line">以下方法创建一个新的解析器对象并返回。</span><br><span class="line"></span><br><span class="line">xml.sax.make_parser( [parser_list] )</span><br><span class="line">参数说明:</span><br><span class="line"></span><br><span class="line">parser_list - 可选参数，解析器列表</span><br><span class="line">parser方法</span><br><span class="line">以下方法创建一个 SAX 解析器并解析xml文档：</span><br><span class="line"></span><br><span class="line">xml.sax.parse( xmlfile, contenthandler[, errorhandler])</span><br><span class="line">参数说明:</span><br><span class="line"></span><br><span class="line">xmlfile - xml文件名</span><br><span class="line">contenthandler - 必须是一个ContentHandler的对象</span><br><span class="line">errorhandler - 如果指定该参数，errorhandler必须是一个SAX ErrorHandler对象</span><br><span class="line">parseString方法</span><br><span class="line">parseString方法创建一个XML解析器并解析xml字符串：</span><br><span class="line"></span><br><span class="line">xml.sax.parseString(xmlstring, contenthandler[, errorhandler])</span><br><span class="line">参数说明:</span><br><span class="line"></span><br><span class="line">xmlstring - xml字符串</span><br><span class="line">contenthandler - 必须是一个ContentHandler的对象</span><br><span class="line">errorhandler - 如果指定该参数，errorhandler必须是一个SAX ErrorHandler对象</span><br><span class="line">Python 解析XML实例</span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import xml.sax class MovieHandler( xml.sax.ContentHandler ): def __init__(self): self.CurrentData = "" self.type = "" self.format = "" self.year = "" self.rating = "" self.stars = "" self.description = "" # 元素开始事件处理 def startElement(self, tag, attributes): self.CurrentData = tag if tag == "movie": print "*****Movie*****" title = attributes["title"] print "Title:", title # 元素结束事件处理 def endElement(self, tag): if self.CurrentData == "type": print "Type:", self.type elif self.CurrentData == "format": print "Format:", self.format elif self.CurrentData == "year": print "Year:", self.year elif self.CurrentData == "rating": print "Rating:", self.rating elif self.CurrentData == "stars": print "Stars:", self.stars elif self.CurrentData == "description": print "Description:", self.description self.CurrentData = "" # 内容事件处理 def characters(self, content): if self.CurrentData == "type": self.type = content elif self.CurrentData == "format": self.format = content elif self.CurrentData == "year": self.year = content elif self.CurrentData == "rating": self.rating = content elif self.CurrentData == "stars": self.stars = content elif self.CurrentData == "description": self.description = content if ( __name__ == "__main__"): # 创建一个 XMLReader parser = xml.sax.make_parser() # turn off namepsaces parser.setFeature(xml.sax.handler.feature_namespaces, 0) # 重写 ContextHandler Handler = MovieHandler() parser.setContentHandler( Handler ) parser.parse("movies.xml")</span></span><br><span class="line"></span><br><span class="line">以上代码执行结果如下：</span><br><span class="line"></span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Enemy Behind</span><br><span class="line">Type: War, Thriller</span><br><span class="line">Format: DVD</span><br><span class="line">Year: <span class="number">2003</span></span><br><span class="line">Rating: PG</span><br><span class="line">Stars: <span class="number">10</span></span><br><span class="line">Description: Talk about a US-Japan war</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Transformers</span><br><span class="line">Type: Anime, Science Fiction</span><br><span class="line">Format: DVD</span><br><span class="line">Year: <span class="number">1989</span></span><br><span class="line">Rating: R</span><br><span class="line">Stars: <span class="number">8</span></span><br><span class="line">Description: A schientific fiction</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Trigun</span><br><span class="line">Type: Anime, Action</span><br><span class="line">Format: DVD</span><br><span class="line">Rating: PG</span><br><span class="line">Stars: <span class="number">10</span></span><br><span class="line">Description: Vash the Stampede!</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Ishtar</span><br><span class="line">Type: Comedy</span><br><span class="line">Format: VHS</span><br><span class="line">Rating: PG</span><br><span class="line">Stars: <span class="number">2</span></span><br><span class="line">Description: Viewable boredom</span><br><span class="line">完整的 SAX API 文档请查阅Python SAX APIs</span><br><span class="line"></span><br><span class="line">使用xml.dom解析xml</span><br><span class="line">文件对象模型（Document Object Model，简称DOM），是W3C组织推荐的处理可扩展置标语言的标准编程接口。</span><br><span class="line"></span><br><span class="line">一个 DOM 的解析器在解析一个 XML 文档时，一次性读取整个文档，把文档中所有元素保存在内存中的一个树结构里，之后你可以利用DOM 提供的不同的函数来读取或修改文档的内容和结构，也可以把修改过的内容写入xml文件。</span><br><span class="line"></span><br><span class="line">python中用xml.dom.minidom来解析xml文件，实例如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- from xml.dom.minidom import parse import xml.dom.minidom # 使用minidom解析器打开 XML 文档 DOMTree = xml.dom.minidom.parse("movies.xml") collection = DOMTree.documentElement if collection.hasAttribute("shelf"): print "Root element : %s" % collection.getAttribute("shelf") # 在集合中获取所有电影 movies = collection.getElementsByTagName("movie") # 打印每部电影的详细信息 for movie in movies: print "*****Movie*****" if movie.hasAttribute("title"): print "Title: %s" % movie.getAttribute("title") type = movie.getElementsByTagName('type')[0] print "Type: %s" % type.childNodes[0].data format = movie.getElementsByTagName('format')[0] print "Format: %s" % format.childNodes[0].data rating = movie.getElementsByTagName('rating')[0] print "Rating: %s" % rating.childNodes[0].data description = movie.getElementsByTagName('description')[0] print "Description: %s" % description.childNodes[0].data</span></span><br><span class="line"></span><br><span class="line">以上程序执行结果如下：</span><br><span class="line"></span><br><span class="line">Root element : New Arrivals</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Enemy Behind</span><br><span class="line">Type: War, Thriller</span><br><span class="line">Format: DVD</span><br><span class="line">Rating: PG</span><br><span class="line">Description: Talk about a US-Japan war</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Transformers</span><br><span class="line">Type: Anime, Science Fiction</span><br><span class="line">Format: DVD</span><br><span class="line">Rating: R</span><br><span class="line">Description: A schientific fiction</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Trigun</span><br><span class="line">Type: Anime, Action</span><br><span class="line">Format: DVD</span><br><span class="line">Rating: PG</span><br><span class="line">Description: Vash the Stampede!</span><br><span class="line">*****Movie*****</span><br><span class="line">Title: Ishtar</span><br><span class="line">Type: Comedy</span><br><span class="line">Format: VHS</span><br><span class="line">Rating: PG</span><br><span class="line">Description: Viewable boredom</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-8/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day-9"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day-9/">python GUI day 09-9</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:01" datetime="2019-12-27T12:00:01.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">Python GUI编程(Tkinter)</span><br><span class="line">Python 提供了多个图形开发界面的库，几个常用 Python GUI 库如下：</span><br><span class="line"></span><br><span class="line">Tkinter： Tkinter 模块(Tk 接口)是 Python 的标准 Tk GUI 工具包的接口 .Tk 和 Tkinter 可以在大多数的 Unix 平台下使用,同样可以应用在 Windows 和 Macintosh 系统里。Tk8<span class="number">.0</span> 的后续版本可以实现本地窗口风格,并良好地运行在绝大多数平台中。</span><br><span class="line"></span><br><span class="line">wxPython：wxPython 是一款开源软件，是 Python 语言的一套优秀的 GUI 图形库，允许 Python 程序员很方便的创建完整的、功能健全的 GUI 用户界面。</span><br><span class="line"></span><br><span class="line">Jython：Jython 程序可以和 Java 无缝集成。除了一些标准模块，Jython 使用 Java 的模块。Jython 几乎拥有标准的Python 中不依赖于 C 语言的全部模块。比如，Jython 的用户界面将使用 Swing，AWT或者 SWT。Jython 可以被动态或静态地编译成 Java 字节码。</span><br><span class="line"></span><br><span class="line">Tkinter 编程</span><br><span class="line">Tkinter 是 Python 的标准 GUI 库。Python 使用 Tkinter 可以快速的创建 GUI 应用程序。</span><br><span class="line"></span><br><span class="line">由于 Tkinter 是内置到 python 的安装包中、只要安装好 Python 之后就能 <span class="keyword">import</span> Tkinter 库、而且 IDLE 也是用 Tkinter 编写而成、对于简单的图形界面 Tkinter 还是能应付自如。</span><br><span class="line"></span><br><span class="line">注意：Python3.x 版本使用的库名为 tkinter,即首写字母 T 为小写。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tkinter</span><br><span class="line">创建一个GUI程序</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、导入 Tkinter 模块</span><br><span class="line"><span class="number">2</span>、创建控件</span><br><span class="line"><span class="number">3</span>、指定这个控件的 master， 即这个控件属于哪一个</span><br><span class="line"><span class="number">4</span>、告诉 GM(geometry manager) 有一个控件产生了。</span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import Tkinter top = Tkinter.Tk() # 进入消息循环 top.mainloop()</span></span><br><span class="line"></span><br><span class="line">以上代码执行结果如下图:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- from Tkinter import * # 导入 Tkinter 库 root = Tk() # 创建窗口对象的背景色 # 创建两个列表 li = ['C','python','php','html','SQL','java'] movie = ['CSS','jQuery','Bootstrap'] listb = Listbox(root) # 创建两个列表组件 listb2 = Listbox(root) for item in li: # 第一个小部件插入数据 listb.insert(0,item) for item in movie: # 第二个小部件插入数据 listb2.insert(0,item) listb.pack() # 将小部件放置到主窗口中 listb2.pack() root.mainloop() # 进入消息循环</span></span><br><span class="line"></span><br><span class="line">以上代码执行结果如下图:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Tkinter 组件</span><br><span class="line">Tkinter的提供各种控件，如按钮，标签和文本框，一个GUI应用程序中使用。这些控件通常被称为控件或者部件。</span><br><span class="line"></span><br><span class="line">目前有<span class="number">15</span>种Tkinter的部件。我们提出这些部件以及一个简短的介绍，在下面的表:</span><br><span class="line"></span><br><span class="line">控件	描述</span><br><span class="line">Button	按钮控件；在程序中显示按钮。</span><br><span class="line">Canvas	画布控件；显示图形元素如线条或文本</span><br><span class="line">Checkbutton	多选框控件；用于在程序中提供多项选择框</span><br><span class="line">Entry	输入控件；用于显示简单的文本内容</span><br><span class="line">Frame	框架控件；在屏幕上显示一个矩形区域，多用来作为容器</span><br><span class="line">Label	标签控件；可以显示文本和位图</span><br><span class="line">Listbox	列表框控件；在Listbox窗口小部件是用来显示一个字符串列表给用户</span><br><span class="line">Menubutton	菜单按钮控件，用于显示菜单项。</span><br><span class="line">Menu	菜单控件；显示菜单栏,下拉菜单和弹出菜单</span><br><span class="line">Message	消息控件；用来显示多行文本，与label比较类似</span><br><span class="line">Radiobutton	单选按钮控件；显示一个单选的按钮状态</span><br><span class="line">Scale	范围控件；显示一个数值刻度，为输出限定范围的数字区间</span><br><span class="line">Scrollbar	滚动条控件，当内容超过可视化区域时使用，如列表框。.</span><br><span class="line">Text	文本控件；用于显示多行文本</span><br><span class="line">Toplevel	容器控件；用来提供一个单独的对话框，和Frame比较类似</span><br><span class="line">Spinbox	输入控件；与Entry类似，但是可以指定输入范围值</span><br><span class="line">PanedWindow	PanedWindow是一个窗口布局管理的插件，可以包含一个或者多个子控件。</span><br><span class="line">LabelFrame	labelframe 是一个简单的容器控件。常用与复杂的窗口布局。</span><br><span class="line">tkMessageBox	用于显示你应用程序的消息框。</span><br><span class="line">标准属性</span><br><span class="line">标准属性也就是所有控件的共同属性，如大小，字体和颜色等等。</span><br><span class="line"></span><br><span class="line">属性	描述</span><br><span class="line">Dimension	控件大小；</span><br><span class="line">Color	控件颜色；</span><br><span class="line">Font	控件字体；</span><br><span class="line">Anchor	锚点；</span><br><span class="line">Relief	控件样式；</span><br><span class="line">Bitmap	位图；</span><br><span class="line">Cursor	光标；</span><br><span class="line">几何管理</span><br><span class="line">Tkinter控件有特定的几何状态管理方法，管理整个控件区域组织，一下是Tkinter公开的几何管理类：包、网格、位置</span><br><span class="line"></span><br><span class="line">几何方法	描述</span><br><span class="line">pack()	包装；</span><br><span class="line">grid()	网格；</span><br><span class="line">place()	位置；</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day-9/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 9day"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/27/study%20python%209day/">python 面向对象 day 09</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-27 20:00:00" datetime="2019-12-27T12:00:00.000Z"  itemprop="datePublished">2019-12-27</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br></pre></td><td class="code"><pre><span class="line">Python 面向对象</span><br><span class="line">Python从设计之初就已经是一门面向对象的语言，正因为如此，在Python中创建一个类和对象是很容易的。本章节我们将详细介绍Python的面向对象编程。</span><br><span class="line"></span><br><span class="line">如果你以前没有接触过面向对象的编程语言，那你可能需要先了解一些面向对象语言的一些基本特征，在头脑里头形成一个基本的面向对象的概念，这样有助于你更容易的学习Python的面向对象编程。</span><br><span class="line"></span><br><span class="line">接下来我们先来简单的了解下面向对象的一些基本特征。</span><br><span class="line"></span><br><span class="line">面向对象技术简介</span><br><span class="line">类(Class): 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。</span><br><span class="line">类变量：类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。</span><br><span class="line">数据成员：类变量或者实例变量, 用于处理类及其实例对象的相关的数据。</span><br><span class="line">方法重写：如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。</span><br><span class="line">局部变量：定义在方法中的变量，只作用于当前实例的类。</span><br><span class="line">实例变量：在类的声明中，属性是用变量来表示的。这种变量就称为实例变量，是在类声明的内部但是在类的其他成员方法之外声明的。</span><br><span class="line">继承：即一个派生类（derived <span class="class"><span class="keyword">class</span>）继承基类（<span class="title">base</span> <span class="title">class</span>）的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。例如，有这样一个设计：一个<span class="title">Dog</span>类型的对象派生自<span class="title">Animal</span>类，这是模拟"是一个（<span class="title">is</span>-<span class="title">a</span>）"关系（例图，<span class="title">Dog</span>是一个<span class="title">Animal</span>）。</span></span><br><span class="line"><span class="class">实例化：创建一个类的实例，类的具体对象。</span></span><br><span class="line"><span class="class">方法：类中定义的函数。</span></span><br><span class="line"><span class="class">对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。</span></span><br><span class="line"><span class="class">创建类</span></span><br><span class="line"><span class="class">使用 <span class="title">class</span> 语句来创建一个新类，<span class="title">class</span> 之后为类的名称并以冒号结尾:</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span>:</span></span><br><span class="line">   <span class="string">'类的帮助信息'</span>   <span class="comment">#类文档字符串</span></span><br><span class="line">   class_suite  <span class="comment">#类体</span></span><br><span class="line">类的帮助信息可以通过ClassName.__doc__查看。</span><br><span class="line"></span><br><span class="line">class_suite 由类成员，方法，数据属性组成。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line">以下是一个简单的 Python 类的例子:</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Employee: '所有员工的基类' empCount = 0 def __init__(self, name, salary): self.name = name self.salary = salary Employee.empCount += 1 def displayCount(self): print "Total Employee %d" % Employee.empCount def displayEmployee(self): print "Name : ", self.name, ", Salary: ", self.salary</span></span><br><span class="line"></span><br><span class="line">empCount 变量是一个类变量，它的值将在这个类的所有实例之间共享。你可以在内部类或外部类使用 Employee.empCount 访问。</span><br><span class="line"></span><br><span class="line">第一种方法__init__()方法是一种特殊的方法，被称为类的构造函数或初始化方法，当创建了这个类的实例时就会调用该方法</span><br><span class="line"></span><br><span class="line">self 代表类的实例，self 在定义类的方法时是必须有的，虽然在调用时不必传入相应的参数。</span><br><span class="line"></span><br><span class="line">self代表类的实例，而非类</span><br><span class="line">类的方法与普通的函数只有一个特别的区别——它们必须有一个额外的第一个参数名称, 按照惯例它的名称是 self。</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span> <span class="function"><span class="keyword">def</span> <span class="title">prt</span><span class="params">(self)</span>:</span> print(self) print(self.__class__) t = Test() t.prt()</span><br><span class="line"></span><br><span class="line">以上实例执行结果为：</span><br><span class="line"></span><br><span class="line">&lt;__main__.Test instance at <span class="number">0x10d066878</span>&gt;</span><br><span class="line">__main__.Test</span><br><span class="line">从执行结果可以很明显的看出，self 代表的是类的实例，代表当前对象的地址，而 self.__class__ 则指向类。</span><br><span class="line"></span><br><span class="line">self 不是 python 关键字，我们把他换成 runoob 也是可以正常执行的:</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span> <span class="function"><span class="keyword">def</span> <span class="title">prt</span><span class="params">(runoob)</span>:</span> print(runoob) print(runoob.__class__) t = Test() t.prt()</span><br><span class="line"></span><br><span class="line">以上实例执行结果为：</span><br><span class="line"></span><br><span class="line">&lt;__main__.Test instance at <span class="number">0x10d066878</span>&gt;</span><br><span class="line">__main__.Test</span><br><span class="line">创建实例对象</span><br><span class="line">实例化类其他编程语言中一般用关键字 new，但是在 Python 中并没有这个关键字，类的实例化类似函数调用方式。</span><br><span class="line"></span><br><span class="line">以下使用类的名称 Employee 来实例化，并通过 __init__ 方法接收参数。</span><br><span class="line"></span><br><span class="line"><span class="string">"创建 Employee 类的第一个对象"</span></span><br><span class="line">emp1 = Employee(<span class="string">"Zara"</span>, <span class="number">2000</span>)</span><br><span class="line"><span class="string">"创建 Employee 类的第二个对象"</span></span><br><span class="line">emp2 = Employee(<span class="string">"Manni"</span>, <span class="number">5000</span>)</span><br><span class="line">访问属性</span><br><span class="line">您可以使用点号 . 来访问对象的属性。使用如下类的名称访问类变量:</span><br><span class="line"></span><br><span class="line">emp1.displayEmployee()</span><br><span class="line">emp2.displayEmployee()</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Total Employee %d"</span> % Employee.empCount</span><br><span class="line">完整实例：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Employee: '所有员工的基类' empCount = 0 def __init__(self, name, salary): self.name = name self.salary = salary Employee.empCount += 1 def displayCount(self): print "Total Employee %d" % Employee.empCount def displayEmployee(self): print "Name : ", self.name, ", Salary: ", self.salary "创建 Employee 类的第一个对象" emp1 = Employee("Zara", 2000) "创建 Employee 类的第二个对象" emp2 = Employee("Manni", 5000) emp1.displayEmployee() emp2.displayEmployee() print "Total Employee %d" % Employee.empCount</span></span><br><span class="line"></span><br><span class="line">执行以上代码输出结果如下：</span><br><span class="line"></span><br><span class="line">Name :  Zara ,Salary:  <span class="number">2000</span></span><br><span class="line">Name :  Manni ,Salary:  <span class="number">5000</span></span><br><span class="line">Total Employee <span class="number">2</span></span><br><span class="line">你可以添加，删除，修改类的属性，如下所示：</span><br><span class="line"></span><br><span class="line">emp1.age = <span class="number">7</span>  <span class="comment"># 添加一个 'age' 属性</span></span><br><span class="line">emp1.age = <span class="number">8</span>  <span class="comment"># 修改 'age' 属性</span></span><br><span class="line"><span class="keyword">del</span> emp1.age  <span class="comment"># 删除 'age' 属性</span></span><br><span class="line">你也可以使用以下函数的方式来访问属性：</span><br><span class="line"></span><br><span class="line">getattr(obj, name[, default]) : 访问对象的属性。</span><br><span class="line">hasattr(obj,name) : 检查是否存在一个属性。</span><br><span class="line">setattr(obj,name,value) : 设置一个属性。如果属性不存在，会创建一个新属性。</span><br><span class="line">delattr(obj, name) : 删除属性。</span><br><span class="line">hasattr(emp1, <span class="string">'age'</span>) <span class="comment"># 如果存在 'age' 属性返回 True。 getattr(emp1, 'age') # 返回 'age' 属性的值 setattr(emp1, 'age', 8) # 添加属性 'age' 值为 8 delattr(emp1, 'age') # 删除属性 'age'</span></span><br><span class="line"></span><br><span class="line">Python内置类属性</span><br><span class="line">__dict__ : 类的属性（包含一个字典，由类的数据属性组成）</span><br><span class="line">__doc__ :类的文档字符串</span><br><span class="line">__name__: 类名</span><br><span class="line">__module__: 类定义所在的模块（类的全名是<span class="string">'__main__.className'</span>，如果类位于一个导入模块mymod中，那么className.__module__ 等于 mymod）</span><br><span class="line">__bases__ : 类的所有父类构成元素（包含了一个由所有父类组成的元组）</span><br><span class="line">Python内置类属性调用实例如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Employee: '所有员工的基类' empCount = 0 def __init__(self, name, salary): self.name = name self.salary = salary Employee.empCount += 1 def displayCount(self): print "Total Employee %d" % Employee.empCount def displayEmployee(self): print "Name : ", self.name, ", Salary: ", self.salary print "Employee.__doc__:", Employee.__doc__ print "Employee.__name__:", Employee.__name__ print "Employee.__module__:", Employee.__module__ print "Employee.__bases__:", Employee.__bases__ print "Employee.__dict__:", Employee.__dict__</span></span><br><span class="line"></span><br><span class="line">执行以上代码输出结果如下：</span><br><span class="line"></span><br><span class="line">Employee.__doc__: 所有员工的基类</span><br><span class="line">Employee.__name__: Employee</span><br><span class="line">Employee.__module__: __main__</span><br><span class="line">Employee.__bases__: ()</span><br><span class="line">Employee.__dict__: &#123;<span class="string">'__module__'</span>: <span class="string">'__main__'</span>, <span class="string">'displayCount'</span>: &lt;function displayCount at <span class="number">0x10a939c80</span>&gt;, <span class="string">'empCount'</span>: <span class="number">0</span>, <span class="string">'displayEmployee'</span>: &lt;function displayEmployee at <span class="number">0x10a93caa0</span>&gt;, <span class="string">'__doc__'</span>: <span class="string">'\xe6\x89\x80\xe6\x9c\x89\xe5\x91\x98\xe5\xb7\xa5\xe7\x9a\x84\xe5\x9f\xba\xe7\xb1\xbb'</span>, <span class="string">'__init__'</span>: &lt;function __init__ at <span class="number">0x10a939578</span>&gt;&#125;</span><br><span class="line">python对象销毁(垃圾回收)</span><br><span class="line">Python 使用了引用计数这一简单技术来跟踪和回收垃圾。</span><br><span class="line"></span><br><span class="line">在 Python 内部记录着所有使用中的对象各有多少引用。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">一个内部跟踪变量，称为一个引用计数器。</span><br><span class="line"></span><br><span class="line">当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为<span class="number">0</span> 时， 它被垃圾回收。但是回收不是<span class="string">"立即"</span>的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。</span><br><span class="line"></span><br><span class="line">a = <span class="number">40</span>      <span class="comment"># 创建对象  &lt;40&gt;</span></span><br><span class="line">b = a       <span class="comment"># 增加引用， &lt;40&gt; 的计数</span></span><br><span class="line">c = [b]     <span class="comment"># 增加引用.  &lt;40&gt; 的计数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> a       <span class="comment"># 减少引用 &lt;40&gt; 的计数</span></span><br><span class="line">b = <span class="number">100</span>     <span class="comment"># 减少引用 &lt;40&gt; 的计数</span></span><br><span class="line">c[<span class="number">0</span>] = <span class="number">-1</span>   <span class="comment"># 减少引用 &lt;40&gt; 的计数</span></span><br><span class="line">垃圾回收机制不仅针对引用计数为<span class="number">0</span>的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line">析构函数 __del__ ，__del__在对象销毁的时候被调用，当对象不再被使用时，__del__方法运行：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Point: def __init__( self, x=0, y=0): self.x = x self.y = y def __del__(self): class_name = self.__class__.__name__ print class_name, "销毁" pt1 = Point() pt2 = pt1 pt3 = pt1 print id(pt1), id(pt2), id(pt3) # 打印对象的id del pt1 del pt2 del pt3</span></span><br><span class="line"></span><br><span class="line">以上实例运行结果如下：</span><br><span class="line"></span><br><span class="line"><span class="number">3083401324</span> <span class="number">3083401324</span> <span class="number">3083401324</span></span><br><span class="line">Point 销毁</span><br><span class="line">注意：通常你需要在单独的文件中定义一个类，</span><br><span class="line"></span><br><span class="line">类的继承</span><br><span class="line">面向对象的编程带来的主要好处之一是代码的重用，实现这种重用的方法之一是通过继承机制。</span><br><span class="line"></span><br><span class="line">通过继承创建的新类称为子类或派生类，被继承的类称为基类、父类或超类。</span><br><span class="line"></span><br><span class="line">继承语法</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> 派生类名<span class="params">(基类名)</span></span></span><br><span class="line"><span class="class">    ...</span></span><br><span class="line"><span class="class">在<span class="title">python</span>中继承中的一些特点：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">1、如果在子类中需要父类的构造方法就需要显示的调用父类的构造方法，或者不重写父类的构造方法。详细说明可查看：<span class="title">python</span> 子类继承父类构造函数说明。</span></span><br><span class="line"><span class="class">2、在调用基类的方法时，需要加上基类的类名前缀，且需要带上 <span class="title">self</span> 参数变量。区别在于类中调用普通函数时并不需要带上 <span class="title">self</span> 参数</span></span><br><span class="line"><span class="class">3、<span class="title">Python</span> 总是首先查找对应类型的方法，如果它不能在派生类中找到对应的方法，它才开始到基类中逐个查找。（先在本类中查找调用的方法，找不到才去基类中找）。</span></span><br><span class="line"><span class="class">如果在继承元组中列了一个以上的类，那么它就被称作"多重继承" 。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">语法：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">派生类的声明，与他们的父类类似，继承的基类列表跟在类名之后，如下所示：</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">SubClassName</span> <span class="params">(ParentClass1[, ParentClass2, ...])</span>:</span></span><br><span class="line">    ...</span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Parent: # 定义父类 parentAttr = 100 def __init__(self): print "调用父类构造函数" def parentMethod(self): print '调用父类方法' def setAttr(self, attr): Parent.parentAttr = attr def getAttr(self): print "父类属性 :", Parent.parentAttr class Child(Parent): # 定义子类 def __init__(self): print "调用子类构造方法" def childMethod(self): print '调用子类方法' c = Child() # 实例化子类 c.childMethod() # 调用子类的方法 c.parentMethod() # 调用父类方法 c.setAttr(200) # 再次调用父类的方法 - 设置属性值 c.getAttr() # 再次调用父类的方法 - 获取属性值</span></span><br><span class="line"></span><br><span class="line">以上代码执行结果如下：</span><br><span class="line"></span><br><span class="line">调用子类构造方法</span><br><span class="line">调用子类方法</span><br><span class="line">调用父类方法</span><br><span class="line">父类属性 : <span class="number">200</span></span><br><span class="line">你可以继承多个类</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span>        <span class="comment"># 定义类 A</span></span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span>         <span class="comment"># 定义类 B</span></span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A, B)</span>:</span>   <span class="comment"># 继承类 A 和 B</span></span><br><span class="line">.....</span><br><span class="line">你可以使用issubclass()或者isinstance()方法来检测。</span><br><span class="line"></span><br><span class="line">issubclass() - 布尔函数判断一个类是另一个类的子类或者子孙类，语法：issubclass(sub,sup)</span><br><span class="line">isinstance(obj, Class) 布尔函数如果obj是Class类的实例对象或者是一个Class子类的实例对象则返回true。</span><br><span class="line">方法重写</span><br><span class="line">如果你的父类方法的功能不能满足你的需求，你可以在子类重写你父类的方法：</span><br><span class="line"></span><br><span class="line">实例：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class Parent: # 定义父类 def myMethod(self): print '调用父类方法' class Child(Parent): # 定义子类 def myMethod(self): print '调用子类方法' c = Child() # 子类实例 c.myMethod() # 子类调用重写方法</span></span><br><span class="line"></span><br><span class="line">执行以上代码输出结果如下：</span><br><span class="line"></span><br><span class="line">调用子类方法</span><br><span class="line">基础重载方法</span><br><span class="line">下表列出了一些通用的功能，你可以在自己的类重写：</span><br><span class="line"></span><br><span class="line">序号	方法, 描述 &amp; 简单的调用</span><br><span class="line"><span class="number">1</span>	__init__ ( self [,args...] )</span><br><span class="line">构造函数</span><br><span class="line">简单的调用方法: obj = className(args)</span><br><span class="line"><span class="number">2</span>	__del__( self )</span><br><span class="line">析构方法, 删除一个对象</span><br><span class="line">简单的调用方法 : <span class="keyword">del</span> obj</span><br><span class="line"><span class="number">3</span>	__repr__( self )</span><br><span class="line">转化为供解释器读取的形式</span><br><span class="line">简单的调用方法 : repr(obj)</span><br><span class="line"><span class="number">4</span>	__str__( self )</span><br><span class="line">用于将值转化为适于人阅读的形式</span><br><span class="line">简单的调用方法 : str(obj)</span><br><span class="line"><span class="number">5</span>	__cmp__ ( self, x )</span><br><span class="line">对象比较</span><br><span class="line">简单的调用方法 : cmp(obj, x)</span><br><span class="line">运算符重载</span><br><span class="line">Python同样支持运算符重载，实例如下：</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python class Vector: def __init__(self, a, b): self.a = a self.b = b def __str__(self): return 'Vector (%d, %d)' % (self.a, self.b) def __add__(self,other): return Vector(self.a + other.a, self.b + other.b) v1 = Vector(2,10) v2 = Vector(5,-2) print v1 + v2</span></span><br><span class="line"></span><br><span class="line">以上代码执行结果如下所示:</span><br><span class="line"></span><br><span class="line">Vector(<span class="number">7</span>,<span class="number">8</span>)</span><br><span class="line">类属性与方法</span><br><span class="line">类的私有属性</span><br><span class="line">__private_attrs：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 self.__private_attrs。</span><br><span class="line"></span><br><span class="line">类的方法</span><br><span class="line">在类的内部，使用 def 关键字可以为类定义一个方法，与一般函数定义不同，类方法必须包含参数 self,且为第一个参数</span><br><span class="line"></span><br><span class="line">类的私有方法</span><br><span class="line">__private_method：两个下划线开头，声明该方法为私有方法，不能在类的外部调用。在类的内部调用 self.__private_methods</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- class JustCounter: __secretCount = 0 # 私有变量 publicCount = 0 # 公开变量 def count(self): self.__secretCount += 1 self.publicCount += 1 print self.__secretCount counter = JustCounter() counter.count() counter.count() print counter.publicCount print counter.__secretCount # 报错，实例不能访问私有变量</span></span><br><span class="line"></span><br><span class="line">Python 通过改变名称来包含类名:</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"test.py"</span>, line <span class="number">17</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">print</span> counter.__secretCount  <span class="comment"># 报错，实例不能访问私有变量</span></span><br><span class="line">AttributeError: JustCounter instance has no attribute <span class="string">'__secretCount'</span></span><br><span class="line">Python不允许实例化的类访问私有数据，但你可以使用 object._className__attrName（ 对象名._类名__私有属性名 ）访问属性，参考以下实例：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Runoob</span>:</span></span><br><span class="line">    __site = <span class="string">"www.runoob.com"</span></span><br><span class="line"></span><br><span class="line">runoob = Runoob()</span><br><span class="line"><span class="keyword">print</span> runoob._Runoob__site</span><br><span class="line">执行以上代码，执行结果如下：</span><br><span class="line"></span><br><span class="line">www.runoob.com</span><br><span class="line">单下划线、双下划线、头尾双下划线说明：</span><br><span class="line">__foo__: 定义的是特殊方法，一般是系统定义名字 ，类似 __init__() 之类的。</span><br><span class="line"></span><br><span class="line">_foo: 以单下划线开头的表示的是 protected 类型的变量，即保护类型只能允许其本身与子类进行访问，不能用于 <span class="keyword">from</span> module <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">__foo: 双下划线的表示的是私有类型(private)的变量, 只能是允许这个类本身进行访问了。</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/27/study%20python%209day/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-study python 8day-2"
  class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/2019/12/26/study%20python%208day-2/">python 时间 日期 day 08-2</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2019-12-26 20:00:00" datetime="2019-12-26T12:00:00.000Z"  itemprop="datePublished">2019-12-26</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line">Python 日期和时间</span><br><span class="line">Python 程序能用很多方式处理日期和时间，转换日期格式是一个常见的功能。</span><br><span class="line"></span><br><span class="line">Python 提供了一个 time 和 calendar 模块可以用于格式化日期和时间。</span><br><span class="line"></span><br><span class="line">时间间隔是以秒为单位的浮点小数。</span><br><span class="line"></span><br><span class="line">每个时间戳都以自从<span class="number">1970</span>年<span class="number">1</span>月<span class="number">1</span>日午夜（历元）经过了多长时间来表示。</span><br><span class="line"></span><br><span class="line">Python 的 time 模块下有很多函数可以转换常见日期格式。如函数time.time()用于获取当前时间戳, 如下实例:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import time; # 引入time模块 ticks = time.time() print "当前时间戳为:", ticks</span></span><br><span class="line"></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">当前时间戳为: <span class="number">1459994552.51</span></span><br><span class="line">时间戳单位最适于做日期运算。但是<span class="number">1970</span>年之前的日期就无法以此表示了。太遥远的日期也不行，UNIX和Windows只支持到<span class="number">2038</span>年。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">什么是时间元组？</span><br><span class="line">很多Python函数用一个元组装起来的<span class="number">9</span>组数字处理时间:</span><br><span class="line"></span><br><span class="line">序号	字段	值</span><br><span class="line"><span class="number">0</span>	<span class="number">4</span>位数年	<span class="number">2008</span></span><br><span class="line"><span class="number">1</span>	月	<span class="number">1</span> 到 <span class="number">12</span></span><br><span class="line"><span class="number">2</span>	日	<span class="number">1</span>到<span class="number">31</span></span><br><span class="line"><span class="number">3</span>	小时	<span class="number">0</span>到<span class="number">23</span></span><br><span class="line"><span class="number">4</span>	分钟	<span class="number">0</span>到<span class="number">59</span></span><br><span class="line"><span class="number">5</span>	秒	<span class="number">0</span>到<span class="number">61</span> (<span class="number">60</span>或<span class="number">61</span> 是闰秒)</span><br><span class="line"><span class="number">6</span>	一周的第几日	<span class="number">0</span>到<span class="number">6</span> (<span class="number">0</span>是周一)</span><br><span class="line"><span class="number">7</span>	一年的第几日	<span class="number">1</span>到<span class="number">366</span> (儒略历)</span><br><span class="line"><span class="number">8</span>	夏令时	<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>是决定是否为夏令时的旗帜</span><br><span class="line">上述也就是struct_time元组。这种结构具有如下属性：</span><br><span class="line"></span><br><span class="line">序号	属性	值</span><br><span class="line"><span class="number">0</span>	tm_year	<span class="number">2008</span></span><br><span class="line"><span class="number">1</span>	tm_mon	<span class="number">1</span> 到 <span class="number">12</span></span><br><span class="line"><span class="number">2</span>	tm_mday	<span class="number">1</span> 到 <span class="number">31</span></span><br><span class="line"><span class="number">3</span>	tm_hour	<span class="number">0</span> 到 <span class="number">23</span></span><br><span class="line"><span class="number">4</span>	tm_min	<span class="number">0</span> 到 <span class="number">59</span></span><br><span class="line"><span class="number">5</span>	tm_sec	<span class="number">0</span> 到 <span class="number">61</span> (<span class="number">60</span>或<span class="number">61</span> 是闰秒)</span><br><span class="line"><span class="number">6</span>	tm_wday	<span class="number">0</span>到<span class="number">6</span> (<span class="number">0</span>是周一)</span><br><span class="line"><span class="number">7</span>	tm_yday	<span class="number">1</span> 到 <span class="number">366</span>(儒略历)</span><br><span class="line"><span class="number">8</span>	tm_isdst	<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>是决定是否为夏令时的旗帜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">获取当前时间</span><br><span class="line">从返回浮点数的时间戳方式向时间元组转换，只要将浮点数传递给如localtime之类的函数。</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import time localtime = time.localtime(time.time()) print "本地时间为 :", localtime</span></span><br><span class="line"></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">本地时间为 : time.struct_time(tm_year=<span class="number">2016</span>, tm_mon=<span class="number">4</span>, tm_mday=<span class="number">7</span>, tm_hour=<span class="number">10</span>, tm_min=<span class="number">3</span>, tm_sec=<span class="number">27</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">98</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">获取格式化的时间</span><br><span class="line">你可以根据需求选取各种格式，但是最简单的获取可读的时间模式的函数是asctime():</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import time localtime = time.asctime( time.localtime(time.time()) ) print "本地时间为 :", localtime</span></span><br><span class="line"></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">本地时间为 : Thu Apr  <span class="number">7</span> <span class="number">10</span>:<span class="number">05</span>:<span class="number">21</span> <span class="number">2016</span></span><br><span class="line">格式化日期</span><br><span class="line">我们可以使用 time 模块的 strftime 方法来格式化日期，：</span><br><span class="line"></span><br><span class="line">time.strftime(format[, t])</span><br><span class="line">实例演示：</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import time # 格式化成2016-03-20 11:45:39形式 print time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()) # 格式化成Sat Mar 28 22:24:24 2016形式 print time.strftime("%a %b %d %H:%M:%S %Y", time.localtime()) # 将格式字符串转换为时间戳 a = "Sat Mar 28 22:24:24 2016" print time.mktime(time.strptime(a,"%a %b %d %H:%M:%S %Y"))</span></span><br><span class="line"></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line"><span class="number">2016</span><span class="number">-04</span><span class="number">-07</span> <span class="number">10</span>:<span class="number">25</span>:<span class="number">09</span></span><br><span class="line">Thu Apr <span class="number">07</span> <span class="number">10</span>:<span class="number">25</span>:<span class="number">09</span> <span class="number">2016</span></span><br><span class="line"><span class="number">1459175064.0</span></span><br><span class="line">python中时间日期格式化符号：</span><br><span class="line"></span><br><span class="line">%y 两位数的年份表示（<span class="number">00</span><span class="number">-99</span>）</span><br><span class="line">%Y 四位数的年份表示（<span class="number">000</span><span class="number">-9999</span>）</span><br><span class="line">%m 月份（<span class="number">01</span><span class="number">-12</span>）</span><br><span class="line">%d 月内中的一天（<span class="number">0</span><span class="number">-31</span>）</span><br><span class="line">%H <span class="number">24</span>小时制小时数（<span class="number">0</span><span class="number">-23</span>）</span><br><span class="line">%I <span class="number">12</span>小时制小时数（<span class="number">01</span><span class="number">-12</span>）</span><br><span class="line">%M 分钟数（<span class="number">00</span>=<span class="number">59</span>）</span><br><span class="line">%S 秒（<span class="number">00</span><span class="number">-59</span>）</span><br><span class="line">%a 本地简化星期名称</span><br><span class="line">%A 本地完整星期名称</span><br><span class="line">%b 本地简化的月份名称</span><br><span class="line">%B 本地完整的月份名称</span><br><span class="line">%c 本地相应的日期表示和时间表示</span><br><span class="line">%j 年内的一天（<span class="number">001</span><span class="number">-366</span>）</span><br><span class="line">%p 本地A.M.或P.M.的等价符</span><br><span class="line">%U 一年中的星期数（<span class="number">00</span><span class="number">-53</span>）星期天为星期的开始</span><br><span class="line">%w 星期（<span class="number">0</span><span class="number">-6</span>），星期天为星期的开始</span><br><span class="line">%W 一年中的星期数（<span class="number">00</span><span class="number">-53</span>）星期一为星期的开始</span><br><span class="line">%x 本地相应的日期表示</span><br><span class="line">%X 本地相应的时间表示</span><br><span class="line">%Z 当前时区的名称</span><br><span class="line">%% %号本身</span><br><span class="line">获取某月日历</span><br><span class="line">Calendar模块有很广泛的方法用来处理年历和月历，例如打印某月的月历：</span><br><span class="line"></span><br><span class="line">实例(Python <span class="number">2.0</span>+)</span><br><span class="line"><span class="comment">#!/usr/bin/python # -*- coding: UTF-8 -*- import calendar cal = calendar.month(2016, 1) print "以下输出2016年1月份的日历:" print cal</span></span><br><span class="line"></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">以下输出<span class="number">2016</span>年<span class="number">1</span>月份的日历:</span><br><span class="line">    January <span class="number">2016</span></span><br><span class="line">Mo Tu We Th Fr Sa Su</span><br><span class="line">             <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line"> <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line"><span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span></span><br><span class="line"><span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">24</span></span><br><span class="line"><span class="number">25</span> <span class="number">26</span> <span class="number">27</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">31</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Time 模块</span><br><span class="line">Time 模块包含了以下内置函数，既有时间处理的，也有转换时间格式的：</span><br><span class="line"></span><br><span class="line">序号	函数及描述</span><br><span class="line"><span class="number">1</span>	time.altzone</span><br><span class="line">返回格林威治西部的夏令时地区的偏移秒数。如果该地区在格林威治东部会返回负值（如西欧，包括英国）。对夏令时启用地区才能使用。</span><br><span class="line"><span class="number">2</span>	time.asctime([tupletime])</span><br><span class="line">接受时间元组并返回一个可读的形式为<span class="string">"Tue Dec 11 18:07:14 2008"</span>（<span class="number">2008</span>年<span class="number">12</span>月<span class="number">11</span>日 周二<span class="number">18</span>时<span class="number">07</span>分<span class="number">14</span>秒）的<span class="number">24</span>个字符的字符串。</span><br><span class="line"><span class="number">3</span>	time.clock( )</span><br><span class="line">用以浮点数计算的秒数返回当前的CPU时间。用来衡量不同程序的耗时，比time.time()更有用。</span><br><span class="line"><span class="number">4</span>	time.ctime([secs])</span><br><span class="line">作用相当于asctime(localtime(secs))，未给参数相当于asctime()</span><br><span class="line"><span class="number">5</span>	time.gmtime([secs])</span><br><span class="line">接收时间戳（<span class="number">1970</span>纪元后经过的浮点秒数）并返回格林威治天文时间下的时间元组t。注：t.tm_isdst始终为<span class="number">0</span></span><br><span class="line"><span class="number">6</span>	time.localtime([secs])</span><br><span class="line">接收时间戳（<span class="number">1970</span>纪元后经过的浮点秒数）并返回当地时间下的时间元组t（t.tm_isdst可取<span class="number">0</span>或<span class="number">1</span>，取决于当地当时是不是夏令时）。</span><br><span class="line"><span class="number">7</span>	time.mktime(tupletime)</span><br><span class="line">接受时间元组并返回时间戳（<span class="number">1970</span>纪元后经过的浮点秒数）。</span><br><span class="line"><span class="number">8</span>	time.sleep(secs)</span><br><span class="line">推迟调用线程的运行，secs指秒数。</span><br><span class="line"><span class="number">9</span>	time.strftime(fmt[,tupletime])</span><br><span class="line">接收以时间元组，并返回以可读字符串表示的当地时间，格式由fmt决定。</span><br><span class="line"><span class="number">10</span>	time.strptime(str,fmt=<span class="string">'%a %b %d %H:%M:%S %Y'</span>)</span><br><span class="line">根据fmt的格式把一个时间字符串解析为时间元组。</span><br><span class="line"><span class="number">11</span>	time.time( )</span><br><span class="line">返回当前时间的时间戳（<span class="number">1970</span>纪元后经过的浮点秒数）。</span><br><span class="line"><span class="number">12</span>	time.tzset()</span><br><span class="line">根据环境变量TZ重新初始化时间相关设置。</span><br><span class="line">Time模块包含了以下<span class="number">2</span>个非常重要的属性：</span><br><span class="line"></span><br><span class="line">序号	属性及描述</span><br><span class="line"><span class="number">1</span>	time.timezone</span><br><span class="line">属性time.timezone是当地时区（未启动夏令时）距离格林威治的偏移秒数（&gt;<span class="number">0</span>，美洲;&lt;=<span class="number">0</span>大部分欧洲，亚洲，非洲）。</span><br><span class="line"><span class="number">2</span>	time.tzname</span><br><span class="line">属性time.tzname包含一对根据情况的不同而不同的字符串，分别是带夏令时的本地时区名称，和不带的。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">日历（Calendar）模块</span><br><span class="line">此模块的函数都是日历相关的，例如打印某月的字符月历。</span><br><span class="line"></span><br><span class="line">星期一是默认的每周第一天，星期天是默认的最后一天。更改设置需调用calendar.setfirstweekday()函数。模块包含了以下内置函数：</span><br><span class="line"></span><br><span class="line">序号	函数及描述</span><br><span class="line"><span class="number">1</span>	calendar.calendar(year,w=<span class="number">2</span>,l=<span class="number">1</span>,c=<span class="number">6</span>)</span><br><span class="line">返回一个多行字符串格式的year年年历，<span class="number">3</span>个月一行，间隔距离为c。 每日宽度间隔为w字符。每行长度为<span class="number">21</span>* W+<span class="number">18</span>+<span class="number">2</span>* C。l是每星期行数。</span><br><span class="line"><span class="number">2</span>	calendar.firstweekday( )</span><br><span class="line">返回当前每周起始日期的设置。默认情况下，首次载入 calendar 模块时返回 <span class="number">0</span>，即星期一。</span><br><span class="line"><span class="number">3</span>	calendar.isleap(year)</span><br><span class="line">是闰年返回 <span class="literal">True</span>，否则为 <span class="literal">False</span>。</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> calendar</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(calendar.isleap(<span class="number">2000</span>))</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(calendar.isleap(<span class="number">1900</span>))</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="number">4</span>	calendar.leapdays(y1,y2)</span><br><span class="line">返回在Y1，Y2两年之间的闰年总数。</span><br><span class="line"><span class="number">5</span>	calendar.month(year,month,w=<span class="number">2</span>,l=<span class="number">1</span>)</span><br><span class="line">返回一个多行字符串格式的year年month月日历，两行标题，一周一行。每日宽度间隔为w字符。每行的长度为<span class="number">7</span>* w+<span class="number">6</span>。l是每星期的行数。</span><br><span class="line"><span class="number">6</span>	calendar.monthcalendar(year,month)</span><br><span class="line">返回一个整数的单层嵌套列表。每个子列表装载代表一个星期的整数。Year年month月外的日期都设为<span class="number">0</span>;范围内的日子都由该月第几日表示，从<span class="number">1</span>开始。</span><br><span class="line"><span class="number">7</span>	calendar.monthrange(year,month)</span><br><span class="line">返回两个整数。第一个是该月的星期几的日期码，第二个是该月的日期码。日从<span class="number">0</span>（星期一）到<span class="number">6</span>（星期日）;月从<span class="number">1</span>到<span class="number">12</span>。</span><br><span class="line"><span class="number">8</span>	calendar.prcal(year,w=<span class="number">2</span>,l=<span class="number">1</span>,c=<span class="number">6</span>)</span><br><span class="line">相当于 <span class="keyword">print</span> calendar.calendar(year,w=<span class="number">2</span>,l=<span class="number">1</span>,c=<span class="number">6</span>)。</span><br><span class="line"><span class="number">9</span>	calendar.prmonth(year,month,w=<span class="number">2</span>,l=<span class="number">1</span>)</span><br><span class="line">相当于 <span class="keyword">print</span> calendar.month(year,month,w=<span class="number">2</span>,l=<span class="number">1</span>) 。</span><br><span class="line"><span class="number">10</span>	calendar.setfirstweekday(weekday)</span><br><span class="line">设置每周的起始日期码。<span class="number">0</span>（星期一）到<span class="number">6</span>（星期日）。</span><br><span class="line"><span class="number">11</span>	calendar.timegm(tupletime)</span><br><span class="line">和time.gmtime相反：接受一个时间元组形式，返回该时刻的时间戳（<span class="number">1970</span>纪元后经过的浮点秒数）。</span><br><span class="line"><span class="number">12</span>	calendar.weekday(year,month,day)</span><br><span class="line">返回给定日期的日期码。<span class="number">0</span>（星期一）到<span class="number">6</span>（星期日）。月份为 <span class="number">1</span>（一月） 到 <span class="number">12</span>（<span class="number">12</span>月）。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">其他相关模块和函数</span><br><span class="line">在Python中，其他处理日期和时间的模块还有：</span><br><span class="line"></span><br><span class="line">datetime模块</span><br><span class="line">pytz模块</span><br><span class="line">dateutil模块</span><br></pre></td></tr></table></figure>


    
        <div class="post-more-div">
            <a href="/2019/12/26/study%20python%208day-2/" class="post-more waves-button">
                Continue reading...
            </a>
        </div>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </div>
    
</article>

        </li>
    
    </ul>

    
<nav id="page-nav">
    <div class="inner">
    <a class="extend prev" rel="prev" href="/page/3/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/">下一页</a>
    </div>
</nav>


</div>

        <footer class="footer">
    <div class="footer-content">
        <span class="power">
            <i class="icon icon-lg icon-copyright"></i>
            2020
            <i class="icon icon-lg icon-heart"></i>
            <a href="http://yoursite.com">https://yanxigun99.github.io/</a>
            <br/>
            Power by
            <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>&nbsp;·&nbsp;
            Theme
            <a class="tomotoeslink" href="https://github.com/tomotoes/hexo-theme-tomotoes/" target="_blank" rel="external nofollow">tomotoes</a>
        </span>

        <br/>

        <span id="RunTime" style="color:#a7a7a2;"></span>
        <br/>

        <span>
            
	<i class="icon icon-lg icon-user">
<span id="busuanzi_container_site_uv" style='display:none'>
       访问用户：<span id="busuanzi_value_site_uv"></span>
    </span>人</i>
    ·
    <i class="icon icon-lg icon-eye">
    <span id="busuanzi_container_site_pv" style='display:none'>
      访问次数：<span id="busuanzi_value_site_pv"></span>
    </span>次
    </i>


        </span>
        <br/>

        <span class="license">This blog is licensed under a <a rel="license noopener" rel="external nofollow noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
    </div>
</footer>

    </main>
    
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <!-- waves按钮特效 -->
<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<!-- 主题配置脚本 -->
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };
</script>

<!-- jquery -->
<script src="/js/jquery.min.js?v=3.0"></script>

<!-- 搜索 -->

<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item waves-block waves-effect" onclick="location.href='{path}'">
    <div class="title ellipsis" title="{title}">{title}</div>
</li>
</template>


<!-- main博客脚本 -->
<script src="/js/main.min.js?v=3.0" ></script>

<!-- 动画&配置 -->
<script src="/js/script.min.js?v=3.0" ></script>

<!-- 脚本管理 -->
<script>

if(window.innerWidth > 800){
	/* 3D标题 */
	$(".content-header").on("mousemove", threedee);

	/* 底部追随鼠标 */
	$(".footer").hover(2);

	/* gotop键的涟漪 */
	$("#gotop").hover(1);

	/* 赞赏的粒子雨 */
	$("#reward").hover(3);

	/* 微信公众号的底部渲染 */
	$("#wechat").hover(4);

    /* 标题跳动 */
    $(".archivestitle").bumpyText();

	/* 图片点击放大 */
	const postimg = jQuery(".post-content img:not(.github-emoji)");
	postimg.on("click",function(){

		mask.classList.add("in");
		main.classList.add("Mask");
		menu.classList.add("Mask");
		var myimg = this.cloneNode(true);
		myimg.classList.add("imgShow");

		setTimeout(function(){
			jQuery(myimg).animate({
				opacity:"1"
			},1000);
		},0);

		document.body.appendChild(myimg);

		myimg.onclick=function(){
			document.body.removeChild(myimg);
			mask.classList.remove("in");
			main.classList.remove("Mask");
			menu.classList.remove("Mask");
		};

	});

}

/* 名字跳动 */
$("#name").bumpyText();


/* 网站运行时间 */
setInterval(function () {
	setTime("2020/01/13");
}, 1000);

/* 文章块的淡出 */
postshow();

/* 座右铭 */

   getHitokoto();



/* 粘贴提示 */
G($(".post-content"), location.href, "Yan XiGun");


/* 控制台 */
if (window.console && window.console.log) {
	setTimeout(function () {
		console.log("\n %c 一个坏掉的番茄 %c  © Simon Ma  http://tomotoes.com \n\n", "color:#FFFFFB;background:#1abc9c;padding:5px 0;border-radius:.5rem 0 0 .5rem;", "color:#FFFFFB;background:#080808;padding:5px 0;border-radius:0 .5rem .5rem 0;");
	}, 0);
}

</script>




<!-- 公式渲染 -->



<!-- 不蒜子 -->

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script>


</body>
</html>
